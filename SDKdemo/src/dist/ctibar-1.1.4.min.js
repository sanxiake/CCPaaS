window["Ctibar"]=function(n){var r={};function s(e){if(r[e]){return r[e].exports}var t=r[e]={i:e,l:false,exports:{}};n[e].call(t.exports,t,t.exports,s);t.l=true;return t.exports}s.m=n;s.c=r;s.d=function(e,t,n){if(!s.o(e,t)){Object.defineProperty(e,t,{enumerable:true,get:n})}};s.r=function(e){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(e,"__esModule",{value:true})};s.t=function(t,e){if(e&1)t=s(t);if(e&8)return t;if(e&4&&typeof t==="object"&&t&&t.__esModule)return t;var n=Object.create(null);s.r(n);Object.defineProperty(n,"default",{enumerable:true,value:t});if(e&2&&typeof t!="string")for(var r in t)s.d(n,r,function(e){return t[e]}.bind(null,r));return n};s.n=function(t){var e=t&&t.__esModule?function e(){return t["default"]}:function e(){return t};s.d(e,"a",e);return e};s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};s.p="";return s(s.s=0)}([function(e,t,n){"use strict";n.r(t);n.d(t,"init",function(){return C});n.d(t,"logout",function(){return E});n.d(t,"ready",function(){return A});n.d(t,"notready",function(){return w});n.d(t,"invite",function(){return R});n.d(t,"cancleafterprocess",function(){return I});n.d(t,"answer",function(){return k});n.d(t,"hungup",function(){return O});n.d(t,"hold",function(){return x});n.d(t,"unhold",function(){return N});n.d(t,"trans",function(){return U});n.d(t,"dtmf",function(){return P});n.d(t,"checkmic",function(){return D});n.d(t,"mute",function(){return M});n.d(t,"unmute",function(){return q});n.d(t,"free",function(){return L});n.d(t,"rest",function(){return H});var d=n(1);var r=n(2);var p=n.n(r);var s=n(3);var a=n.n(s);var i=n(29);var o=n.n(i);var l=n(31);var u="";var c=null,f=null,h=null;var _;var m,v,g=false;var y=null;function T(e,t){d["default"].stateListener.handle(e,t)}var b={getOptions:function e(){var t={mediaConstraints:S.constraints,mediaStream:null};if(d["default"].extension!=null&&d["default"].extension.enableice&&d["default"].extension.enablestun){t={mediaConstraints:S.constraints,mediaStream:null,pcConfig:{rtcpMuxPolicy:"negotiate",iceServers:[{urls:["stun:"+d["default"].extension.stunserver+":"+d["default"].extension.stunserverport]}]}}}else if(d["default"].extension!=null&&d["default"].extension.enableice&&d["default"].extension.enableturn){t={mediaConstraints:S.constraints,mediaStream:null,pcConfig:{rtcpMuxPolicy:"negotiate",iceServers:[{urls:"turn:"+d["default"].extension.turnserver+":"+d["default"].extension.turnserverport+"?transport="+d["default"].extension.turntransport,username:d["default"].extension.turnusername,credential:d["default"].extension.turncredential}],iceTransportPolicy:"relay"}}}return t},getCommand:function e(t,n,r,s,i,o){var a="";if(n!=null&&n.userid!=null){a=n.userid}return{command:t,data:n,current:r,dial:s,userid:a,calltype:i,dataid:o}},init:function e(n,r,t){var s=n.baseUrl;var i=n.username;var o=n.token;a.a.post(s+"/tokens/softphone?username="+i+"&token="+o).then(function(e){u=s;c=e.data.orgi;f=e.data.userid;h=e.data.organ;d["default"].extension={opensips:e.data.opensips,opensipsdomain:e.data.opensipsdomain,domainname:e.data.domainname,enableice:e.data.enableice,enablestun:e.data.enablestun,stunserver:e.data.stunserver,stunserverport:e.data.stunserverport,enableturn:e.data.enableturn,turnserver:e.data.turnserver,turnserverport:e.data.turnserverport,turntransport:e.data.turntransport,turnusername:e.data.turnusername,turncredential:e.data.turncredential,mediapath:e.data.mediapath};console.log(e);console.log(d["default"].extension);if(undefined!==e.data.mediapath){y=new Audio(u+e.data.mediapath)}if(n.stateEventListener!=null){d["default"].stateListener=n.stateEventListener}var t=e.data;if(t.id!=null&&t.id!=""){if(t.webrtc!=null&&t.webrtc){m=t.webrtchost;v=t.webrtcport;if(t.webrtcssl){g=true}if(d["default"].softPhoneUA!=null){if(d["default"].softPhoneUA.isConnected()==false||d["default"].softPhoneUA.isRegistered()==false){d["default"].softPhoneUA.start()}d["default"].config.extention=t;b.initWebSocket(t.extention,t.password);_.emit("command",b.getCommand("login",d["default"].config.extention))}else{S.login(t.extention,t.password,e.sipport,m,v,g,function(){d["default"].config.extention=t;b.initWebSocket(t.extention,t.password);_.emit("command",b.getCommand("login",d["default"].config.extention))})}}else{b.initWebSocket(t.extention,t.password);d["default"].config.extention=t;_.emit("command",b.getCommand("login",d["default"].config.extention))}d["default"].autoreconnect=true;d["default"].disconnect=false}r()})["catch"](function(e){t()})},initWebSocket:function e(t,n){console.info("Init web socket.");console.info("当前版本号:1.1.4.1");if(_==null){console.info("orgi :"+c+", userId:"+f);_=o.a.connect(u+"/callcenter/event?orgi="+c+"&extention="+t+"&userid="+f+"&organ="+h,{transports:["websocket"],reconnection:false});_.on("connect",function(){console.log("呼叫中心组件链接成功.")}).on("agentstatus",function(e){if(e=="notexist"&&_!=null){console.log("状态不同步,断开链接,同步状态.");_.disconnect();b.off();_=null}else if(e!="ready"&&d["default"].ready==true){console.log("业务状态不同步,重新就绪,同步状态."+e);d["default"].ready=false}else if(e=="ready"&&d["default"].incall==true){console.log("通话状态不同步,当前通话中,同步状态 "+e);b.incall()}}).on("disconnect",function(e){console.log("呼叫中心组件已断开.");b.off();d["default"].config.extention=null;d["default"].disconnect=true;d["default"].loginsuccess=false;b.disconnectLogout()}).on("login",function(e){console.log("login status ---\x3e "+e);if(e!=null&&e.ok==true){T(d["default"].status.LOGIN,{extno:d["default"].config.extention.extention});d["default"].orgtrans=e.orgtrans}d["default"].config.extention.password=null;if(d["default"].softPhoneUA!=null&&d["default"].currentSession!=null){}if(d["default"].ready==true){b.ready()}d["default"].loginsuccess=true}).on("status",function(e){b.sessionEvent(e)}).on("conference",function(e){b.conference(e)}).on("task",function(e){}).on("error",function(e){if(e=="extention"){d["default"].autoreconnect=false;T(d["default"].status.ERROR,{message:"登录失败，请确认分机已经注册"})}else if(e=="password"){d["default"].autoreconnect=false;T(d["default"].status.ERROR,{message:"登录失败，请确认分机账号密码是否正确"})}else if(e=="pbxhost"){d["default"].autoreconnect=false;T(d["default"].status.ERROR,{message:"登录失败，请确认语音交换平台已经链接成功"})}else if(e=="callcenter"){d["default"].autoreconnect=false;T(d["default"].status.ERROR,{message:"就绪失败，请确认坐席是否在呼叫中心队列中"})}else if(e=="nophonenumber"){d["default"].autoreconnect=false;T(d["default"].status.ERROR,{message:"呼叫失败，请确认是否配置了外呼号码选项"})}else if(e=="logout"){d["default"].autoreconnect=false;d["default"].loginsuccess=false;T(d["default"].status.LOGOUT)}else if(e=="nonames"){}else if(e=="overnum"){}else if(e=="busy"){}else if(e=="hold"){}_=null}).on("nophonenumber",function(e){}).on("offline",function(e){console.log("呼叫中心服务器断开链接.");T(d["default"].status.LOGOUT)}).on("docallout",function(e){}).on("preview",function(e){}).on("outboundcall",function(e){});_.on("message",function(e){console.log(e.messageType+" ..... message:"+e.message)})}},ready:function e(){if(d["default"].currentState==d["default"].status.RING||d["default"].currentState==d["default"].status.ANSWER){T(d["default"].status.ERROR,{message:"当前状态错误，无法变更。当前状态为:"+d["default"].currentState});return}if(_!=null){_.emit("command",b.getCommand("ready",d["default"].config.extention))}},ccstatus:function e(){if(_!=null){_.emit("command",b.getCommand("status",d["default"].config.extention))}},recive:function e(){if(_!=null){_.emit("command",b.getCommand("recive",d["default"].config.extention))}},notready:function e(){if(d["default"].currentState==d["default"].status.RING||d["default"].currentState==d["default"].status.ANSWER){T(d["default"].status.ERROR,{message:"当前状态错误，无法变更"});return}if(_!=null){_.emit("command",b.getCommand("notready",d["default"].config.extention))}},incall:function e(){if(_!=null){_.emit("command",b.getCommand("incall",d["default"].config.extention))}},invite:function e(t){if(d["default"].incalling){console.log("当前在通话中，无法接起新的通话");return}if(_!=null&&d["default"].registed){d["default"].outgoingSession=d["default"].softPhoneUA.call(t.trim(),b.getOptions())}},cancelafterprocess:function e(){if(_!=null){_.emit("command",b.getCommand("cancleafterprocess",d["default"].config.extention))}T(d["default"].status.AFTERPROCESS,{state:false})},rest:function e(){if(d["default"].currentState==d["default"].status.RING||d["default"].currentState==d["default"].status.ANSWER){T(d["default"].status.ERROR,{message:"当前状态错误，无法变更"});return}if(_!=null){_.emit("command",b.getCommand("rest",d["default"].config.extention))}},free:function e(){if(d["default"].currentState==d["default"].status.RING||d["default"].currentState==d["default"].status.ANSWER){T(d["default"].status.ERROR,{message:"当前状态错误，无法变更"});return}if(_!=null){_.emit("command",b.getCommand("free",d["default"].config.extention))}},logout:function e(){if(_!=null){_.emit("command",b.getCommand("logout",d["default"].config.extention))}if(d["default"].softPhoneUA!=null){S.logout()}d["default"].autoreconnect=false},disconnectLogout:function e(){if(_!=null){_.emit("command",b.getCommand("logout",d["default"].config.extention))}if(d["default"].softPhoneUA!=null){S.logout()}d["default"].autoreconnect=false;_.disconnect();_.off();_=null;T(d["default"].status.LOGOUT)},answer:function e(){if(d["default"].incalling){console.log("当前在通话中，无法接起新的通话");return}if(d["default"].softPhoneUA!=null&&d["default"].incomingSession!=null){d["default"].incomingSession.answer(b.getOptions())}if(_!=null){_.emit("command",b.getCommand("answer",d["default"].config.extention,d["default"].config.current))}b.ccstatus()},mute:function e(){if(d["default"].softPhoneUA!=null&&d["default"].currentSession!=null){d["default"].currentSession.mute({audio:true,video:false})}T(d["default"].status.MUTE)},unmute:function e(){if(d["default"].softPhoneUA!=null&&d["default"].currentSession!=null){d["default"].currentSession.unmute({audio:true,video:false})}T(d["default"].status.UNMUTE)},hungup:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(d["default"].softPhoneUA!=null&&d["default"].currentSession!=null&&d["default"].argtrans==false){if(d["default"].currentSession.isEnded()==false){d["default"].currentSession.terminate(b.getOptions())}d["default"].currentSession=null}else if(_!=null){_.emit("command",b.getCommand("hungup",d["default"].config.extention,d["default"].config.current));if(t==true&&d["default"].ready==true){_.emit("command",b.getCommand("rest",d["default"].config.extention))}}d["default"].resp=true;if(d["default"].disconnect==true){T(d["default"].status.LOGOUT)}l["default"].audiostop("audioplane")},hold:function e(){if(_!=null){_.emit("command",b.getCommand("hold",d["default"].config.extention,d["default"].config.current))}},unhold:function e(){if(_!=null){_.emit("command",b.getCommand("unhold",d["default"].config.extention,d["default"].config.current))}},trans:function e(t){if(_!=null){_.emit("command",b.getCommand("trans",d["default"].config.extention,d["default"].config.current,t))}},dtmf:function e(t){if(d["default"].softPhoneUA!=null&&d["default"].currentSession!=null){setTimeout(function(){d["default"].currentSession.sendDTMF(t)},200)}else{_.emit("command",b.getCommand("dtmf",d["default"].config.extention,d["default"].config.current,t))}},checkmic:function e(t,n){navigator.mediaDevices.getUserMedia({video:false,audio:{deviceId:"default"}}).then(function(e){e.getTracks().forEach(function(e){e.stop()});t();console.log("麦克风检测成功")})["catch"](function(e){n();console.error("麦克风校验失败。")})},off:function e(){b.delevent("connect");b.delevent("disconnect");b.delevent("agentstatus");b.delevent("login");b.delevent("status");b.delevent("error");b.delevent("nophonenumber");b.delevent("offline");b.delevent("docallout");b.delevent("preview");b.delevent("outboundcall");b.delevent("message")},delevent:function e(t){if(_!=null){var n=_.listeners(t);if(n.length>1){for(var r=0;r<n.length;r++){_.off(t,n[r])}}else{_.off(t,n[0])}}},sessionEvent:function e(t){if(t.id!=null){d["default"].config.current=t}if(t.ani!=null&&t.ani!=""){if(t.calltype=="orgcallout"||t.calltype=="originside"){}else{}}if(t!=null&&t.status!=null&&t.status=="Available"){d["default"].currentState=d["default"].status.READY;T(d["default"].status.READY);d["default"].ready=true;d["default"].callcenter=true}else if(t!=null&&t.status!=null&&t.status=="On Break"){d["default"].currentState=d["default"].status.NOTREADY;T(d["default"].status.NOTREADY);d["default"].ready=false;d["default"].callcenter=false}else if(t!=null&&t.status!=null&&t.status=="Logged Out"){d["default"].currentState=d["default"].status.LOGOUT;T(d["default"].status.LOGOUT);d["default"].ready=false;d["default"].callcenter=false}else if(t!=null&&t.state!=null&&t.state=="Idle"){if(t.rest==true){T(d["default"].status.REST)}else{T(d["default"].status.AFTERPROCESS)}}else if(t!=null&&t.state!=null&&t.state=="Waiting"){T(d["default"].status.FREE)}else if(t!=null&&t.name!=null&&t.name=="CHANNEL_CREATE"){d["default"].resp=false;d["default"].incall=true;if(t.calltype=="orgcallout"){}else{}if(t.init==false){b.callmessage(t)}T(d["default"].status.RING,{callId:t.id,discaller:t.discaller,discalled:t.discalled,direction:t.direction,city:t.city,province:t.province,isp:t.isp,currentTime:t.localdatetime});d["default"].currentState=d["default"].status.RING;d["default"].ready=false}else if(t!=null&&t.name!=null&&t.name=="CHANNEL_HANGUP_COMPLETE"){T(d["default"].status.HANGUP,{calls:t.calls});d["default"].currentState="";d["default"].resp=true;d["default"].incall=false;d["default"].incalling=false;d["default"].callid=null;if(y!=null){y.pause()}}else if(t!=null&&t.name!=null&&t.name=="CHANNEL_HOLD"){T(d["default"].status.HOLD,{calls:t.calls})}else if(t!=null&&t.name!=null&&t.name=="CHANNEL_UNHOLD"){T(d["default"].status.UNHOLD,{calls:t.calls})}else if(t!=null&&t.answer!=null&&t.name=="CHANNEL_ANSWER"){if(d["default"].callid==null||d["default"].callid!=t.id){d["default"].incalling=true;if(y!=null&&t.calltype!=null&&("outsidequene"==t.calltype||"insidequene"==t.calltype)){y.load();y.play()}T(d["default"].status.ANSWER,{bridge:t.bridge,callid:t.id,calls:t.calls});d["default"].currentState=d["default"].status.ANSWER;d["default"].callid=t.id}}if(t.init==true){b.callmessage(t)}},callmessage:function e(t){if(t.statustype=="inbound"||t.statustype=="contacts"||t.statustype=="internalnotice"){}else{if(t.statustype){}else{}}},callback:function e(t){if(d["default"].config.extention!=null){}}};var S={constraints:{audio:true,video:false},login:function e(t,n,r,s,i,o,a){var l="sip:"+t+"@"+s+";transport="+(o===true?"wss":"ws");var u=l;if(d["default"].extension!=null&&d["default"].extension.opensips===true&&d["default"].extension.opensipsdomain===true){u="sip:"+t+"@"+d["default"].extension.domainname+";transport="+(o===true?"wss":"ws")}var c=(o===true?"wss://":"ws://")+s+":"+i;var f=new p.a.WebSocketInterface(c);var h={sockets:[f],outbound_proxy_set:c,password:n,display_name:t,register:true,no_answer_timeout:120,register_expires:3600,use_preloaded_route:false,via_host:s,uri:l,contact_uri:u,session_timers:false,user_agent:"SoftPhone WebRTC v5.0"};d["default"].softPhoneUA=new p.a.UA(h);d["default"].softPhoneUA.on("registered",function(e){console.log("register success, ",e);if(d["default"].loginsuccess==false){a()}d["default"].registed=true});d["default"].softPhoneUA.on("unregistered",function(e){d["default"].registed=false;console.log("sip unregistered")});d["default"].softPhoneUA.on("connected",function(e){if(d["default"].sipsocket==false){T(d["default"].status.CONNECT)}else{T(d["default"].status.RECONNECT)}d["default"].sipsocket=true});d["default"].softPhoneUA.on("disconnected",function(e){console.log("jssip.disconnected",e);console.log("disconnected",d["default"].disconnect);var t=null;if(e.error==false){t={error:false,code:0}}else{t={error:true,code:e.error.code}}console.log(t);T(d["default"].status.DISCONNECT,t)});d["default"].softPhoneUA.on("registrationFailed",function(e){console.log("registrationFailed, ",e)});d["default"].softPhoneUA.on("registrationExpiring",function(){d["default"].softPhoneUA.register();console.log("test register")});d["default"].softPhoneUA.on("newRTCSession",function(e){d["default"].resp=false;e.session.on("accepted",function(e){console.log(e);if(e.originator=="remote"&&d["default"].currentSession==null){d["default"].currentSession=d["default"].outgoingSession;d["default"].outgoingSession=null;console.info("setCurrentSession - ",d["default"].currentSession)}});e.session.on("confirmed",function(e){if(e.originator=="remote"&&d["default"].currentSession==null){d["default"].currentSession=d["default"].incomingSession;d["default"].incomingSession=null;console.info("setCurrentSession - ",d["default"].currentSession)}});e.session.on("sdp",function(e){});e.session.on("ended",function(e){d["default"].currentSession=null;d["default"].incomingSession=null;d["default"].resp=true;d["default"].incall=false;d["default"].incalling=false});e.session.on("progress",function(e){if(e.originator=="remote"){}});if(e.session.connection!=null){e.session.connection.addEventListener("addstream",function(e){console.info("outgoingSession Connection , Call Audio Message");var t=document.getElementById("remoteAudio");t.srcObject=e.stream;t.play()})}else{e.session.on("peerconnection",function(e){e.peerconnection.addEventListener("addstream",function(e){console.info("incomingSession Connection , Call Audio Message");var t=document.getElementById("remoteAudio");t.srcObject=e.stream;t.play()})})}if(e.originator=="remote"){console.info("incomingSession, answer the call");d["default"].incomingSession=e.session;if(e.request.getHeader("Call-Info")!=null&&e.request.getHeader("Call-Info")=="<answer-after=0>"&&e.request.data!=null&&e.request.data.indexOf("intercom")>0){e.session.answer(b.getOptions())}else{if(d["default"].config!=null&&d["default"].config.extention!=null&&d["default"].config.extention.webrtcring!=""){}}d["default"].ready=false}});d["default"].softPhoneUA.start()},logout:function e(){if(d["default"].softPhoneUA!=null){if(d["default"].currentSession!=null){if(d["default"].currentSession.isEnded()==false){d["default"].currentSession.terminate(b.getOptions())}d["default"].currentSession=null}if(d["default"].incomingSession!=null){if(d["default"].incomingSession.isEnded()==false){d["default"].incomingSession.terminate(b.getOptions())}d["default"].incomingSession=null}d["default"].softPhoneUA.unregister();d["default"].softPhoneUA.stop();d["default"].sipsocket=false;d["default"].softPhoneUA=null}},answer:function e(){if(d["default"].currentSession){d["default"].currentSession.answer(b.getOptions())}},hungup:function e(){if(d["default"].currentSession){if(d["default"].currentSession.isEnded()==false){d["default"].currentSession.terminate(b.getOptions())}d["default"].currentSession=null}}};var C=b.init;var E=b.logout;var A=b.ready;var w=b.notready;var R=b.invite;var I=b.cancelafterprocess;var k=b.answer;var O=b.hungup;var x=b.hold;var N=b.unhold;var U=b.trans;var P=b.dtmf;var D=b.checkmic;var M=b.mute;var q=b.unmute;var L=b.free;var H=b.rest},function(e,t,n){"use strict";n.r(t);var r={config:{extention:null,current:null,dial:null},calltimer:null,durtime:null,loginsuccess:false,ready:false,callcenter:false,incall:false,autoreconnect:false,disconnect:false,resp:false,incalling:false,extension:null,orgtrans:false,currentState:null,callid:null,status:{ERROR:"ERROR",LOGIN:"LOGIN",LOGOUT:"LOGOUT",READY:"READY",NOTREADY:"NOTREADY",AFTERPROCESS:"AFTERPROCESS",REST:"REST",FREE:"FREE",RING:"RING",ANSWER:"ANSWER",HANGUP:"HANGUP",HOLD:"HOLD",UNHOLD:"UNHOLD",MICCHECK:"MICCHECK",MUTE:"MUTE",UNMUTE:"UNMUTE",CONNECT:"CONNECT",DISCONNECT:"DISCONNECT",RECONNECT:"RECONNECT"},softPhoneUA:null,sipsocket:false,currentSession:null,incomingSession:null,outgoingSession:null,registed:false,stateListener:[]};t["default"]=r},function(t,n,e){var r,s,i;var f;var f;function o(e){return c(e)||u(e)||l(e)||a()}function a(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e,t){if(!e)return;if(typeof e==="string")return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor)n=e.constructor.name;if(n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}function u(e){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(e))return Array.from(e)}function c(e){if(Array.isArray(e))return h(e)}function h(e,t){if(t==null||t>e.length)t=e.length;for(var n=0,r=new Array(t);n<t;n++){r[n]=e[n]}return r}function N(e){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){N=function e(t){return typeof t}}else{N=function e(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}}return N(e)}!function(e){if("object"==(false?undefined:N(n))&&"undefined"!=typeof t)t.exports=e();else if(true)!(s=[],r=e,i=typeof r==="function"?r.apply(n,s):r,i!==undefined&&(t.exports=i));else{}}(function(){return function(){return function i(o,a,l){function u(t,e){if(!a[t]){if(!o[t]){var n="function"==typeof f&&f;if(!e&&n)return f(t,!0);if(c)return c(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var s=a[t]={exports:{}};o[t][0].call(s.exports,function(e){return u(o[t][1][e]||e)},s,s.exports,i,o,a,l)}return a[t].exports}for(var c="function"==typeof f&&f,e=0;e<l.length;e++){u(l[e])}return u}}()({1:[function(e,t,n){"use strict";function o(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(t))){var n=0,e=function e(){};return{s:e,n:function e(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function e(t){throw t},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s,i=!0,o=!1;return{s:function e(){r=t[Symbol.iterator]()},n:function e(){var t=r.next();return i=t.done,t},e:function e(t){o=!0,s=t},f:function e(){try{i||null==r["return"]||r["return"]()}finally{if(o)throw s}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++){r[n]=e[n]}return r}var l=e("./Utils"),r=e("./Constants"),s=e("./Grammar"),i=e("./URI"),u=e("./Socket"),c=e("./Exceptions");n.settings={authorization_user:null,password:null,realm:null,ha1:null,display_name:null,uri:null,contact_uri:null,instance_id:null,use_preloaded_route:!1,session_timers:!0,session_timers_refresh_method:r.UPDATE,no_answer_timeout:60,register:!0,register_expires:600,registrar_server:null,sockets:null,connection_recovery_max_interval:r.CONNECTION_RECOVERY_MAX_INTERVAL,connection_recovery_min_interval:r.CONNECTION_RECOVERY_MIN_INTERVAL,via_host:"".concat(l.createRandomToken(12),".invalid")};var f={mandatory:{sockets:function e(t){var n=[];if(u.isSocket(t))n.push({socket:t});else{if(!Array.isArray(t)||!t.length)return;var r,s=o(t);try{for(s.s();!(r=s.n()).done;){var i=r.value;Object.prototype.hasOwnProperty.call(i,"socket")&&u.isSocket(i.socket)?n.push(i):u.isSocket(i)&&n.push({socket:i})}}catch(t){s.e(t)}finally{s.f()}}return n},uri:function e(t){/^sip:/i.test(t)||(t="".concat(r.SIP,":").concat(t));var n=i.parse(t);return n&&n.user?n:void 0}},optional:{authorization_user:function e(t){return-1===s.parse('"'.concat(t,'"'),"quoted_string")?void 0:t},authorization_jwt:function e(t){if("string"==typeof t)return t},user_agent:function e(t){if("string"==typeof t)return t},connection_recovery_max_interval:function e(t){if(l.isDecimal(t)){var n=Number(t);if(n>0)return n}},connection_recovery_min_interval:function e(t){if(l.isDecimal(t)){var n=Number(t);if(n>0)return n}},contact_uri:function e(t){if("string"==typeof t){var n=s.parse(t,"SIP_URI");if(-1!==n)return n}},display_name:function e(t){return t},instance_id:function e(t){return/^uuid:/i.test(t)&&(t=t.substr(5)),-1===s.parse(t,"uuid")?void 0:t},no_answer_timeout:function e(t){if(l.isDecimal(t)){var n=Number(t);if(n>0)return n}},session_timers:function e(t){if("boolean"==typeof t)return t},session_timers_refresh_method:function e(t){if("string"==typeof t&&((t=t.toUpperCase())===r.INVITE||t===r.UPDATE))return t},password:function e(t){return String(t)},realm:function e(t){return String(t)},ha1:function e(t){return String(t)},register:function e(t){if("boolean"==typeof t)return t},register_expires:function e(t){if(l.isDecimal(t)){var n=Number(t);if(n>0)return n}},registrar_server:function e(t){/^sip:/i.test(t)||(t="".concat(r.SIP,":").concat(t));var n=i.parse(t);return n?n.user?void 0:n:void 0},use_preloaded_route:function e(t){if("boolean"==typeof t)return t}}};n.load=function(e,t){for(var n in f.mandatory){if(!t.hasOwnProperty(n))throw new c.ConfigurationError(n);var r=t[n],s=f.mandatory[n](r);if(void 0===s)throw new c.ConfigurationError(n,r);e[n]=s}for(var i in f.optional){if(t.hasOwnProperty(i)){var o=t[i];if(l.isEmpty(o))continue;var a=f.optional[i](o);if(void 0===a)throw new c.ConfigurationError(i,o);e[i]=a}}}},{"./Constants":2,"./Exceptions":6,"./Grammar":7,"./Socket":20,"./URI":25,"./Utils":26}],2:[function(e,t,n){"use strict";var r=e("../package.json");t.exports={USER_AGENT:"".concat(r.title," ").concat(r.version),SIP:"sip",SIPS:"sips",causes:{CONNECTION_ERROR:"Connection Error",REQUEST_TIMEOUT:"Request Timeout",SIP_FAILURE_CODE:"SIP Failure Code",INTERNAL_ERROR:"Internal Error",BUSY:"Busy",REJECTED:"Rejected",REDIRECTED:"Redirected",UNAVAILABLE:"Unavailable",NOT_FOUND:"Not Found",ADDRESS_INCOMPLETE:"Address Incomplete",INCOMPATIBLE_SDP:"Incompatible SDP",MISSING_SDP:"Missing SDP",AUTHENTICATION_ERROR:"Authentication Error",BYE:"Terminated",WEBRTC_ERROR:"WebRTC Error",CANCELED:"Canceled",NO_ANSWER:"No Answer",EXPIRES:"Expires",NO_ACK:"No ACK",DIALOG_ERROR:"Dialog Error",USER_DENIED_MEDIA_ACCESS:"User Denied Media Access",BAD_MEDIA_DESCRIPTION:"Bad Media Description",RTP_TIMEOUT:"RTP Timeout"},SIP_ERROR_CAUSES:{REDIRECTED:[300,301,302,305,380],BUSY:[486,600],REJECTED:[403,603],NOT_FOUND:[404,604],UNAVAILABLE:[480,410,408,430],ADDRESS_INCOMPLETE:[484,424],INCOMPATIBLE_SDP:[488,606],AUTHENTICATION_ERROR:[401,407]},ACK:"ACK",BYE:"BYE",CANCEL:"CANCEL",INFO:"INFO",INVITE:"INVITE",MESSAGE:"MESSAGE",NOTIFY:"NOTIFY",OPTIONS:"OPTIONS",REGISTER:"REGISTER",REFER:"REFER",UPDATE:"UPDATE",SUBSCRIBE:"SUBSCRIBE",DTMF_TRANSPORT:{INFO:"INFO",RFC2833:"RFC2833"},REASON_PHRASE:{100:"Trying",180:"Ringing",181:"Call Is Being Forwarded",182:"Queued",183:"Session Progress",199:"Early Dialog Terminated",200:"OK",202:"Accepted",204:"No Notification",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",305:"Use Proxy",380:"Alternative Service",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",410:"Gone",412:"Conditional Request Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Unsupported URI Scheme",417:"Unknown Resource-Priority",420:"Bad Extension",421:"Extension Required",422:"Session Interval Too Small",423:"Interval Too Brief",424:"Bad Location Information",428:"Use Identity Header",429:"Provide Referrer Identity",430:"Flow Failed",433:"Anonymity Disallowed",436:"Bad Identity-Info",437:"Unsupported Certificate",438:"Invalid Identity Header",439:"First Hop Lacks Outbound Support",440:"Max-Breadth Exceeded",469:"Bad Info Package",470:"Consent Needed",478:"Unresolvable Destination",480:"Temporarily Unavailable",481:"Call/Transaction Does Not Exist",482:"Loop Detected",483:"Too Many Hops",484:"Address Incomplete",485:"Ambiguous",486:"Busy Here",487:"Request Terminated",488:"Not Acceptable Here",489:"Bad Event",491:"Request Pending",493:"Undecipherable",494:"Security Agreement Required",500:"JsSIP Internal Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Server Time-out",505:"Version Not Supported",513:"Message Too Large",580:"Precondition Failure",600:"Busy Everywhere",603:"Decline",604:"Does Not Exist Anywhere",606:"Not Acceptable"},ALLOWED_METHODS:"INVITE,ACK,CANCEL,BYE,UPDATE,MESSAGE,OPTIONS,REFER,INFO,NOTIFY",ACCEPTED_BODY_TYPES:"application/sdp, application/dtmf-relay",MAX_FORWARDS:69,SESSION_EXPIRES:90,MIN_SESSION_EXPIRES:60,CONNECTION_RECOVERY_MAX_INTERVAL:30,CONNECTION_RECOVERY_MIN_INTERVAL:2}},{"../package.json":38}],3:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}var o=e("./SIPMessage"),a=e("./Constants"),l=e("./Transactions"),u=e("./Dialog/RequestSender"),c=e("./Utils"),f=e("debug")("JsSIP:Dialog"),h={STATUS_EARLY:1,STATUS_CONFIRMED:2};t.exports=function(){function i(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:h.STATUS_CONFIRMED;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),this._owner=e,this._ua=e._ua,this._uac_pending_reply=!1,this._uas_pending_reply=!1,!t.hasHeader("contact"))return{error:"unable to create a Dialog without Contact header field"};t instanceof o.IncomingResponse&&(r=t.status_code<200?h.STATUS_EARLY:h.STATUS_CONFIRMED);var s=t.parseHeader("contact");"UAS"===n?(this._id={call_id:t.call_id,local_tag:t.to_tag,remote_tag:t.from_tag,toString:function e(){return this.call_id+this.local_tag+this.remote_tag}},this._state=r,this._remote_seqnum=t.cseq,this._local_uri=t.parseHeader("to").uri,this._remote_uri=t.parseHeader("from").uri,this._remote_target=s.uri,this._route_set=t.getHeaders("record-route"),this._ack_seqnum=this._remote_seqnum):"UAC"===n&&(this._id={call_id:t.call_id,local_tag:t.from_tag,remote_tag:t.to_tag,toString:function e(){return this.call_id+this.local_tag+this.remote_tag}},this._state=r,this._local_seqnum=t.cseq,this._local_uri=t.parseHeader("from").uri,this._remote_uri=t.parseHeader("to").uri,this._remote_target=s.uri,this._route_set=t.getHeaders("record-route").reverse(),this._ack_seqnum=null),this._ua.newDialog(this),f("new ".concat(n," dialog created with status ").concat(this._state===h.STATUS_EARLY?"EARLY":"CONFIRMED"))}return s(i,null,[{key:"C",get:function e(){return h}}]),s(i,[{key:"update",value:function e(t,n){this._state=h.STATUS_CONFIRMED,f("dialog ".concat(this._id.toString(),"  changed to CONFIRMED state")),"UAC"===n&&(this._route_set=t.getHeaders("record-route").reverse())}},{key:"terminate",value:function e(){f("dialog ".concat(this._id.toString()," deleted")),this._ua.destroyDialog(this)}},{key:"sendRequest",value:function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=c.cloneArray(r.extraHeaders),i=c.cloneObject(r.eventHandlers),o=r.body||null,a=this._createRequest(t,s,o);return i.onAuthenticated=function(){n._local_seqnum+=1},new u(this,a,i).send(),a}},{key:"receiveRequest",value:function e(t){this._checkInDialogRequest(t)&&(t.method===a.ACK&&null!==this._ack_seqnum?this._ack_seqnum=null:t.method===a.INVITE&&(this._ack_seqnum=t.cseq),this._owner.receiveRequest(t))}},{key:"_createRequest",value:function e(t,n,r){n=c.cloneArray(n),this._local_seqnum||(this._local_seqnum=Math.floor(1e4*Math.random()));var s=t===a.CANCEL||t===a.ACK?this._local_seqnum:this._local_seqnum+=1;return new o.OutgoingRequest(t,this._remote_target,this._ua,{cseq:s,call_id:this._id.call_id,from_uri:this._local_uri,from_tag:this._id.local_tag,to_uri:this._remote_uri,to_tag:this._id.remote_tag,route_set:this._route_set},n,r)}},{key:"_checkInDialogRequest",value:function e(t){var n=this;if(this._remote_seqnum){if(t.cseq<this._remote_seqnum){if(t.method!==a.ACK)return t.reply(500),!1;if(null===this._ack_seqnum||t.cseq!==this._ack_seqnum)return!1}else t.cseq>this._remote_seqnum&&(this._remote_seqnum=t.cseq)}else this._remote_seqnum=t.cseq;if(t.method===a.INVITE||t.method===a.UPDATE&&t.body){if(!0===this._uac_pending_reply)t.reply(491);else{if(!0===this._uas_pending_reply){var r=1+(10*Math.random()|0);return t.reply(500,null,["Retry-After:".concat(r)]),!1}this._uas_pending_reply=!0;t.server_transaction.on("stateChanged",function e(){t.server_transaction.state!==l.C.STATUS_ACCEPTED&&t.server_transaction.state!==l.C.STATUS_COMPLETED&&t.server_transaction.state!==l.C.STATUS_TERMINATED||(t.server_transaction.removeListener("stateChanged",e),n._uas_pending_reply=!1)})}t.hasHeader("contact")&&t.server_transaction.on("stateChanged",function(){t.server_transaction.state===l.C.STATUS_ACCEPTED&&(n._remote_target=t.parseHeader("contact").uri)})}else t.method===a.NOTIFY&&t.hasHeader("contact")&&t.server_transaction.on("stateChanged",function(){t.server_transaction.state===l.C.STATUS_COMPLETED&&(n._remote_target=t.parseHeader("contact").uri)});return!0}},{key:"id",get:function e(){return this._id}},{key:"local_seqnum",get:function e(){return this._local_seqnum},set:function e(t){this._local_seqnum=t}},{key:"owner",get:function e(){return this._owner}},{key:"uac_pending_reply",get:function e(){return this._uac_pending_reply},set:function e(t){this._uac_pending_reply=t}},{key:"uas_pending_reply",get:function e(){return this._uas_pending_reply}}]),i}()},{"./Constants":2,"./Dialog/RequestSender":4,"./SIPMessage":19,"./Transactions":22,"./Utils":26,debug:30}],4:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=e("../Constants"),o=e("../Transactions"),a=e("../RTCSession"),l=e("../RequestSender"),u={onRequestTimeout:function e(){},onTransportError:function e(){},onSuccessResponse:function e(){},onErrorResponse:function e(){},onAuthenticated:function e(){},onDialogError:function e(){}};t.exports=function(){function s(e,t,n){for(var r in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),this._dialog=e,this._ua=e._ua,this._request=t,this._eventHandlers=n,this._reattempt=!1,this._reattemptTimer=null,u){Object.prototype.hasOwnProperty.call(u,r)&&(this._eventHandlers[r]||(this._eventHandlers[r]=u[r]))}}var e,t,n;return e=s,(t=[{key:"send",value:function e(){var n=this,t=new l(this._ua,this._request,{onRequestTimeout:function e(){n._eventHandlers.onRequestTimeout()},onTransportError:function e(){n._eventHandlers.onTransportError()},onAuthenticated:function e(t){n._eventHandlers.onAuthenticated(t)},onReceiveResponse:function e(t){n._receiveResponse(t)}});if(t.send(),(this._request.method===i.INVITE||this._request.method===i.UPDATE&&this._request.body)&&t.clientTransaction.state!==o.C.STATUS_TERMINATED){this._dialog.uac_pending_reply=!0;t.clientTransaction.on("stateChanged",function e(){t.clientTransaction.state!==o.C.STATUS_ACCEPTED&&t.clientTransaction.state!==o.C.STATUS_COMPLETED&&t.clientTransaction.state!==o.C.STATUS_TERMINATED||(t.clientTransaction.removeListener("stateChanged",e),n._dialog.uac_pending_reply=!1)})}}},{key:"_receiveResponse",value:function e(t){var n=this;408===t.status_code||481===t.status_code?this._eventHandlers.onDialogError(t):t.method===i.INVITE&&491===t.status_code?this._reattempt?t.status_code>=200&&t.status_code<300?this._eventHandlers.onSuccessResponse(t):t.status_code>=300&&this._eventHandlers.onErrorResponse(t):(this._request.cseq.value=this._dialog.local_seqnum+=1,this._reattemptTimer=setTimeout(function(){n._dialog.owner.status!==a.C.STATUS_TERMINATED&&(n._reattempt=!0,n._request_sender.send())},1e3)):t.status_code>=200&&t.status_code<300?this._eventHandlers.onSuccessResponse(t):t.status_code>=300&&this._eventHandlers.onErrorResponse(t)}},{key:"request",get:function e(){return this._request}}])&&r(e.prototype,t),n&&r(e,n),s}()},{"../Constants":2,"../RTCSession":12,"../RequestSender":18,"../Transactions":22}],5:[function(e,t,n){"use strict";function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=e("./Utils"),f=e("debug")("JsSIP:DigestAuthentication"),h=e("debug")("JsSIP:ERROR:DigestAuthentication");h.log=console.warn.bind(console),t.exports=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._credentials=e,this._cnonce=null,this._nc=0,this._ncHex="00000000",this._algorithm=null,this._realm=null,this._nonce=null,this._opaque=null,this._stale=null,this._qop=null,this._method=null,this._uri=null,this._ha1=null,this._response=null}var e,n,r;return e=t,(n=[{key:"get",value:function e(t){switch(t){case"realm":return this._realm;case"ha1":return this._ha1;default:return void h('get() | cannot get "%s" parameter',t)}}},{key:"authenticate",value:function e(t,n){var r=t.method,s=t.ruri,i=t.body,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(this._algorithm=n.algorithm,this._realm=n.realm,this._nonce=n.nonce,this._opaque=n.opaque,this._stale=n.stale,this._algorithm){if("MD5"!==this._algorithm)return h('authenticate() | challenge with Digest algorithm different than "MD5", authentication aborted'),!1}else this._algorithm="MD5";if(!this._nonce)return h("authenticate() | challenge without Digest nonce, authentication aborted"),!1;if(!this._realm)return h("authenticate() | challenge without Digest realm, authentication aborted"),!1;if(!this._credentials.password){if(!this._credentials.ha1)return h("authenticate() | no plain SIP password nor ha1 provided, authentication aborted"),!1;if(this._credentials.realm!==this._realm)return h('authenticate() | no plain SIP password, and stored `realm` does not match the given `realm`, cannot authenticate [stored:"%s", given:"%s"]',this._credentials.realm,this._realm),!1}if(n.qop){if(n.qop.indexOf("auth-int")>-1)this._qop="auth-int";else{if(!(n.qop.indexOf("auth")>-1))return h('authenticate() | challenge without Digest qop different than "auth" or "auth-int", authentication aborted'),!1;this._qop="auth"}}else this._qop=null;this._method=r,this._uri=s,this._cnonce=o||c.createRandomToken(12),this._nc+=1;var a,l,u=Number(this._nc).toString(16);return this._ncHex="00000000".substr(0,8-u.length)+u,4294967296===this._nc&&(this._nc=1,this._ncHex="00000001"),this._credentials.password?this._ha1=c.calculateMD5("".concat(this._credentials.username,":").concat(this._realm,":").concat(this._credentials.password)):this._ha1=this._credentials.ha1,"auth"===this._qop?(a="".concat(this._method,":").concat(this._uri),l=c.calculateMD5(a),f('authenticate() | using qop=auth [a2:"%s"]',a),this._response=c.calculateMD5("".concat(this._ha1,":").concat(this._nonce,":").concat(this._ncHex,":").concat(this._cnonce,":auth:").concat(l))):"auth-int"===this._qop?(a="".concat(this._method,":").concat(this._uri,":").concat(c.calculateMD5(i||"")),l=c.calculateMD5(a),f('authenticate() | using qop=auth-int [a2:"%s"]',a),this._response=c.calculateMD5("".concat(this._ha1,":").concat(this._nonce,":").concat(this._ncHex,":").concat(this._cnonce,":auth-int:").concat(l))):null===this._qop&&(a="".concat(this._method,":").concat(this._uri),l=c.calculateMD5(a),f('authenticate() | using qop=null [a2:"%s"]',a),this._response=c.calculateMD5("".concat(this._ha1,":").concat(this._nonce,":").concat(l))),f("authenticate() | response generated"),!0}},{key:"toString",value:function e(){var t=[];if(!this._response)throw new Error("response field does not exist, cannot generate Authorization header");return t.push("algorithm=".concat(this._algorithm)),t.push('username="'.concat(this._credentials.username,'"')),t.push('realm="'.concat(this._realm,'"')),t.push('nonce="'.concat(this._nonce,'"')),t.push('uri="'.concat(this._uri,'"')),t.push('response="'.concat(this._response,'"')),this._opaque&&t.push('opaque="'.concat(this._opaque,'"')),this._qop&&(t.push("qop=".concat(this._qop)),t.push('cnonce="'.concat(this._cnonce,'"')),t.push("nc=".concat(this._ncHex))),"Digest ".concat(t.join(", "))}}])&&s(e.prototype,n),r&&s(e,r),t}()},{"./Utils":26,debug:30}],6:[function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==N(Symbol.iterator)?function(e){return N(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":N(e)})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}function l(r){var s=f();return function(){var e,t=d(r);if(s){var n=d(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)}}function u(e){var s="function"==typeof Map?new Map:void 0;return(u=function e(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==s){if(s.has(t))return s.get(t);s.set(t,r)}function r(){return c(t,arguments,d(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),h(r,t)})(e)}function c(e,t,n){return(c=f()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var s=new(Function.bind.apply(e,r));return n&&h(s,n.prototype),s}).apply(null,arguments)}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var r=function(e){a(s,u(Error));var r=l(s);function s(e,t){var n;return o(this,s),(n=r.call(this)).code=1,n.name="CONFIGURATION_ERROR",n.parameter=e,n.value=t,n.message=n.value?"Invalid value ".concat(JSON.stringify(n.value),' for parameter "').concat(n.parameter,'"'):"Missing parameter: ".concat(n.parameter),n}return s}(),s=function(e){a(r,u(Error));var n=l(r);function r(e){var t;return o(this,r),(t=n.call(this)).code=2,t.name="INVALID_STATE_ERROR",t.status=e,t.message="Invalid status: ".concat(e),t}return r}(),p=function(e){a(r,u(Error));var n=l(r);function r(e){var t;return o(this,r),(t=n.call(this)).code=3,t.name="NOT_SUPPORTED_ERROR",t.message=e,t}return r}(),_=function(e){a(r,u(Error));var n=l(r);function r(e){var t;return o(this,r),(t=n.call(this)).code=4,t.name="NOT_READY_ERROR",t.message=e,t}return r}();t.exports={ConfigurationError:r,InvalidStateError:s,NotSupportedError:p,NotReadyError:_}},{}],7:[function(Vn,e,t){"use strict";e.exports=function(){function Wn(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'}var e={parse:function e(v,l){var t={CRLF:o,DIGIT:u,ALPHA:a,HEXDIG:c,WSP:f,OCTET:r,DQUOTE:h,SP:d,HTAB:p,alphanum:s,reserved:_,unreserved:m,mark:b,escaped:S,LWS:C,SWS:E,HCOLON:A,TEXT_UTF8_TRIM:w,TEXT_UTF8char:R,UTF8_NONASCII:I,UTF8_CONT:k,LHEX:function e(){var t;null===(t=u())&&(/^[a-f]/.test(v.charAt(g))?(t=v.charAt(g),g++):(t=null,0===y&&T("[a-f]")));return t},token:O,token_nodot:x,separators:function e(){var t;40===v.charCodeAt(g)?(t="(",g++):(t=null,0===y&&T('"("'));null===t&&(41===v.charCodeAt(g)?(t=")",g++):(t=null,0===y&&T('")"')),null===t&&(60===v.charCodeAt(g)?(t="<",g++):(t=null,0===y&&T('"<"')),null===t&&(62===v.charCodeAt(g)?(t=">",g++):(t=null,0===y&&T('">"')),null===t&&(64===v.charCodeAt(g)?(t="@",g++):(t=null,0===y&&T('"@"')),null===t&&(44===v.charCodeAt(g)?(t=",",g++):(t=null,0===y&&T('","')),null===t&&(59===v.charCodeAt(g)?(t=";",g++):(t=null,0===y&&T('";"')),null===t&&(58===v.charCodeAt(g)?(t=":",g++):(t=null,0===y&&T('":"')),null===t&&(92===v.charCodeAt(g)?(t="\\",g++):(t=null,0===y&&T('"\\\\"')),null===t&&null===(t=h())&&(47===v.charCodeAt(g)?(t="/",g++):(t=null,0===y&&T('"/"')),null===t&&(91===v.charCodeAt(g)?(t="[",g++):(t=null,0===y&&T('"["')),null===t&&(93===v.charCodeAt(g)?(t="]",g++):(t=null,0===y&&T('"]"')),null===t&&(63===v.charCodeAt(g)?(t="?",g++):(t=null,0===y&&T('"?"')),null===t&&(61===v.charCodeAt(g)?(t="=",g++):(t=null,0===y&&T('"="')),null===t&&(123===v.charCodeAt(g)?(t="{",g++):(t=null,0===y&&T('"{"')),null===t&&(125===v.charCodeAt(g)?(t="}",g++):(t=null,0===y&&T('"}"')),null===t&&null===(t=d())&&(t=p()))))))))))))))));return t},word:N,STAR:U,SLASH:P,EQUAL:D,LPAREN:M,RPAREN:q,RAQUOT:L,LAQUOT:H,COMMA:j,SEMI:F,COLON:B,LDQUOT:G,RDQUOT:W,comment:function e(){var t,n,r;var s;s=g;t=M();if(null!==t){for(n=[],null===(r=V())&&null===(r=K())&&(r=e());null!==r;){n.push(r),null===(r=V())&&null===(r=K())&&(r=e())}null!==n&&null!==(r=q())?t=[t,n,r]:(t=null,g=s)}else t=null,g=s;return t},ctext:V,quoted_string:J,quoted_string_clean:Y,qdtext:z,quoted_pair:K,SIP_URI_noparams:$,SIP_URI:X,uri_scheme:Q,uri_scheme_sips:Z,uri_scheme_sip:ee,userinfo:te,user:ne,user_unreserved:re,password:se,hostport:ie,host:oe,hostname:ae,domainlabel:le,toplabel:ue,IPv6reference:ce,IPv6address:fe,h16:he,ls32:de,IPv4address:pe,dec_octet:_e,port:me,uri_parameters:ve,uri_parameter:ge,transport_param:ye,user_param:Te,method_param:be,ttl_param:Se,maddr_param:Ce,lr_param:Ee,other_param:Ae,pname:we,pvalue:Re,paramchar:Ie,param_unreserved:ke,headers:Oe,header:xe,hname:Ne,hvalue:Ue,hnv_unreserved:Pe,Request_Response:function e(){var t;null===(t=ct())&&(t=De());return t},Request_Line:De,Request_URI:Me,absoluteURI:qe,hier_part:Le,net_path:He,abs_path:je,opaque_part:Fe,uric:Be,uric_no_slash:Ge,path_segments:We,segment:Ve,param:Je,pchar:Ye,scheme:ze,authority:Ke,srvr:$e,reg_name:Xe,query:Qe,SIP_Version:Ze,INVITEm:et,ACKm:tt,OPTIONSm:nt,BYEm:rt,CANCELm:st,REGISTERm:it,SUBSCRIBEm:ot,NOTIFYm:at,REFERm:lt,Method:ut,Status_Line:ct,Status_Code:ft,extension_code:ht,Reason_Phrase:dt,Allow_Events:function e(){var t,n,r,s,i,o;if(i=g,null!==(t=qt())){for(n=[],o=g,null!==(r=j())&&null!==(s=qt())?r=[r,s]:(r=null,g=o);null!==r;){n.push(r),o=g,null!==(r=j())&&null!==(s=qt())?r=[r,s]:(r=null,g=o)}null!==n?t=[t,n]:(t=null,g=i)}else t=null,g=i;return t},Call_ID:function e(){var t,n,r,s,i,o;s=g,i=g,null!==(t=N())?(o=g,64===v.charCodeAt(g)?(n="@",g++):(n=null,0===y&&T('"@"')),null!==n&&null!==(r=N())?n=[n,r]:(n=null,g=o),null!==(n=null!==n?n:"")?t=[t,n]:(t=null,g=i)):(t=null,g=i);null!==t&&(a=s,t=void(jn=v.substring(g,a)));var a;null===t&&(g=s);return t},Contact:function e(){var t,n,r,s,i,o,a;if(i=g,null===(t=U()))if(o=g,null!==(t=pt())){for(n=[],a=g,null!==(r=j())&&null!==(s=pt())?r=[r,s]:(r=null,g=a);null!==r;){n.push(r),a=g,null!==(r=j())&&null!==(s=pt())?r=[r,s]:(r=null,g=a)}null!==n?t=[t,n]:(t=null,g=o)}else t=null,g=o;null!==t&&(t=function(e){var t,n;for(n=jn.multi_header.length,t=0;t<n;t++){if(null===jn.multi_header[t].parsed){jn=null;break}}jn=null!==jn?jn.multi_header:-1}());null===t&&(g=i);return t},contact_param:pt,name_addr:_t,display_name:mt,contact_params:vt,c_p_q:gt,c_p_expires:yt,delta_seconds:Tt,qvalue:bt,generic_param:St,gen_value:Ct,Content_Disposition:function e(){var t,n,r,s,i,o;if(i=g,null!==(t=Et())){for(n=[],o=g,null!==(r=F())&&null!==(s=At())?r=[r,s]:(r=null,g=o);null!==r;){n.push(r),o=g,null!==(r=F())&&null!==(s=At())?r=[r,s]:(r=null,g=o)}null!==n?t=[t,n]:(t=null,g=i)}else t=null,g=i;return t},disp_type:Et,disp_param:At,handling_param:wt,Content_Encoding:function e(){var t,n,r,s,i,o;if(i=g,null!==(t=O())){for(n=[],o=g,null!==(r=j())&&null!==(s=O())?r=[r,s]:(r=null,g=o);null!==r;){n.push(r),o=g,null!==(r=j())&&null!==(s=O())?r=[r,s]:(r=null,g=o)}null!==n?t=[t,n]:(t=null,g=i)}else t=null,g=i;return t},Content_Length:function e(){var t,n,r;if(r=g,null!==(n=u()))for(t=[];null!==n;){t.push(n),n=u()}else t=null;null!==t&&(t=void(jn=parseInt(t.join(""))));null===t&&(g=r);return t},Content_Type:function e(){var t,n;n=g,null!==(t=Rt())&&(r=n,t=void(jn=v.substring(g,r)));var r;null===t&&(g=n);return t},media_type:Rt,m_type:It,discrete_type:kt,composite_type:Ot,extension_token:xt,x_token:Nt,m_subtype:Ut,m_parameter:Pt,m_value:Dt,CSeq:function e(){var t,n,r,s;s=g,null!==(t=Mt())&&null!==(n=C())&&null!==(r=ut())?t=[t,n,r]:(t=null,g=s);return t},CSeq_value:Mt,Expires:function e(){var t,n;n=g,null!==(t=Tt())&&(t=void(jn=t));null===t&&(g=n);return t},Event:function e(){var t,n,r,s,i,o,a;if(i=g,o=g,null!==(t=qt())){for(n=[],a=g,null!==(r=F())&&null!==(s=St())?r=[r,s]:(r=null,g=a);null!==r;){n.push(r),a=g,null!==(r=F())&&null!==(s=St())?r=[r,s]:(r=null,g=a)}null!==n?t=[t,n]:(t=null,g=o)}else t=null,g=o;null!==t&&(l=t[0],t=void(jn.event=l.join("").toLowerCase()));var l;null===t&&(g=i);return t},event_type:qt,From:function e(){var t,n,r,s,i,o,a;i=g,o=g,null===(t=$())&&(t=_t());if(null!==t){for(n=[],a=g,null!==(r=F())&&null!==(s=Lt())?r=[r,s]:(r=null,g=a);null!==r;){n.push(r),a=g,null!==(r=F())&&null!==(s=Lt())?r=[r,s]:(r=null,g=a)}null!==n?t=[t,n]:(t=null,g=o)}else t=null,g=o;null!==t&&(t=function(e){var t=jn.tag;try{jn=new Hn(jn.uri,jn.display_name,jn.params),t&&jn.setParam("tag",t)}catch(e){jn=-1}}());null===t&&(g=i);return t},from_param:Lt,tag_param:Ht,Max_Forwards:function e(){var t,n,r;if(r=g,null!==(n=u()))for(t=[];null!==n;){t.push(n),n=u()}else t=null;null!==t&&(t=void(jn=parseInt(t.join(""))));null===t&&(g=r);return t},Min_Expires:function e(){var t,n;n=g,null!==(t=Tt())&&(t=void(jn=t));null===t&&(g=n);return t},Name_Addr_Header:function e(){var t,n,r,s,i,o,a,l,u,c;l=g,u=g,t=[],n=mt();for(;null!==n;){t.push(n),n=mt()}if(null!==t){if(null!==(n=H())){if(null!==(r=X())){if(null!==(s=L())){for(i=[],c=g,null!==(o=F())&&null!==(a=St())?o=[o,a]:(o=null,g=c);null!==o;){i.push(o),c=g,null!==(o=F())&&null!==(a=St())?o=[o,a]:(o=null,g=c)}null!==i?t=[t,n,r,s,i]:(t=null,g=u)}else t=null,g=u}else t=null,g=u}else t=null,g=u}else t=null,g=u;null!==t&&(t=function(e){try{jn=new Hn(jn.uri,jn.display_name,jn.params)}catch(e){jn=-1}}());null===t&&(g=l);return t},Proxy_Authenticate:function e(){return jt()},challenge:jt,other_challenge:Ft,auth_param:Bt,digest_cln:Gt,realm:Wt,realm_value:Vt,domain:Jt,URI:Yt,nonce:zt,nonce_value:Kt,opaque:$t,stale:Xt,algorithm:Qt,qop_options:Zt,qop_value:en,Proxy_Require:function e(){var t,n,r,s,i,o;if(i=g,null!==(t=O())){for(n=[],o=g,null!==(r=j())&&null!==(s=O())?r=[r,s]:(r=null,g=o);null!==r;){n.push(r),o=g,null!==(r=j())&&null!==(s=O())?r=[r,s]:(r=null,g=o)}null!==n?t=[t,n]:(t=null,g=i)}else t=null,g=i;return t},Record_Route:function e(){var t,n,r,s,i,o,a;if(i=g,o=g,null!==(t=tn())){for(n=[],a=g,null!==(r=j())&&null!==(s=tn())?r=[r,s]:(r=null,g=a);null!==r;){n.push(r),a=g,null!==(r=j())&&null!==(s=tn())?r=[r,s]:(r=null,g=a)}null!==n?t=[t,n]:(t=null,g=o)}else t=null,g=o;null!==t&&(t=function(e){var t,n;for(n=jn.multi_header.length,t=0;t<n;t++){if(null===jn.multi_header[t].parsed){jn=null;break}}jn=null!==jn?jn.multi_header:-1}());null===t&&(g=i);return t},rec_route:tn,Reason:function e(){var t,n,r,s,i,o,a;i=g,o=g,"sip"===v.substr(g,3).toLowerCase()?(t=v.substr(g,3),g+=3):(t=null,0===y&&T('"SIP"'));null===t&&(t=O());if(null!==t){for(n=[],a=g,null!==(r=F())&&null!==(s=nn())?r=[r,s]:(r=null,g=a);null!==r;){n.push(r),a=g,null!==(r=F())&&null!==(s=nn())?r=[r,s]:(r=null,g=a)}null!==n?t=[t,n]:(t=null,g=o)}else t=null,g=o;null!==t&&(t=function(e,t){if(jn.protocol=t.toLowerCase(),jn.params||(jn.params={}),jn.params.text&&'"'===jn.params.text[0]){var n=jn.params.text;jn.text=n.substring(1,n.length-1),delete jn.params.text}}(0,t[0]));null===t&&(g=i);return t},reason_param:nn,reason_cause:rn,Require:function e(){var t,n,r,s,i,o;if(i=g,null!==(t=O())){for(n=[],o=g,null!==(r=j())&&null!==(s=O())?r=[r,s]:(r=null,g=o);null!==r;){n.push(r),o=g,null!==(r=j())&&null!==(s=O())?r=[r,s]:(r=null,g=o)}null!==n?t=[t,n]:(t=null,g=i)}else t=null,g=i;return t},Route:function e(){var t,n,r,s,i,o;if(i=g,null!==(t=sn())){for(n=[],o=g,null!==(r=j())&&null!==(s=sn())?r=[r,s]:(r=null,g=o);null!==r;){n.push(r),o=g,null!==(r=j())&&null!==(s=sn())?r=[r,s]:(r=null,g=o)}null!==n?t=[t,n]:(t=null,g=i)}else t=null,g=i;return t},route_param:sn,Subscription_State:function e(){var t,n,r,s,i,o;if(i=g,null!==(t=on())){for(n=[],o=g,null!==(r=F())&&null!==(s=an())?r=[r,s]:(r=null,g=o);null!==r;){n.push(r),o=g,null!==(r=F())&&null!==(s=an())?r=[r,s]:(r=null,g=o)}null!==n?t=[t,n]:(t=null,g=i)}else t=null,g=i;return t},substate_value:on,subexp_params:an,event_reason_value:ln,Subject:function e(){var t;return t=null!==(t=w())?t:""},Supported:function e(){var t,n,r,s,i,o;if(i=g,null!==(t=O())){for(n=[],o=g,null!==(r=j())&&null!==(s=O())?r=[r,s]:(r=null,g=o);null!==r;){n.push(r),o=g,null!==(r=j())&&null!==(s=O())?r=[r,s]:(r=null,g=o)}null!==n?t=[t,n]:(t=null,g=i)}else t=null,g=i;return t=null!==t?t:""},To:function e(){var t,n,r,s,i,o,a;i=g,o=g,null===(t=$())&&(t=_t());if(null!==t){for(n=[],a=g,null!==(r=F())&&null!==(s=un())?r=[r,s]:(r=null,g=a);null!==r;){n.push(r),a=g,null!==(r=F())&&null!==(s=un())?r=[r,s]:(r=null,g=a)}null!==n?t=[t,n]:(t=null,g=o)}else t=null,g=o;null!==t&&(t=function(e){var t=jn.tag;try{jn=new Hn(jn.uri,jn.display_name,jn.params),t&&jn.setParam("tag",t)}catch(e){jn=-1}}());null===t&&(g=i);return t},to_param:un,Via:function e(){var t,n,r,s,i,o;if(i=g,null!==(t=cn())){for(n=[],o=g,null!==(r=j())&&null!==(s=cn())?r=[r,s]:(r=null,g=o);null!==r;){n.push(r),o=g,null!==(r=j())&&null!==(s=cn())?r=[r,s]:(r=null,g=o)}null!==n?t=[t,n]:(t=null,g=i)}else t=null,g=i;return t},via_param:cn,via_params:fn,via_ttl:hn,via_maddr:dn,via_received:pn,via_branch:_n,response_port:mn,rport:vn,sent_protocol:gn,protocol_name:yn,transport:Tn,sent_by:bn,via_host:Sn,via_port:Cn,ttl:En,WWW_Authenticate:function e(){return jt()},Session_Expires:function e(){var t,n,r,s,i,o;if(i=g,null!==(t=An())){for(n=[],o=g,null!==(r=F())&&null!==(s=wn())?r=[r,s]:(r=null,g=o);null!==r;){n.push(r),o=g,null!==(r=F())&&null!==(s=wn())?r=[r,s]:(r=null,g=o)}null!==n?t=[t,n]:(t=null,g=i)}else t=null,g=i;return t},s_e_expires:An,s_e_params:wn,s_e_refresher:Rn,extension_header:function e(){var t,n,r,s;s=g,null!==(t=O())&&null!==(n=A())&&null!==(r=In())?t=[t,n,r]:(t=null,g=s);return t},header_value:In,message_body:function e(){var t,n;t=[],n=r();for(;null!==n;){t.push(n),n=r()}return t},uuid_URI:function e(){var t,n,r;r=g,"uuid:"===v.substr(g,5)?(t="uuid:",g+=5):(t=null,0===y&&T('"uuid:"'));null!==t&&null!==(n=kn())?t=[t,n]:(t=null,g=r);return t},uuid:kn,hex4:On,hex8:xn,hex12:Nn,Refer_To:function e(){var t,n,r,s,i,o,a;i=g,o=g,null===(t=$())&&(t=_t());if(null!==t){for(n=[],a=g,null!==(r=F())&&null!==(s=St())?r=[r,s]:(r=null,g=a);null!==r;){n.push(r),a=g,null!==(r=F())&&null!==(s=St())?r=[r,s]:(r=null,g=a)}null!==n?t=[t,n]:(t=null,g=o)}else t=null,g=o;null!==t&&(t=function(e){try{jn=new Hn(jn.uri,jn.display_name,jn.params)}catch(e){jn=-1}}());null===t&&(g=i);return t},Replaces:function e(){var t,n,r,s,i,o;if(i=g,null!==(t=Un())){for(n=[],o=g,null!==(r=F())&&null!==(s=Pn())?r=[r,s]:(r=null,g=o);null!==r;){n.push(r),o=g,null!==(r=F())&&null!==(s=Pn())?r=[r,s]:(r=null,g=o)}null!==n?t=[t,n]:(t=null,g=i)}else t=null,g=i;return t},call_id:Un,replaces_param:Pn,to_tag:Dn,from_tag:Mn,early_flag:qn};if(void 0!==l){if(void 0===t[l])throw new Error("Invalid rule name: "+Wn(l)+".")}else l="CRLF";var g=0,y=0,i=0,n=[];function T(e){g<i||(g>i&&(i=g,n=[]),n.push(e))}function o(){var e;return"\r\n"===v.substr(g,2)?(e="\r\n",g+=2):(e=null,0===y&&T('"\\r\\n"')),e}function u(){var e;return/^[0-9]/.test(v.charAt(g))?(e=v.charAt(g),g++):(e=null,0===y&&T("[0-9]")),e}function a(){var e;return/^[a-zA-Z]/.test(v.charAt(g))?(e=v.charAt(g),g++):(e=null,0===y&&T("[a-zA-Z]")),e}function c(){var e;return/^[0-9a-fA-F]/.test(v.charAt(g))?(e=v.charAt(g),g++):(e=null,0===y&&T("[0-9a-fA-F]")),e}function f(){var e;return null===(e=d())&&(e=p()),e}function r(){var e;return/^[\0-\xFF]/.test(v.charAt(g))?(e=v.charAt(g),g++):(e=null,0===y&&T("[\\0-\\xFF]")),e}function h(){var e;return/^["]/.test(v.charAt(g))?(e=v.charAt(g),g++):(e=null,0===y&&T('["]')),e}function d(){var e;return 32===v.charCodeAt(g)?(e=" ",g++):(e=null,0===y&&T('" "')),e}function p(){var e;return 9===v.charCodeAt(g)?(e="\t",g++):(e=null,0===y&&T('"\\t"')),e}function s(){var e;return/^[a-zA-Z0-9]/.test(v.charAt(g))?(e=v.charAt(g),g++):(e=null,0===y&&T("[a-zA-Z0-9]")),e}function _(){var e;return 59===v.charCodeAt(g)?(e=";",g++):(e=null,0===y&&T('";"')),null===e&&(47===v.charCodeAt(g)?(e="/",g++):(e=null,0===y&&T('"/"')),null===e&&(63===v.charCodeAt(g)?(e="?",g++):(e=null,0===y&&T('"?"')),null===e&&(58===v.charCodeAt(g)?(e=":",g++):(e=null,0===y&&T('":"')),null===e&&(64===v.charCodeAt(g)?(e="@",g++):(e=null,0===y&&T('"@"')),null===e&&(38===v.charCodeAt(g)?(e="&",g++):(e=null,0===y&&T('"&"')),null===e&&(61===v.charCodeAt(g)?(e="=",g++):(e=null,0===y&&T('"="')),null===e&&(43===v.charCodeAt(g)?(e="+",g++):(e=null,0===y&&T('"+"')),null===e&&(36===v.charCodeAt(g)?(e="$",g++):(e=null,0===y&&T('"$"')),null===e&&(44===v.charCodeAt(g)?(e=",",g++):(e=null,0===y&&T('","'))))))))))),e}function m(){var e;return null===(e=s())&&(e=b()),e}function b(){var e;return 45===v.charCodeAt(g)?(e="-",g++):(e=null,0===y&&T('"-"')),null===e&&(95===v.charCodeAt(g)?(e="_",g++):(e=null,0===y&&T('"_"')),null===e&&(46===v.charCodeAt(g)?(e=".",g++):(e=null,0===y&&T('"."')),null===e&&(33===v.charCodeAt(g)?(e="!",g++):(e=null,0===y&&T('"!"')),null===e&&(126===v.charCodeAt(g)?(e="~",g++):(e=null,0===y&&T('"~"')),null===e&&(42===v.charCodeAt(g)?(e="*",g++):(e=null,0===y&&T('"*"')),null===e&&(39===v.charCodeAt(g)?(e="'",g++):(e=null,0===y&&T('"\'"')),null===e&&(40===v.charCodeAt(g)?(e="(",g++):(e=null,0===y&&T('"("')),null===e&&(41===v.charCodeAt(g)?(e=")",g++):(e=null,0===y&&T('")"')))))))))),e}function S(){var e,t,n,r,s;return r=g,s=g,37===v.charCodeAt(g)?(e="%",g++):(e=null,0===y&&T('"%"')),null!==e&&null!==(t=c())&&null!==(n=c())?e=[e,t,n]:(e=null,g=s),null!==e&&(e=e.join("")),null===e&&(g=r),e}function C(){var e,t,n,r,s,i;for(r=g,s=g,i=g,e=[],t=f();null!==t;){e.push(t),t=f()}if(null!==e&&null!==(t=o())?e=[e,t]:(e=null,g=i),null!==(e=null!==e?e:"")){if(null!==(n=f()))for(t=[];null!==n;){t.push(n),n=f()}else t=null;null!==t?e=[e,t]:(e=null,g=s)}else e=null,g=s;return null!==e&&(e=" "),null===e&&(g=r),e}function E(){var e;return e=null!==(e=C())?e:""}function A(){var e,t,n,r,s;for(r=g,s=g,e=[],null===(t=d())&&(t=p());null!==t;){e.push(t),null===(t=d())&&(t=p())}return null!==e?(58===v.charCodeAt(g)?(t=":",g++):(t=null,0===y&&T('":"')),null!==t&&null!==(n=E())?e=[e,t,n]:(e=null,g=s)):(e=null,g=s),null!==e&&(e=":"),null===e&&(g=r),e}function w(){var e,t,n,r,s,i,o,a;if(s=g,i=g,null!==(t=R()))for(e=[];null!==t;){e.push(t),t=R()}else e=null;if(null!==e){for(t=[],o=g,n=[],r=C();null!==r;){n.push(r),r=C()}for(null!==n&&null!==(r=R())?n=[n,r]:(n=null,g=o);null!==n;){for(t.push(n),o=g,n=[],r=C();null!==r;){n.push(r),r=C()}null!==n&&null!==(r=R())?n=[n,r]:(n=null,g=o)}null!==t?e=[e,t]:(e=null,g=i)}else e=null,g=i;return null!==e&&(a=s,e=v.substring(g,a)),null===e&&(g=s),e}function R(){var e;return/^[!-~]/.test(v.charAt(g))?(e=v.charAt(g),g++):(e=null,0===y&&T("[!-~]")),null===e&&(e=I()),e}function I(){var e;return/^[\x80-\uFFFF]/.test(v.charAt(g))?(e=v.charAt(g),g++):(e=null,0===y&&T("[\\x80-\\uFFFF]")),e}function k(){var e;return/^[\x80-\xBF]/.test(v.charAt(g))?(e=v.charAt(g),g++):(e=null,0===y&&T("[\\x80-\\xBF]")),e}function O(){var e,t,n,r;if(n=g,null===(t=s())&&(45===v.charCodeAt(g)?(t="-",g++):(t=null,0===y&&T('"-"')),null===t&&(46===v.charCodeAt(g)?(t=".",g++):(t=null,0===y&&T('"."')),null===t&&(33===v.charCodeAt(g)?(t="!",g++):(t=null,0===y&&T('"!"')),null===t&&(37===v.charCodeAt(g)?(t="%",g++):(t=null,0===y&&T('"%"')),null===t&&(42===v.charCodeAt(g)?(t="*",g++):(t=null,0===y&&T('"*"')),null===t&&(95===v.charCodeAt(g)?(t="_",g++):(t=null,0===y&&T('"_"')),null===t&&(43===v.charCodeAt(g)?(t="+",g++):(t=null,0===y&&T('"+"')),null===t&&(96===v.charCodeAt(g)?(t="`",g++):(t=null,0===y&&T('"`"')),null===t&&(39===v.charCodeAt(g)?(t="'",g++):(t=null,0===y&&T('"\'"')),null===t&&(126===v.charCodeAt(g)?(t="~",g++):(t=null,0===y&&T('"~"')))))))))))),null!==t)for(e=[];null!==t;){e.push(t),null===(t=s())&&(45===v.charCodeAt(g)?(t="-",g++):(t=null,0===y&&T('"-"')),null===t&&(46===v.charCodeAt(g)?(t=".",g++):(t=null,0===y&&T('"."')),null===t&&(33===v.charCodeAt(g)?(t="!",g++):(t=null,0===y&&T('"!"')),null===t&&(37===v.charCodeAt(g)?(t="%",g++):(t=null,0===y&&T('"%"')),null===t&&(42===v.charCodeAt(g)?(t="*",g++):(t=null,0===y&&T('"*"')),null===t&&(95===v.charCodeAt(g)?(t="_",g++):(t=null,0===y&&T('"_"')),null===t&&(43===v.charCodeAt(g)?(t="+",g++):(t=null,0===y&&T('"+"')),null===t&&(96===v.charCodeAt(g)?(t="`",g++):(t=null,0===y&&T('"`"')),null===t&&(39===v.charCodeAt(g)?(t="'",g++):(t=null,0===y&&T('"\'"')),null===t&&(126===v.charCodeAt(g)?(t="~",g++):(t=null,0===y&&T('"~"'))))))))))))}else e=null;return null!==e&&(r=n,e=v.substring(g,r)),null===e&&(g=n),e}function x(){var e,t,n,r;if(n=g,null===(t=s())&&(45===v.charCodeAt(g)?(t="-",g++):(t=null,0===y&&T('"-"')),null===t&&(33===v.charCodeAt(g)?(t="!",g++):(t=null,0===y&&T('"!"')),null===t&&(37===v.charCodeAt(g)?(t="%",g++):(t=null,0===y&&T('"%"')),null===t&&(42===v.charCodeAt(g)?(t="*",g++):(t=null,0===y&&T('"*"')),null===t&&(95===v.charCodeAt(g)?(t="_",g++):(t=null,0===y&&T('"_"')),null===t&&(43===v.charCodeAt(g)?(t="+",g++):(t=null,0===y&&T('"+"')),null===t&&(96===v.charCodeAt(g)?(t="`",g++):(t=null,0===y&&T('"`"')),null===t&&(39===v.charCodeAt(g)?(t="'",g++):(t=null,0===y&&T('"\'"')),null===t&&(126===v.charCodeAt(g)?(t="~",g++):(t=null,0===y&&T('"~"'))))))))))),null!==t)for(e=[];null!==t;){e.push(t),null===(t=s())&&(45===v.charCodeAt(g)?(t="-",g++):(t=null,0===y&&T('"-"')),null===t&&(33===v.charCodeAt(g)?(t="!",g++):(t=null,0===y&&T('"!"')),null===t&&(37===v.charCodeAt(g)?(t="%",g++):(t=null,0===y&&T('"%"')),null===t&&(42===v.charCodeAt(g)?(t="*",g++):(t=null,0===y&&T('"*"')),null===t&&(95===v.charCodeAt(g)?(t="_",g++):(t=null,0===y&&T('"_"')),null===t&&(43===v.charCodeAt(g)?(t="+",g++):(t=null,0===y&&T('"+"')),null===t&&(96===v.charCodeAt(g)?(t="`",g++):(t=null,0===y&&T('"`"')),null===t&&(39===v.charCodeAt(g)?(t="'",g++):(t=null,0===y&&T('"\'"')),null===t&&(126===v.charCodeAt(g)?(t="~",g++):(t=null,0===y&&T('"~"')))))))))))}else e=null;return null!==e&&(r=n,e=v.substring(g,r)),null===e&&(g=n),e}function N(){var e,t,n,r;if(n=g,null===(t=s())&&(45===v.charCodeAt(g)?(t="-",g++):(t=null,0===y&&T('"-"')),null===t&&(46===v.charCodeAt(g)?(t=".",g++):(t=null,0===y&&T('"."')),null===t&&(33===v.charCodeAt(g)?(t="!",g++):(t=null,0===y&&T('"!"')),null===t&&(37===v.charCodeAt(g)?(t="%",g++):(t=null,0===y&&T('"%"')),null===t&&(42===v.charCodeAt(g)?(t="*",g++):(t=null,0===y&&T('"*"')),null===t&&(95===v.charCodeAt(g)?(t="_",g++):(t=null,0===y&&T('"_"')),null===t&&(43===v.charCodeAt(g)?(t="+",g++):(t=null,0===y&&T('"+"')),null===t&&(96===v.charCodeAt(g)?(t="`",g++):(t=null,0===y&&T('"`"')),null===t&&(39===v.charCodeAt(g)?(t="'",g++):(t=null,0===y&&T('"\'"')),null===t&&(126===v.charCodeAt(g)?(t="~",g++):(t=null,0===y&&T('"~"')),null===t&&(40===v.charCodeAt(g)?(t="(",g++):(t=null,0===y&&T('"("')),null===t&&(41===v.charCodeAt(g)?(t=")",g++):(t=null,0===y&&T('")"')),null===t&&(60===v.charCodeAt(g)?(t="<",g++):(t=null,0===y&&T('"<"')),null===t&&(62===v.charCodeAt(g)?(t=">",g++):(t=null,0===y&&T('">"')),null===t&&(58===v.charCodeAt(g)?(t=":",g++):(t=null,0===y&&T('":"')),null===t&&(92===v.charCodeAt(g)?(t="\\",g++):(t=null,0===y&&T('"\\\\"')),null===t&&null===(t=h())&&(47===v.charCodeAt(g)?(t="/",g++):(t=null,0===y&&T('"/"')),null===t&&(91===v.charCodeAt(g)?(t="[",g++):(t=null,0===y&&T('"["')),null===t&&(93===v.charCodeAt(g)?(t="]",g++):(t=null,0===y&&T('"]"')),null===t&&(63===v.charCodeAt(g)?(t="?",g++):(t=null,0===y&&T('"?"')),null===t&&(123===v.charCodeAt(g)?(t="{",g++):(t=null,0===y&&T('"{"')),null===t&&(125===v.charCodeAt(g)?(t="}",g++):(t=null,0===y&&T('"}"')))))))))))))))))))))))),null!==t)for(e=[];null!==t;){e.push(t),null===(t=s())&&(45===v.charCodeAt(g)?(t="-",g++):(t=null,0===y&&T('"-"')),null===t&&(46===v.charCodeAt(g)?(t=".",g++):(t=null,0===y&&T('"."')),null===t&&(33===v.charCodeAt(g)?(t="!",g++):(t=null,0===y&&T('"!"')),null===t&&(37===v.charCodeAt(g)?(t="%",g++):(t=null,0===y&&T('"%"')),null===t&&(42===v.charCodeAt(g)?(t="*",g++):(t=null,0===y&&T('"*"')),null===t&&(95===v.charCodeAt(g)?(t="_",g++):(t=null,0===y&&T('"_"')),null===t&&(43===v.charCodeAt(g)?(t="+",g++):(t=null,0===y&&T('"+"')),null===t&&(96===v.charCodeAt(g)?(t="`",g++):(t=null,0===y&&T('"`"')),null===t&&(39===v.charCodeAt(g)?(t="'",g++):(t=null,0===y&&T('"\'"')),null===t&&(126===v.charCodeAt(g)?(t="~",g++):(t=null,0===y&&T('"~"')),null===t&&(40===v.charCodeAt(g)?(t="(",g++):(t=null,0===y&&T('"("')),null===t&&(41===v.charCodeAt(g)?(t=")",g++):(t=null,0===y&&T('")"')),null===t&&(60===v.charCodeAt(g)?(t="<",g++):(t=null,0===y&&T('"<"')),null===t&&(62===v.charCodeAt(g)?(t=">",g++):(t=null,0===y&&T('">"')),null===t&&(58===v.charCodeAt(g)?(t=":",g++):(t=null,0===y&&T('":"')),null===t&&(92===v.charCodeAt(g)?(t="\\",g++):(t=null,0===y&&T('"\\\\"')),null===t&&null===(t=h())&&(47===v.charCodeAt(g)?(t="/",g++):(t=null,0===y&&T('"/"')),null===t&&(91===v.charCodeAt(g)?(t="[",g++):(t=null,0===y&&T('"["')),null===t&&(93===v.charCodeAt(g)?(t="]",g++):(t=null,0===y&&T('"]"')),null===t&&(63===v.charCodeAt(g)?(t="?",g++):(t=null,0===y&&T('"?"')),null===t&&(123===v.charCodeAt(g)?(t="{",g++):(t=null,0===y&&T('"{"')),null===t&&(125===v.charCodeAt(g)?(t="}",g++):(t=null,0===y&&T('"}"'))))))))))))))))))))))))}else e=null;return null!==e&&(r=n,e=v.substring(g,r)),null===e&&(g=n),e}function U(){var e,t,n,r,s;return r=g,s=g,null!==(e=E())?(42===v.charCodeAt(g)?(t="*",g++):(t=null,0===y&&T('"*"')),null!==t&&null!==(n=E())?e=[e,t,n]:(e=null,g=s)):(e=null,g=s),null!==e&&(e="*"),null===e&&(g=r),e}function P(){var e,t,n,r,s;return r=g,s=g,null!==(e=E())?(47===v.charCodeAt(g)?(t="/",g++):(t=null,0===y&&T('"/"')),null!==t&&null!==(n=E())?e=[e,t,n]:(e=null,g=s)):(e=null,g=s),null!==e&&(e="/"),null===e&&(g=r),e}function D(){var e,t,n,r,s;return r=g,s=g,null!==(e=E())?(61===v.charCodeAt(g)?(t="=",g++):(t=null,0===y&&T('"="')),null!==t&&null!==(n=E())?e=[e,t,n]:(e=null,g=s)):(e=null,g=s),null!==e&&(e="="),null===e&&(g=r),e}function M(){var e,t,n,r,s;return r=g,s=g,null!==(e=E())?(40===v.charCodeAt(g)?(t="(",g++):(t=null,0===y&&T('"("')),null!==t&&null!==(n=E())?e=[e,t,n]:(e=null,g=s)):(e=null,g=s),null!==e&&(e="("),null===e&&(g=r),e}function q(){var e,t,n,r,s;return r=g,s=g,null!==(e=E())?(41===v.charCodeAt(g)?(t=")",g++):(t=null,0===y&&T('")"')),null!==t&&null!==(n=E())?e=[e,t,n]:(e=null,g=s)):(e=null,g=s),null!==e&&(e=")"),null===e&&(g=r),e}function L(){var e,t,n,r;return n=g,r=g,62===v.charCodeAt(g)?(e=">",g++):(e=null,0===y&&T('">"')),null!==e&&null!==(t=E())?e=[e,t]:(e=null,g=r),null!==e&&(e=">"),null===e&&(g=n),e}function H(){var e,t,n,r;return n=g,r=g,null!==(e=E())?(60===v.charCodeAt(g)?(t="<",g++):(t=null,0===y&&T('"<"')),null!==t?e=[e,t]:(e=null,g=r)):(e=null,g=r),null!==e&&(e="<"),null===e&&(g=n),e}function j(){var e,t,n,r,s;return r=g,s=g,null!==(e=E())?(44===v.charCodeAt(g)?(t=",",g++):(t=null,0===y&&T('","')),null!==t&&null!==(n=E())?e=[e,t,n]:(e=null,g=s)):(e=null,g=s),null!==e&&(e=","),null===e&&(g=r),e}function F(){var e,t,n,r,s;return r=g,s=g,null!==(e=E())?(59===v.charCodeAt(g)?(t=";",g++):(t=null,0===y&&T('";"')),null!==t&&null!==(n=E())?e=[e,t,n]:(e=null,g=s)):(e=null,g=s),null!==e&&(e=";"),null===e&&(g=r),e}function B(){var e,t,n,r,s;return r=g,s=g,null!==(e=E())?(58===v.charCodeAt(g)?(t=":",g++):(t=null,0===y&&T('":"')),null!==t&&null!==(n=E())?e=[e,t,n]:(e=null,g=s)):(e=null,g=s),null!==e&&(e=":"),null===e&&(g=r),e}function G(){var e,t,n,r;return n=g,r=g,null!==(e=E())&&null!==(t=h())?e=[e,t]:(e=null,g=r),null!==e&&(e='"'),null===e&&(g=n),e}function W(){var e,t,n,r;return n=g,r=g,null!==(e=h())&&null!==(t=E())?e=[e,t]:(e=null,g=r),null!==e&&(e='"'),null===e&&(g=n),e}function V(){var e;return/^[!-']/.test(v.charAt(g))?(e=v.charAt(g),g++):(e=null,0===y&&T("[!-']")),null===e&&(/^[*-[]/.test(v.charAt(g))?(e=v.charAt(g),g++):(e=null,0===y&&T("[*-[]")),null===e&&(/^[\]-~]/.test(v.charAt(g))?(e=v.charAt(g),g++):(e=null,0===y&&T("[\\]-~]")),null===e&&null===(e=I())&&(e=C()))),e}function J(){var e,t,n,r,s,i,o;if(s=g,i=g,null!==(e=E())){if(null!==(t=h())){for(n=[],null===(r=z())&&(r=K());null!==r;){n.push(r),null===(r=z())&&(r=K())}null!==n&&null!==(r=h())?e=[e,t,n,r]:(e=null,g=i)}else e=null,g=i}else e=null,g=i;return null!==e&&(o=s,e=v.substring(g,o)),null===e&&(g=s),e}function Y(){var e,t,n,r,s,i,o,a;if(s=g,i=g,null!==(e=E())){if(null!==(t=h())){for(n=[],null===(r=z())&&(r=K());null!==r;){n.push(r),null===(r=z())&&(r=K())}null!==n&&null!==(r=h())?e=[e,t,n,r]:(e=null,g=i)}else e=null,g=i}else e=null,g=i;return null!==e&&(o=s,e=(a=v.substring(g,o).trim()).substring(1,a.length-1).replace(/\\([\x00-\x09\x0b-\x0c\x0e-\x7f])/g,"$1")),null===e&&(g=s),e}function z(){var e;return null===(e=C())&&(33===v.charCodeAt(g)?(e="!",g++):(e=null,0===y&&T('"!"')),null===e&&(/^[#-[]/.test(v.charAt(g))?(e=v.charAt(g),g++):(e=null,0===y&&T("[#-[]")),null===e&&(/^[\]-~]/.test(v.charAt(g))?(e=v.charAt(g),g++):(e=null,0===y&&T("[\\]-~]")),null===e&&(e=I())))),e}function K(){var e,t,n;return n=g,92===v.charCodeAt(g)?(e="\\",g++):(e=null,0===y&&T('"\\\\"')),null!==e?(/^[\0-\t]/.test(v.charAt(g))?(t=v.charAt(g),g++):(t=null,0===y&&T("[\\0-\\t]")),null===t&&(/^[\x0B-\f]/.test(v.charAt(g))?(t=v.charAt(g),g++):(t=null,0===y&&T("[\\x0B-\\f]")),null===t&&(/^[\x0E-]/.test(v.charAt(g))?(t=v.charAt(g),g++):(t=null,0===y&&T("[\\x0E-]")))),null!==t?e=[e,t]:(e=null,g=n)):(e=null,g=n),e}function $(){var e,t,n,r,s,i;return s=g,i=g,null!==(e=Q())?(58===v.charCodeAt(g)?(t=":",g++):(t=null,0===y&&T('":"')),null!==t&&null!==(n=null!==(n=te())?n:"")&&null!==(r=ie())?e=[e,t,n,r]:(e=null,g=i)):(e=null,g=i),null!==e&&(e=function(e){try{jn.uri=new Ln(jn.scheme,jn.user,jn.host,jn.port),delete jn.scheme,delete jn.user,delete jn.host,delete jn.host_type,delete jn.port}catch(e){jn=-1}}()),null===e&&(g=s),e}function X(){var e,t,n,r,s,i,o,a;return o=g,a=g,null!==(e=Q())?(58===v.charCodeAt(g)?(t=":",g++):(t=null,0===y&&T('":"')),null!==t&&null!==(n=null!==(n=te())?n:"")&&null!==(r=ie())&&null!==(s=ve())&&null!==(i=null!==(i=Oe())?i:"")?e=[e,t,n,r,s,i]:(e=null,g=a)):(e=null,g=a),null!==e&&(e=function(e){try{jn.uri=new Ln(jn.scheme,jn.user,jn.host,jn.port,jn.uri_params,jn.uri_headers),delete jn.scheme,delete jn.user,delete jn.host,delete jn.host_type,delete jn.port,delete jn.uri_params,"SIP_URI"===l&&(jn=jn.uri)}catch(e){jn=-1}}()),null===e&&(g=o),e}function Q(){var e;return null===(e=Z())&&(e=ee()),e}function Z(){var e,t,n;return t=g,"sips"===v.substr(g,4).toLowerCase()?(e=v.substr(g,4),g+=4):(e=null,0===y&&T('"sips"')),null!==e&&(n=e,e=void(jn.scheme=n.toLowerCase())),null===e&&(g=t),e}function ee(){var e,t,n;return t=g,"sip"===v.substr(g,3).toLowerCase()?(e=v.substr(g,3),g+=3):(e=null,0===y&&T('"sip"')),null!==e&&(n=e,e=void(jn.scheme=n.toLowerCase())),null===e&&(g=t),e}function te(){var e,t,n,r,s,i,o;return r=g,s=g,null!==(e=ne())?(i=g,58===v.charCodeAt(g)?(t=":",g++):(t=null,0===y&&T('":"')),null!==t&&null!==(n=se())?t=[t,n]:(t=null,g=i),null!==(t=null!==t?t:"")?(64===v.charCodeAt(g)?(n="@",g++):(n=null,0===y&&T('"@"')),null!==n?e=[e,t,n]:(e=null,g=s)):(e=null,g=s)):(e=null,g=s),null!==e&&(o=r,e=void(jn.user=decodeURIComponent(v.substring(g-1,o)))),null===e&&(g=r),e}function ne(){var e,t;if(null===(t=m())&&null===(t=S())&&(t=re()),null!==t)for(e=[];null!==t;){e.push(t),null===(t=m())&&null===(t=S())&&(t=re())}else e=null;return e}function re(){var e;return 38===v.charCodeAt(g)?(e="&",g++):(e=null,0===y&&T('"&"')),null===e&&(61===v.charCodeAt(g)?(e="=",g++):(e=null,0===y&&T('"="')),null===e&&(43===v.charCodeAt(g)?(e="+",g++):(e=null,0===y&&T('"+"')),null===e&&(36===v.charCodeAt(g)?(e="$",g++):(e=null,0===y&&T('"$"')),null===e&&(44===v.charCodeAt(g)?(e=",",g++):(e=null,0===y&&T('","')),null===e&&(59===v.charCodeAt(g)?(e=";",g++):(e=null,0===y&&T('";"')),null===e&&(63===v.charCodeAt(g)?(e="?",g++):(e=null,0===y&&T('"?"')),null===e&&(47===v.charCodeAt(g)?(e="/",g++):(e=null,0===y&&T('"/"'))))))))),e}function se(){var e,t,n,r;for(n=g,e=[],null===(t=m())&&null===(t=S())&&(38===v.charCodeAt(g)?(t="&",g++):(t=null,0===y&&T('"&"')),null===t&&(61===v.charCodeAt(g)?(t="=",g++):(t=null,0===y&&T('"="')),null===t&&(43===v.charCodeAt(g)?(t="+",g++):(t=null,0===y&&T('"+"')),null===t&&(36===v.charCodeAt(g)?(t="$",g++):(t=null,0===y&&T('"$"')),null===t&&(44===v.charCodeAt(g)?(t=",",g++):(t=null,0===y&&T('","')))))));null!==t;){e.push(t),null===(t=m())&&null===(t=S())&&(38===v.charCodeAt(g)?(t="&",g++):(t=null,0===y&&T('"&"')),null===t&&(61===v.charCodeAt(g)?(t="=",g++):(t=null,0===y&&T('"="')),null===t&&(43===v.charCodeAt(g)?(t="+",g++):(t=null,0===y&&T('"+"')),null===t&&(36===v.charCodeAt(g)?(t="$",g++):(t=null,0===y&&T('"$"')),null===t&&(44===v.charCodeAt(g)?(t=",",g++):(t=null,0===y&&T('","')))))))}return null!==e&&(r=n,e=void(jn.password=v.substring(g,r))),null===e&&(g=n),e}function ie(){var e,t,n,r,s;return r=g,null!==(e=oe())?(s=g,58===v.charCodeAt(g)?(t=":",g++):(t=null,0===y&&T('":"')),null!==t&&null!==(n=me())?t=[t,n]:(t=null,g=s),null!==(t=null!==t?t:"")?e=[e,t]:(e=null,g=r)):(e=null,g=r),e}function oe(){var e,t,n;return t=g,null===(e=ae())&&null===(e=pe())&&(e=ce()),null!==e&&(n=t,jn.host=v.substring(g,n).toLowerCase(),e=jn.host),null===e&&(g=t),e}function ae(){var e,t,n,r,s,i,o;for(r=g,s=g,e=[],i=g,null!==(t=le())?(46===v.charCodeAt(g)?(n=".",g++):(n=null,0===y&&T('"."')),null!==n?t=[t,n]:(t=null,g=i)):(t=null,g=i);null!==t;){e.push(t),i=g,null!==(t=le())?(46===v.charCodeAt(g)?(n=".",g++):(n=null,0===y&&T('"."')),null!==n?t=[t,n]:(t=null,g=i)):(t=null,g=i)}return null!==e&&null!==(t=ue())?(46===v.charCodeAt(g)?(n=".",g++):(n=null,0===y&&T('"."')),null!==(n=null!==n?n:"")?e=[e,t,n]:(e=null,g=s)):(e=null,g=s),null!==e&&(o=r,jn.host_type="domain",e=v.substring(g,o)),null===e&&(g=r),e}function le(){var e,t,n,r;if(r=g,null!==(e=s())){for(t=[],null===(n=s())&&(45===v.charCodeAt(g)?(n="-",g++):(n=null,0===y&&T('"-"')),null===n&&(95===v.charCodeAt(g)?(n="_",g++):(n=null,0===y&&T('"_"'))));null!==n;){t.push(n),null===(n=s())&&(45===v.charCodeAt(g)?(n="-",g++):(n=null,0===y&&T('"-"')),null===n&&(95===v.charCodeAt(g)?(n="_",g++):(n=null,0===y&&T('"_"'))))}null!==t?e=[e,t]:(e=null,g=r)}else e=null,g=r;return e}function ue(){var e,t,n,r;if(r=g,null!==(e=a())){for(t=[],null===(n=s())&&(45===v.charCodeAt(g)?(n="-",g++):(n=null,0===y&&T('"-"')),null===n&&(95===v.charCodeAt(g)?(n="_",g++):(n=null,0===y&&T('"_"'))));null!==n;){t.push(n),null===(n=s())&&(45===v.charCodeAt(g)?(n="-",g++):(n=null,0===y&&T('"-"')),null===n&&(95===v.charCodeAt(g)?(n="_",g++):(n=null,0===y&&T('"_"'))))}null!==t?e=[e,t]:(e=null,g=r)}else e=null,g=r;return e}function ce(){var e,t,n,r,s,i;return r=g,s=g,91===v.charCodeAt(g)?(e="[",g++):(e=null,0===y&&T('"["')),null!==e&&null!==(t=fe())?(93===v.charCodeAt(g)?(n="]",g++):(n=null,0===y&&T('"]"')),null!==n?e=[e,t,n]:(e=null,g=s)):(e=null,g=s),null!==e&&(i=r,jn.host_type="IPv6",e=v.substring(g,i)),null===e&&(g=r),e}function fe(){var e,t,n,r,s,i,o,a,l,u,c,f,h,d,p,_,m;return d=g,p=g,null!==(e=he())?(58===v.charCodeAt(g)?(t=":",g++):(t=null,0===y&&T('":"')),null!==t&&null!==(n=he())?(58===v.charCodeAt(g)?(r=":",g++):(r=null,0===y&&T('":"')),null!==r&&null!==(s=he())?(58===v.charCodeAt(g)?(i=":",g++):(i=null,0===y&&T('":"')),null!==i&&null!==(o=he())?(58===v.charCodeAt(g)?(a=":",g++):(a=null,0===y&&T('":"')),null!==a&&null!==(l=he())?(58===v.charCodeAt(g)?(u=":",g++):(u=null,0===y&&T('":"')),null!==u&&null!==(c=he())?(58===v.charCodeAt(g)?(f=":",g++):(f=null,0===y&&T('":"')),null!==f&&null!==(h=de())?e=[e,t,n,r,s,i,o,a,l,u,c,f,h]:(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p),null===e&&(p=g,"::"===v.substr(g,2)?(e="::",g+=2):(e=null,0===y&&T('"::"')),null!==e&&null!==(t=he())?(58===v.charCodeAt(g)?(n=":",g++):(n=null,0===y&&T('":"')),null!==n&&null!==(r=he())?(58===v.charCodeAt(g)?(s=":",g++):(s=null,0===y&&T('":"')),null!==s&&null!==(i=he())?(58===v.charCodeAt(g)?(o=":",g++):(o=null,0===y&&T('":"')),null!==o&&null!==(a=he())?(58===v.charCodeAt(g)?(l=":",g++):(l=null,0===y&&T('":"')),null!==l&&null!==(u=he())?(58===v.charCodeAt(g)?(c=":",g++):(c=null,0===y&&T('":"')),null!==c&&null!==(f=de())?e=[e,t,n,r,s,i,o,a,l,u,c,f]:(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p),null===e&&(p=g,"::"===v.substr(g,2)?(e="::",g+=2):(e=null,0===y&&T('"::"')),null!==e&&null!==(t=he())?(58===v.charCodeAt(g)?(n=":",g++):(n=null,0===y&&T('":"')),null!==n&&null!==(r=he())?(58===v.charCodeAt(g)?(s=":",g++):(s=null,0===y&&T('":"')),null!==s&&null!==(i=he())?(58===v.charCodeAt(g)?(o=":",g++):(o=null,0===y&&T('":"')),null!==o&&null!==(a=he())?(58===v.charCodeAt(g)?(l=":",g++):(l=null,0===y&&T('":"')),null!==l&&null!==(u=de())?e=[e,t,n,r,s,i,o,a,l,u]:(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p),null===e&&(p=g,"::"===v.substr(g,2)?(e="::",g+=2):(e=null,0===y&&T('"::"')),null!==e&&null!==(t=he())?(58===v.charCodeAt(g)?(n=":",g++):(n=null,0===y&&T('":"')),null!==n&&null!==(r=he())?(58===v.charCodeAt(g)?(s=":",g++):(s=null,0===y&&T('":"')),null!==s&&null!==(i=he())?(58===v.charCodeAt(g)?(o=":",g++):(o=null,0===y&&T('":"')),null!==o&&null!==(a=de())?e=[e,t,n,r,s,i,o,a]:(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p),null===e&&(p=g,"::"===v.substr(g,2)?(e="::",g+=2):(e=null,0===y&&T('"::"')),null!==e&&null!==(t=he())?(58===v.charCodeAt(g)?(n=":",g++):(n=null,0===y&&T('":"')),null!==n&&null!==(r=he())?(58===v.charCodeAt(g)?(s=":",g++):(s=null,0===y&&T('":"')),null!==s&&null!==(i=de())?e=[e,t,n,r,s,i]:(e=null,g=p)):(e=null,g=p)):(e=null,g=p),null===e&&(p=g,"::"===v.substr(g,2)?(e="::",g+=2):(e=null,0===y&&T('"::"')),null!==e&&null!==(t=he())?(58===v.charCodeAt(g)?(n=":",g++):(n=null,0===y&&T('":"')),null!==n&&null!==(r=de())?e=[e,t,n,r]:(e=null,g=p)):(e=null,g=p),null===e&&(p=g,"::"===v.substr(g,2)?(e="::",g+=2):(e=null,0===y&&T('"::"')),null!==e&&null!==(t=de())?e=[e,t]:(e=null,g=p),null===e&&(p=g,"::"===v.substr(g,2)?(e="::",g+=2):(e=null,0===y&&T('"::"')),null!==e&&null!==(t=he())?e=[e,t]:(e=null,g=p),null===e&&(p=g,null!==(e=he())?("::"===v.substr(g,2)?(t="::",g+=2):(t=null,0===y&&T('"::"')),null!==t&&null!==(n=he())?(58===v.charCodeAt(g)?(r=":",g++):(r=null,0===y&&T('":"')),null!==r&&null!==(s=he())?(58===v.charCodeAt(g)?(i=":",g++):(i=null,0===y&&T('":"')),null!==i&&null!==(o=he())?(58===v.charCodeAt(g)?(a=":",g++):(a=null,0===y&&T('":"')),null!==a&&null!==(l=he())?(58===v.charCodeAt(g)?(u=":",g++):(u=null,0===y&&T('":"')),null!==u&&null!==(c=de())?e=[e,t,n,r,s,i,o,a,l,u,c]:(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p),null===e&&(p=g,null!==(e=he())?(_=g,58===v.charCodeAt(g)?(t=":",g++):(t=null,0===y&&T('":"')),null!==t&&null!==(n=he())?t=[t,n]:(t=null,g=_),null!==(t=null!==t?t:"")?("::"===v.substr(g,2)?(n="::",g+=2):(n=null,0===y&&T('"::"')),null!==n&&null!==(r=he())?(58===v.charCodeAt(g)?(s=":",g++):(s=null,0===y&&T('":"')),null!==s&&null!==(i=he())?(58===v.charCodeAt(g)?(o=":",g++):(o=null,0===y&&T('":"')),null!==o&&null!==(a=he())?(58===v.charCodeAt(g)?(l=":",g++):(l=null,0===y&&T('":"')),null!==l&&null!==(u=de())?e=[e,t,n,r,s,i,o,a,l,u]:(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p),null===e&&(p=g,null!==(e=he())?(_=g,58===v.charCodeAt(g)?(t=":",g++):(t=null,0===y&&T('":"')),null!==t&&null!==(n=he())?t=[t,n]:(t=null,g=_),null!==(t=null!==t?t:"")?(_=g,58===v.charCodeAt(g)?(n=":",g++):(n=null,0===y&&T('":"')),null!==n&&null!==(r=he())?n=[n,r]:(n=null,g=_),null!==(n=null!==n?n:"")?("::"===v.substr(g,2)?(r="::",g+=2):(r=null,0===y&&T('"::"')),null!==r&&null!==(s=he())?(58===v.charCodeAt(g)?(i=":",g++):(i=null,0===y&&T('":"')),null!==i&&null!==(o=he())?(58===v.charCodeAt(g)?(a=":",g++):(a=null,0===y&&T('":"')),null!==a&&null!==(l=de())?e=[e,t,n,r,s,i,o,a,l]:(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p),null===e&&(p=g,null!==(e=he())?(_=g,58===v.charCodeAt(g)?(t=":",g++):(t=null,0===y&&T('":"')),null!==t&&null!==(n=he())?t=[t,n]:(t=null,g=_),null!==(t=null!==t?t:"")?(_=g,58===v.charCodeAt(g)?(n=":",g++):(n=null,0===y&&T('":"')),null!==n&&null!==(r=he())?n=[n,r]:(n=null,g=_),null!==(n=null!==n?n:"")?(_=g,58===v.charCodeAt(g)?(r=":",g++):(r=null,0===y&&T('":"')),null!==r&&null!==(s=he())?r=[r,s]:(r=null,g=_),null!==(r=null!==r?r:"")?("::"===v.substr(g,2)?(s="::",g+=2):(s=null,0===y&&T('"::"')),null!==s&&null!==(i=he())?(58===v.charCodeAt(g)?(o=":",g++):(o=null,0===y&&T('":"')),null!==o&&null!==(a=de())?e=[e,t,n,r,s,i,o,a]:(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p),null===e&&(p=g,null!==(e=he())?(_=g,58===v.charCodeAt(g)?(t=":",g++):(t=null,0===y&&T('":"')),null!==t&&null!==(n=he())?t=[t,n]:(t=null,g=_),null!==(t=null!==t?t:"")?(_=g,58===v.charCodeAt(g)?(n=":",g++):(n=null,0===y&&T('":"')),null!==n&&null!==(r=he())?n=[n,r]:(n=null,g=_),null!==(n=null!==n?n:"")?(_=g,58===v.charCodeAt(g)?(r=":",g++):(r=null,0===y&&T('":"')),null!==r&&null!==(s=he())?r=[r,s]:(r=null,g=_),null!==(r=null!==r?r:"")?(_=g,58===v.charCodeAt(g)?(s=":",g++):(s=null,0===y&&T('":"')),null!==s&&null!==(i=he())?s=[s,i]:(s=null,g=_),null!==(s=null!==s?s:"")?("::"===v.substr(g,2)?(i="::",g+=2):(i=null,0===y&&T('"::"')),null!==i&&null!==(o=de())?e=[e,t,n,r,s,i,o]:(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p),null===e&&(p=g,null!==(e=he())?(_=g,58===v.charCodeAt(g)?(t=":",g++):(t=null,0===y&&T('":"')),null!==t&&null!==(n=he())?t=[t,n]:(t=null,g=_),null!==(t=null!==t?t:"")?(_=g,58===v.charCodeAt(g)?(n=":",g++):(n=null,0===y&&T('":"')),null!==n&&null!==(r=he())?n=[n,r]:(n=null,g=_),null!==(n=null!==n?n:"")?(_=g,58===v.charCodeAt(g)?(r=":",g++):(r=null,0===y&&T('":"')),null!==r&&null!==(s=he())?r=[r,s]:(r=null,g=_),null!==(r=null!==r?r:"")?(_=g,58===v.charCodeAt(g)?(s=":",g++):(s=null,0===y&&T('":"')),null!==s&&null!==(i=he())?s=[s,i]:(s=null,g=_),null!==(s=null!==s?s:"")?(_=g,58===v.charCodeAt(g)?(i=":",g++):(i=null,0===y&&T('":"')),null!==i&&null!==(o=he())?i=[i,o]:(i=null,g=_),null!==(i=null!==i?i:"")?("::"===v.substr(g,2)?(o="::",g+=2):(o=null,0===y&&T('"::"')),null!==o&&null!==(a=he())?e=[e,t,n,r,s,i,o,a]:(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p),null===e&&(p=g,null!==(e=he())?(_=g,58===v.charCodeAt(g)?(t=":",g++):(t=null,0===y&&T('":"')),null!==t&&null!==(n=he())?t=[t,n]:(t=null,g=_),null!==(t=null!==t?t:"")?(_=g,58===v.charCodeAt(g)?(n=":",g++):(n=null,0===y&&T('":"')),null!==n&&null!==(r=he())?n=[n,r]:(n=null,g=_),null!==(n=null!==n?n:"")?(_=g,58===v.charCodeAt(g)?(r=":",g++):(r=null,0===y&&T('":"')),null!==r&&null!==(s=he())?r=[r,s]:(r=null,g=_),null!==(r=null!==r?r:"")?(_=g,58===v.charCodeAt(g)?(s=":",g++):(s=null,0===y&&T('":"')),null!==s&&null!==(i=he())?s=[s,i]:(s=null,g=_),null!==(s=null!==s?s:"")?(_=g,58===v.charCodeAt(g)?(i=":",g++):(i=null,0===y&&T('":"')),null!==i&&null!==(o=he())?i=[i,o]:(i=null,g=_),null!==(i=null!==i?i:"")?(_=g,58===v.charCodeAt(g)?(o=":",g++):(o=null,0===y&&T('":"')),null!==o&&null!==(a=he())?o=[o,a]:(o=null,g=_),null!==(o=null!==o?o:"")?("::"===v.substr(g,2)?(a="::",g+=2):(a=null,0===y&&T('"::"')),null!==a?e=[e,t,n,r,s,i,o,a]:(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p)):(e=null,g=p))))))))))))))),null!==e&&(m=d,jn.host_type="IPv6",e=v.substring(g,m)),null===e&&(g=d),e}function he(){var e,t,n,r,s;return s=g,null!==(e=c())&&null!==(t=null!==(t=c())?t:"")&&null!==(n=null!==(n=c())?n:"")&&null!==(r=null!==(r=c())?r:"")?e=[e,t,n,r]:(e=null,g=s),e}function de(){var e,t,n,r;return r=g,null!==(e=he())?(58===v.charCodeAt(g)?(t=":",g++):(t=null,0===y&&T('":"')),null!==t&&null!==(n=he())?e=[e,t,n]:(e=null,g=r)):(e=null,g=r),null===e&&(e=pe()),e}function pe(){var e,t,n,r,s,i,o,a,l,u;return a=g,l=g,null!==(e=_e())?(46===v.charCodeAt(g)?(t=".",g++):(t=null,0===y&&T('"."')),null!==t&&null!==(n=_e())?(46===v.charCodeAt(g)?(r=".",g++):(r=null,0===y&&T('"."')),null!==r&&null!==(s=_e())?(46===v.charCodeAt(g)?(i=".",g++):(i=null,0===y&&T('"."')),null!==i&&null!==(o=_e())?e=[e,t,n,r,s,i,o]:(e=null,g=l)):(e=null,g=l)):(e=null,g=l)):(e=null,g=l),null!==e&&(u=a,jn.host_type="IPv4",e=v.substring(g,u)),null===e&&(g=a),e}function _e(){var e,t,n,r;return r=g,"25"===v.substr(g,2)?(e="25",g+=2):(e=null,0===y&&T('"25"')),null!==e?(/^[0-5]/.test(v.charAt(g))?(t=v.charAt(g),g++):(t=null,0===y&&T("[0-5]")),null!==t?e=[e,t]:(e=null,g=r)):(e=null,g=r),null===e&&(r=g,50===v.charCodeAt(g)?(e="2",g++):(e=null,0===y&&T('"2"')),null!==e?(/^[0-4]/.test(v.charAt(g))?(t=v.charAt(g),g++):(t=null,0===y&&T("[0-4]")),null!==t&&null!==(n=u())?e=[e,t,n]:(e=null,g=r)):(e=null,g=r),null===e&&(r=g,49===v.charCodeAt(g)?(e="1",g++):(e=null,0===y&&T('"1"')),null!==e&&null!==(t=u())&&null!==(n=u())?e=[e,t,n]:(e=null,g=r),null===e&&(r=g,/^[1-9]/.test(v.charAt(g))?(e=v.charAt(g),g++):(e=null,0===y&&T("[1-9]")),null!==e&&null!==(t=u())?e=[e,t]:(e=null,g=r),null===e&&(e=u())))),e}function me(){var e,t,n,r,s,i,o,a;return i=g,o=g,null!==(e=null!==(e=u())?e:"")&&null!==(t=null!==(t=u())?t:"")&&null!==(n=null!==(n=u())?n:"")&&null!==(r=null!==(r=u())?r:"")&&null!==(s=null!==(s=u())?s:"")?e=[e,t,n,r,s]:(e=null,g=o),null!==e&&(a=e,a=parseInt(a.join("")),jn.port=a,e=a),null===e&&(g=i),e}function ve(){var e,t,n,r;for(e=[],r=g,59===v.charCodeAt(g)?(t=";",g++):(t=null,0===y&&T('";"')),null!==t&&null!==(n=ge())?t=[t,n]:(t=null,g=r);null!==t;){e.push(t),r=g,59===v.charCodeAt(g)?(t=";",g++):(t=null,0===y&&T('";"')),null!==t&&null!==(n=ge())?t=[t,n]:(t=null,g=r)}return e}function ge(){var e;return null===(e=ye())&&null===(e=Te())&&null===(e=be())&&null===(e=Se())&&null===(e=Ce())&&null===(e=Ee())&&(e=Ae()),e}function ye(){var e,t,n,r,s;return n=g,r=g,"transport="===v.substr(g,10).toLowerCase()?(e=v.substr(g,10),g+=10):(e=null,0===y&&T('"transport="')),null!==e?("udp"===v.substr(g,3).toLowerCase()?(t=v.substr(g,3),g+=3):(t=null,0===y&&T('"udp"')),null===t&&("tcp"===v.substr(g,3).toLowerCase()?(t=v.substr(g,3),g+=3):(t=null,0===y&&T('"tcp"')),null===t&&("sctp"===v.substr(g,4).toLowerCase()?(t=v.substr(g,4),g+=4):(t=null,0===y&&T('"sctp"')),null===t&&("tls"===v.substr(g,3).toLowerCase()?(t=v.substr(g,3),g+=3):(t=null,0===y&&T('"tls"')),null===t&&(t=O())))),null!==t?e=[e,t]:(e=null,g=r)):(e=null,g=r),null!==e&&(s=e[1],jn.uri_params||(jn.uri_params={}),e=void(jn.uri_params.transport=s.toLowerCase())),null===e&&(g=n),e}function Te(){var e,t,n,r,s;return n=g,r=g,"user="===v.substr(g,5).toLowerCase()?(e=v.substr(g,5),g+=5):(e=null,0===y&&T('"user="')),null!==e?("phone"===v.substr(g,5).toLowerCase()?(t=v.substr(g,5),g+=5):(t=null,0===y&&T('"phone"')),null===t&&("ip"===v.substr(g,2).toLowerCase()?(t=v.substr(g,2),g+=2):(t=null,0===y&&T('"ip"')),null===t&&(t=O())),null!==t?e=[e,t]:(e=null,g=r)):(e=null,g=r),null!==e&&(s=e[1],jn.uri_params||(jn.uri_params={}),e=void(jn.uri_params.user=s.toLowerCase())),null===e&&(g=n),e}function be(){var e,t,n,r,s;return n=g,r=g,"method="===v.substr(g,7).toLowerCase()?(e=v.substr(g,7),g+=7):(e=null,0===y&&T('"method="')),null!==e&&null!==(t=ut())?e=[e,t]:(e=null,g=r),null!==e&&(s=e[1],jn.uri_params||(jn.uri_params={}),e=void(jn.uri_params.method=s)),null===e&&(g=n),e}function Se(){var e,t,n,r,s;return n=g,r=g,"ttl="===v.substr(g,4).toLowerCase()?(e=v.substr(g,4),g+=4):(e=null,0===y&&T('"ttl="')),null!==e&&null!==(t=En())?e=[e,t]:(e=null,g=r),null!==e&&(s=e[1],jn.params||(jn.params={}),e=void(jn.params.ttl=s)),null===e&&(g=n),e}function Ce(){var e,t,n,r,s;return n=g,r=g,"maddr="===v.substr(g,6).toLowerCase()?(e=v.substr(g,6),g+=6):(e=null,0===y&&T('"maddr="')),null!==e&&null!==(t=oe())?e=[e,t]:(e=null,g=r),null!==e&&(s=e[1],jn.uri_params||(jn.uri_params={}),e=void(jn.uri_params.maddr=s)),null===e&&(g=n),e}function Ee(){var e,t,n,r,s,i;return r=g,s=g,"lr"===v.substr(g,2).toLowerCase()?(e=v.substr(g,2),g+=2):(e=null,0===y&&T('"lr"')),null!==e?(i=g,61===v.charCodeAt(g)?(t="=",g++):(t=null,0===y&&T('"="')),null!==t&&null!==(n=O())?t=[t,n]:(t=null,g=i),null!==(t=null!==t?t:"")?e=[e,t]:(e=null,g=s)):(e=null,g=s),null!==e&&(jn.uri_params||(jn.uri_params={}),e=void(jn.uri_params.lr=void 0)),null===e&&(g=r),e}function Ae(){var e,t,n,r,s,i,o,a;return r=g,s=g,null!==(e=we())?(i=g,61===v.charCodeAt(g)?(t="=",g++):(t=null,0===y&&T('"="')),null!==t&&null!==(n=Re())?t=[t,n]:(t=null,g=i),null!==(t=null!==t?t:"")?e=[e,t]:(e=null,g=s)):(e=null,g=s),null!==e&&(o=e[0],a=e[1],jn.uri_params||(jn.uri_params={}),a=void 0===a?void 0:a[1],e=void(jn.uri_params[o.toLowerCase()]=a)),null===e&&(g=r),e}function we(){var e,t,n;if(n=g,null!==(t=Ie()))for(e=[];null!==t;){e.push(t),t=Ie()}else e=null;return null!==e&&(e=e.join("")),null===e&&(g=n),e}function Re(){var e,t,n;if(n=g,null!==(t=Ie()))for(e=[];null!==t;){e.push(t),t=Ie()}else e=null;return null!==e&&(e=e.join("")),null===e&&(g=n),e}function Ie(){var e;return null===(e=ke())&&null===(e=m())&&(e=S()),e}function ke(){var e;return 91===v.charCodeAt(g)?(e="[",g++):(e=null,0===y&&T('"["')),null===e&&(93===v.charCodeAt(g)?(e="]",g++):(e=null,0===y&&T('"]"')),null===e&&(47===v.charCodeAt(g)?(e="/",g++):(e=null,0===y&&T('"/"')),null===e&&(58===v.charCodeAt(g)?(e=":",g++):(e=null,0===y&&T('":"')),null===e&&(38===v.charCodeAt(g)?(e="&",g++):(e=null,0===y&&T('"&"')),null===e&&(43===v.charCodeAt(g)?(e="+",g++):(e=null,0===y&&T('"+"')),null===e&&(36===v.charCodeAt(g)?(e="$",g++):(e=null,0===y&&T('"$"')))))))),e}function Oe(){var e,t,n,r,s,i,o;if(i=g,63===v.charCodeAt(g)?(e="?",g++):(e=null,0===y&&T('"?"')),null!==e){if(null!==(t=xe())){for(n=[],o=g,38===v.charCodeAt(g)?(r="&",g++):(r=null,0===y&&T('"&"')),null!==r&&null!==(s=xe())?r=[r,s]:(r=null,g=o);null!==r;){n.push(r),o=g,38===v.charCodeAt(g)?(r="&",g++):(r=null,0===y&&T('"&"')),null!==r&&null!==(s=xe())?r=[r,s]:(r=null,g=o)}null!==n?e=[e,t,n]:(e=null,g=i)}else e=null,g=i}else e=null,g=i;return e}function xe(){var e,t,n,r,s,i,o;return r=g,s=g,null!==(e=Ne())?(61===v.charCodeAt(g)?(t="=",g++):(t=null,0===y&&T('"="')),null!==t&&null!==(n=Ue())?e=[e,t,n]:(e=null,g=s)):(e=null,g=s),null!==e&&(i=e[0],o=e[2],i=i.join("").toLowerCase(),o=o.join(""),jn.uri_headers||(jn.uri_headers={}),e=void(jn.uri_headers[i]?jn.uri_headers[i].push(o):jn.uri_headers[i]=[o])),null===e&&(g=r),e}function Ne(){var e,t;if(null===(t=Pe())&&null===(t=m())&&(t=S()),null!==t)for(e=[];null!==t;){e.push(t),null===(t=Pe())&&null===(t=m())&&(t=S())}else e=null;return e}function Ue(){var e,t;for(e=[],null===(t=Pe())&&null===(t=m())&&(t=S());null!==t;){e.push(t),null===(t=Pe())&&null===(t=m())&&(t=S())}return e}function Pe(){var e;return 91===v.charCodeAt(g)?(e="[",g++):(e=null,0===y&&T('"["')),null===e&&(93===v.charCodeAt(g)?(e="]",g++):(e=null,0===y&&T('"]"')),null===e&&(47===v.charCodeAt(g)?(e="/",g++):(e=null,0===y&&T('"/"')),null===e&&(63===v.charCodeAt(g)?(e="?",g++):(e=null,0===y&&T('"?"')),null===e&&(58===v.charCodeAt(g)?(e=":",g++):(e=null,0===y&&T('":"')),null===e&&(43===v.charCodeAt(g)?(e="+",g++):(e=null,0===y&&T('"+"')),null===e&&(36===v.charCodeAt(g)?(e="$",g++):(e=null,0===y&&T('"$"')))))))),e}function De(){var e,t,n,r,s,i;return i=g,null!==(e=ut())&&null!==(t=d())&&null!==(n=Me())&&null!==(r=d())&&null!==(s=Ze())?e=[e,t,n,r,s]:(e=null,g=i),e}function Me(){var e;return null===(e=X())&&(e=qe()),e}function qe(){var e,t,n,r;return r=g,null!==(e=ze())?(58===v.charCodeAt(g)?(t=":",g++):(t=null,0===y&&T('":"')),null!==t?(null===(n=Le())&&(n=Fe()),null!==n?e=[e,t,n]:(e=null,g=r)):(e=null,g=r)):(e=null,g=r),e}function Le(){var e,t,n,r,s;return r=g,null===(e=He())&&(e=je()),null!==e?(s=g,63===v.charCodeAt(g)?(t="?",g++):(t=null,0===y&&T('"?"')),null!==t&&null!==(n=Qe())?t=[t,n]:(t=null,g=s),null!==(t=null!==t?t:"")?e=[e,t]:(e=null,g=r)):(e=null,g=r),e}function He(){var e,t,n,r;return r=g,"//"===v.substr(g,2)?(e="//",g+=2):(e=null,0===y&&T('"//"')),null!==e&&null!==(t=Ke())&&null!==(n=null!==(n=je())?n:"")?e=[e,t,n]:(e=null,g=r),e}function je(){var e,t,n;return n=g,47===v.charCodeAt(g)?(e="/",g++):(e=null,0===y&&T('"/"')),null!==e&&null!==(t=We())?e=[e,t]:(e=null,g=n),e}function Fe(){var e,t,n,r;if(r=g,null!==(e=Ge())){for(t=[],n=Be();null!==n;){t.push(n),n=Be()}null!==t?e=[e,t]:(e=null,g=r)}else e=null,g=r;return e}function Be(){var e;return null===(e=_())&&null===(e=m())&&(e=S()),e}function Ge(){var e;return null===(e=m())&&null===(e=S())&&(59===v.charCodeAt(g)?(e=";",g++):(e=null,0===y&&T('";"')),null===e&&(63===v.charCodeAt(g)?(e="?",g++):(e=null,0===y&&T('"?"')),null===e&&(58===v.charCodeAt(g)?(e=":",g++):(e=null,0===y&&T('":"')),null===e&&(64===v.charCodeAt(g)?(e="@",g++):(e=null,0===y&&T('"@"')),null===e&&(38===v.charCodeAt(g)?(e="&",g++):(e=null,0===y&&T('"&"')),null===e&&(61===v.charCodeAt(g)?(e="=",g++):(e=null,0===y&&T('"="')),null===e&&(43===v.charCodeAt(g)?(e="+",g++):(e=null,0===y&&T('"+"')),null===e&&(36===v.charCodeAt(g)?(e="$",g++):(e=null,0===y&&T('"$"')),null===e&&(44===v.charCodeAt(g)?(e=",",g++):(e=null,0===y&&T('","'))))))))))),e}function We(){var e,t,n,r,s,i;if(s=g,null!==(e=Ve())){for(t=[],i=g,47===v.charCodeAt(g)?(n="/",g++):(n=null,0===y&&T('"/"')),null!==n&&null!==(r=Ve())?n=[n,r]:(n=null,g=i);null!==n;){t.push(n),i=g,47===v.charCodeAt(g)?(n="/",g++):(n=null,0===y&&T('"/"')),null!==n&&null!==(r=Ve())?n=[n,r]:(n=null,g=i)}null!==t?e=[e,t]:(e=null,g=s)}else e=null,g=s;return e}function Ve(){var e,t,n,r,s,i;for(s=g,e=[],t=Ye();null!==t;){e.push(t),t=Ye()}if(null!==e){for(t=[],i=g,59===v.charCodeAt(g)?(n=";",g++):(n=null,0===y&&T('";"')),null!==n&&null!==(r=Je())?n=[n,r]:(n=null,g=i);null!==n;){t.push(n),i=g,59===v.charCodeAt(g)?(n=";",g++):(n=null,0===y&&T('";"')),null!==n&&null!==(r=Je())?n=[n,r]:(n=null,g=i)}null!==t?e=[e,t]:(e=null,g=s)}else e=null,g=s;return e}function Je(){var e,t;for(e=[],t=Ye();null!==t;){e.push(t),t=Ye()}return e}function Ye(){var e;return null===(e=m())&&null===(e=S())&&(58===v.charCodeAt(g)?(e=":",g++):(e=null,0===y&&T('":"')),null===e&&(64===v.charCodeAt(g)?(e="@",g++):(e=null,0===y&&T('"@"')),null===e&&(38===v.charCodeAt(g)?(e="&",g++):(e=null,0===y&&T('"&"')),null===e&&(61===v.charCodeAt(g)?(e="=",g++):(e=null,0===y&&T('"="')),null===e&&(43===v.charCodeAt(g)?(e="+",g++):(e=null,0===y&&T('"+"')),null===e&&(36===v.charCodeAt(g)?(e="$",g++):(e=null,0===y&&T('"$"')),null===e&&(44===v.charCodeAt(g)?(e=",",g++):(e=null,0===y&&T('","'))))))))),e}function ze(){var e,t,n,r,s,i;if(r=g,s=g,null!==(e=a())){for(t=[],null===(n=a())&&null===(n=u())&&(43===v.charCodeAt(g)?(n="+",g++):(n=null,0===y&&T('"+"')),null===n&&(45===v.charCodeAt(g)?(n="-",g++):(n=null,0===y&&T('"-"')),null===n&&(46===v.charCodeAt(g)?(n=".",g++):(n=null,0===y&&T('"."')))));null!==n;){t.push(n),null===(n=a())&&null===(n=u())&&(43===v.charCodeAt(g)?(n="+",g++):(n=null,0===y&&T('"+"')),null===n&&(45===v.charCodeAt(g)?(n="-",g++):(n=null,0===y&&T('"-"')),null===n&&(46===v.charCodeAt(g)?(n=".",g++):(n=null,0===y&&T('"."')))))}null!==t?e=[e,t]:(e=null,g=s)}else e=null,g=s;return null!==e&&(i=r,e=void(jn.scheme=v.substring(g,i))),null===e&&(g=r),e}function Ke(){var e;return null===(e=$e())&&(e=Xe()),e}function $e(){var e,t,n,r;return n=g,r=g,null!==(e=te())?(64===v.charCodeAt(g)?(t="@",g++):(t=null,0===y&&T('"@"')),null!==t?e=[e,t]:(e=null,g=r)):(e=null,g=r),null!==(e=null!==e?e:"")&&null!==(t=ie())?e=[e,t]:(e=null,g=n),e=null!==e?e:""}function Xe(){var e,t;if(null===(t=m())&&null===(t=S())&&(36===v.charCodeAt(g)?(t="$",g++):(t=null,0===y&&T('"$"')),null===t&&(44===v.charCodeAt(g)?(t=",",g++):(t=null,0===y&&T('","')),null===t&&(59===v.charCodeAt(g)?(t=";",g++):(t=null,0===y&&T('";"')),null===t&&(58===v.charCodeAt(g)?(t=":",g++):(t=null,0===y&&T('":"')),null===t&&(64===v.charCodeAt(g)?(t="@",g++):(t=null,0===y&&T('"@"')),null===t&&(38===v.charCodeAt(g)?(t="&",g++):(t=null,0===y&&T('"&"')),null===t&&(61===v.charCodeAt(g)?(t="=",g++):(t=null,0===y&&T('"="')),null===t&&(43===v.charCodeAt(g)?(t="+",g++):(t=null,0===y&&T('"+"')))))))))),null!==t)for(e=[];null!==t;){e.push(t),null===(t=m())&&null===(t=S())&&(36===v.charCodeAt(g)?(t="$",g++):(t=null,0===y&&T('"$"')),null===t&&(44===v.charCodeAt(g)?(t=",",g++):(t=null,0===y&&T('","')),null===t&&(59===v.charCodeAt(g)?(t=";",g++):(t=null,0===y&&T('";"')),null===t&&(58===v.charCodeAt(g)?(t=":",g++):(t=null,0===y&&T('":"')),null===t&&(64===v.charCodeAt(g)?(t="@",g++):(t=null,0===y&&T('"@"')),null===t&&(38===v.charCodeAt(g)?(t="&",g++):(t=null,0===y&&T('"&"')),null===t&&(61===v.charCodeAt(g)?(t="=",g++):(t=null,0===y&&T('"="')),null===t&&(43===v.charCodeAt(g)?(t="+",g++):(t=null,0===y&&T('"+"'))))))))))}else e=null;return e}function Qe(){var e,t;for(e=[],t=Be();null!==t;){e.push(t),t=Be()}return e}function Ze(){var e,t,n,r,s,i,o,a,l;if(o=g,a=g,"sip"===v.substr(g,3).toLowerCase()?(e=v.substr(g,3),g+=3):(e=null,0===y&&T('"SIP"')),null!==e){if(47===v.charCodeAt(g)?(t="/",g++):(t=null,0===y&&T('"/"')),null!==t){if(null!==(r=u()))for(n=[];null!==r;){n.push(r),r=u()}else n=null;if(null!==n){if(46===v.charCodeAt(g)?(r=".",g++):(r=null,0===y&&T('"."')),null!==r){if(null!==(i=u()))for(s=[];null!==i;){s.push(i),i=u()}else s=null;null!==s?e=[e,t,n,r,s]:(e=null,g=a)}else e=null,g=a}else e=null,g=a}else e=null,g=a}else e=null,g=a;return null!==e&&(l=o,e=void(jn.sip_version=v.substring(g,l))),null===e&&(g=o),e}function et(){var e;return"INVITE"===v.substr(g,6)?(e="INVITE",g+=6):(e=null,0===y&&T('"INVITE"')),e}function tt(){var e;return"ACK"===v.substr(g,3)?(e="ACK",g+=3):(e=null,0===y&&T('"ACK"')),e}function nt(){var e;return"OPTIONS"===v.substr(g,7)?(e="OPTIONS",g+=7):(e=null,0===y&&T('"OPTIONS"')),e}function rt(){var e;return"BYE"===v.substr(g,3)?(e="BYE",g+=3):(e=null,0===y&&T('"BYE"')),e}function st(){var e;return"CANCEL"===v.substr(g,6)?(e="CANCEL",g+=6):(e=null,0===y&&T('"CANCEL"')),e}function it(){var e;return"REGISTER"===v.substr(g,8)?(e="REGISTER",g+=8):(e=null,0===y&&T('"REGISTER"')),e}function ot(){var e;return"SUBSCRIBE"===v.substr(g,9)?(e="SUBSCRIBE",g+=9):(e=null,0===y&&T('"SUBSCRIBE"')),e}function at(){var e;return"NOTIFY"===v.substr(g,6)?(e="NOTIFY",g+=6):(e=null,0===y&&T('"NOTIFY"')),e}function lt(){var e;return"REFER"===v.substr(g,5)?(e="REFER",g+=5):(e=null,0===y&&T('"REFER"')),e}function ut(){var e,t,n;return t=g,null===(e=et())&&null===(e=tt())&&null===(e=nt())&&null===(e=rt())&&null===(e=st())&&null===(e=it())&&null===(e=ot())&&null===(e=at())&&null===(e=lt())&&(e=O()),null!==e&&(n=t,jn.method=v.substring(g,n),e=jn.method),null===e&&(g=t),e}function ct(){var e,t,n,r,s,i;return i=g,null!==(e=Ze())&&null!==(t=d())&&null!==(n=ft())&&null!==(r=d())&&null!==(s=dt())?e=[e,t,n,r,s]:(e=null,g=i),e}function ft(){var e,t,n;return t=g,null!==(e=ht())&&(n=e,e=void(jn.status_code=parseInt(n.join("")))),null===e&&(g=t),e}function ht(){var e,t,n,r;return r=g,null!==(e=u())&&null!==(t=u())&&null!==(n=u())?e=[e,t,n]:(e=null,g=r),e}function dt(){var e,t,n,r;for(n=g,e=[],null===(t=_())&&null===(t=m())&&null===(t=S())&&null===(t=I())&&null===(t=k())&&null===(t=d())&&(t=p());null!==t;){e.push(t),null===(t=_())&&null===(t=m())&&null===(t=S())&&null===(t=I())&&null===(t=k())&&null===(t=d())&&(t=p())}return null!==e&&(r=n,e=void(jn.reason_phrase=v.substring(g,r))),null===e&&(g=n),e}function pt(){var e,t,n,r,s,i,o;if(s=g,i=g,null===(e=$())&&(e=_t()),null!==e){for(t=[],o=g,null!==(n=F())&&null!==(r=vt())?n=[n,r]:(n=null,g=o);null!==n;){t.push(n),o=g,null!==(n=F())&&null!==(r=vt())?n=[n,r]:(n=null,g=o)}null!==t?e=[e,t]:(e=null,g=i)}else e=null,g=i;return null!==e&&(e=function(e){var t;jn.multi_header||(jn.multi_header=[]);try{t=new Hn(jn.uri,jn.display_name,jn.params),delete jn.uri,delete jn.display_name,delete jn.params}catch(e){t=null}jn.multi_header.push({possition:g,offset:e,parsed:t})}(s)),null===e&&(g=s),e}function _t(){var e,t,n,r,s;return s=g,null!==(e=null!==(e=mt())?e:"")&&null!==(t=H())&&null!==(n=X())&&null!==(r=L())?e=[e,t,n,r]:(e=null,g=s),e}function mt(){var e,t,n,r,s,i,o,a;if(s=g,i=g,null!==(e=O())){for(t=[],o=g,null!==(n=C())&&null!==(r=O())?n=[n,r]:(n=null,g=o);null!==n;){t.push(n),o=g,null!==(n=C())&&null!==(r=O())?n=[n,r]:(n=null,g=o)}null!==t?e=[e,t]:(e=null,g=i)}else e=null,g=i;return null===e&&(e=Y()),null!==e&&(a=e,e=void(jn.display_name="string"==typeof a?a:a[1].reduce(function(e,t){return e+t[0]+t[1]},a[0]))),null===e&&(g=s),e}function vt(){var e;return null===(e=gt())&&null===(e=yt())&&(e=St()),e}function gt(){var e,t,n,r,s,i;return r=g,s=g,"q"===v.substr(g,1).toLowerCase()?(e=v.substr(g,1),g++):(e=null,0===y&&T('"q"')),null!==e&&null!==(t=D())&&null!==(n=bt())?e=[e,t,n]:(e=null,g=s),null!==e&&(i=e[2],jn.params||(jn.params={}),e=void(jn.params.q=i)),null===e&&(g=r),e}function yt(){var e,t,n,r,s,i;return r=g,s=g,"expires"===v.substr(g,7).toLowerCase()?(e=v.substr(g,7),g+=7):(e=null,0===y&&T('"expires"')),null!==e&&null!==(t=D())&&null!==(n=Tt())?e=[e,t,n]:(e=null,g=s),null!==e&&(i=e[2],jn.params||(jn.params={}),e=void(jn.params.expires=i)),null===e&&(g=r),e}function Tt(){var e,t,n;if(n=g,null!==(t=u()))for(e=[];null!==t;){e.push(t),t=u()}else e=null;return null!==e&&(e=parseInt(e.join(""))),null===e&&(g=n),e}function bt(){var e,t,n,r,s,i,o,a,l;return i=g,o=g,48===v.charCodeAt(g)?(e="0",g++):(e=null,0===y&&T('"0"')),null!==e?(a=g,46===v.charCodeAt(g)?(t=".",g++):(t=null,0===y&&T('"."')),null!==t&&null!==(n=null!==(n=u())?n:"")&&null!==(r=null!==(r=u())?r:"")&&null!==(s=null!==(s=u())?s:"")?t=[t,n,r,s]:(t=null,g=a),null!==(t=null!==t?t:"")?e=[e,t]:(e=null,g=o)):(e=null,g=o),null!==e&&(l=i,e=parseFloat(v.substring(g,l))),null===e&&(g=i),e}function St(){var e,t,n,r,s,i,o,a;return r=g,s=g,null!==(e=O())?(i=g,null!==(t=D())&&null!==(n=Ct())?t=[t,n]:(t=null,g=i),null!==(t=null!==t?t:"")?e=[e,t]:(e=null,g=s)):(e=null,g=s),null!==e&&(o=e[0],a=e[1],jn.params||(jn.params={}),a=void 0===a?void 0:a[1],e=void(jn.params[o.toLowerCase()]=a)),null===e&&(g=r),e}function Ct(){var e;return null===(e=O())&&null===(e=oe())&&(e=J()),e}function Et(){var e;return"render"===v.substr(g,6).toLowerCase()?(e=v.substr(g,6),g+=6):(e=null,0===y&&T('"render"')),null===e&&("session"===v.substr(g,7).toLowerCase()?(e=v.substr(g,7),g+=7):(e=null,0===y&&T('"session"')),null===e&&("icon"===v.substr(g,4).toLowerCase()?(e=v.substr(g,4),g+=4):(e=null,0===y&&T('"icon"')),null===e&&("alert"===v.substr(g,5).toLowerCase()?(e=v.substr(g,5),g+=5):(e=null,0===y&&T('"alert"')),null===e&&(e=O())))),e}function At(){var e;return null===(e=wt())&&(e=St()),e}function wt(){var e,t,n,r;return r=g,"handling"===v.substr(g,8).toLowerCase()?(e=v.substr(g,8),g+=8):(e=null,0===y&&T('"handling"')),null!==e&&null!==(t=D())?("optional"===v.substr(g,8).toLowerCase()?(n=v.substr(g,8),g+=8):(n=null,0===y&&T('"optional"')),null===n&&("required"===v.substr(g,8).toLowerCase()?(n=v.substr(g,8),g+=8):(n=null,0===y&&T('"required"')),null===n&&(n=O())),null!==n?e=[e,t,n]:(e=null,g=r)):(e=null,g=r),e}function Rt(){var e,t,n,r,s,i,o,a;if(o=g,null!==(e=It())){if(null!==(t=P())){if(null!==(n=Ut())){for(r=[],a=g,null!==(s=F())&&null!==(i=Pt())?s=[s,i]:(s=null,g=a);null!==s;){r.push(s),a=g,null!==(s=F())&&null!==(i=Pt())?s=[s,i]:(s=null,g=a)}null!==r?e=[e,t,n,r]:(e=null,g=o)}else e=null,g=o}else e=null,g=o}else e=null,g=o;return e}function It(){var e;return null===(e=kt())&&(e=Ot()),e}function kt(){var e;return"text"===v.substr(g,4).toLowerCase()?(e=v.substr(g,4),g+=4):(e=null,0===y&&T('"text"')),null===e&&("image"===v.substr(g,5).toLowerCase()?(e=v.substr(g,5),g+=5):(e=null,0===y&&T('"image"')),null===e&&("audio"===v.substr(g,5).toLowerCase()?(e=v.substr(g,5),g+=5):(e=null,0===y&&T('"audio"')),null===e&&("video"===v.substr(g,5).toLowerCase()?(e=v.substr(g,5),g+=5):(e=null,0===y&&T('"video"')),null===e&&("application"===v.substr(g,11).toLowerCase()?(e=v.substr(g,11),g+=11):(e=null,0===y&&T('"application"')),null===e&&(e=xt()))))),e}function Ot(){var e;return"message"===v.substr(g,7).toLowerCase()?(e=v.substr(g,7),g+=7):(e=null,0===y&&T('"message"')),null===e&&("multipart"===v.substr(g,9).toLowerCase()?(e=v.substr(g,9),g+=9):(e=null,0===y&&T('"multipart"')),null===e&&(e=xt())),e}function xt(){var e;return null===(e=O())&&(e=Nt()),e}function Nt(){var e,t,n;return n=g,"x-"===v.substr(g,2).toLowerCase()?(e=v.substr(g,2),g+=2):(e=null,0===y&&T('"x-"')),null!==e&&null!==(t=O())?e=[e,t]:(e=null,g=n),e}function Ut(){var e;return null===(e=xt())&&(e=O()),e}function Pt(){var e,t,n,r;return r=g,null!==(e=O())&&null!==(t=D())&&null!==(n=Dt())?e=[e,t,n]:(e=null,g=r),e}function Dt(){var e;return null===(e=O())&&(e=J()),e}function Mt(){var e,t,n,r;if(n=g,null!==(t=u()))for(e=[];null!==t;){e.push(t),t=u()}else e=null;return null!==e&&(r=e,e=void(jn.value=parseInt(r.join("")))),null===e&&(g=n),e}function qt(){var e,t,n,r,s,i;if(s=g,null!==(e=x())){for(t=[],i=g,46===v.charCodeAt(g)?(n=".",g++):(n=null,0===y&&T('"."')),null!==n&&null!==(r=x())?n=[n,r]:(n=null,g=i);null!==n;){t.push(n),i=g,46===v.charCodeAt(g)?(n=".",g++):(n=null,0===y&&T('"."')),null!==n&&null!==(r=x())?n=[n,r]:(n=null,g=i)}null!==t?e=[e,t]:(e=null,g=s)}else e=null,g=s;return e}function Lt(){var e;return null===(e=Ht())&&(e=St()),e}function Ht(){var e,t,n,r,s,i;return r=g,s=g,"tag"===v.substr(g,3).toLowerCase()?(e=v.substr(g,3),g+=3):(e=null,0===y&&T('"tag"')),null!==e&&null!==(t=D())&&null!==(n=O())?e=[e,t,n]:(e=null,g=s),null!==e&&(i=e[2],e=void(jn.tag=i)),null===e&&(g=r),e}function jt(){var e,t,n,r,s,i,o,a;if(o=g,"digest"===v.substr(g,6).toLowerCase()?(e=v.substr(g,6),g+=6):(e=null,0===y&&T('"Digest"')),null!==e){if(null!==(t=C())){if(null!==(n=Gt())){for(r=[],a=g,null!==(s=j())&&null!==(i=Gt())?s=[s,i]:(s=null,g=a);null!==s;){r.push(s),a=g,null!==(s=j())&&null!==(i=Gt())?s=[s,i]:(s=null,g=a)}null!==r?e=[e,t,n,r]:(e=null,g=o)}else e=null,g=o}else e=null,g=o}else e=null,g=o;return null===e&&(e=Ft()),e}function Ft(){var e,t,n,r,s,i,o,a;if(o=g,null!==(e=O())){if(null!==(t=C())){if(null!==(n=Bt())){for(r=[],a=g,null!==(s=j())&&null!==(i=Bt())?s=[s,i]:(s=null,g=a);null!==s;){r.push(s),a=g,null!==(s=j())&&null!==(i=Bt())?s=[s,i]:(s=null,g=a)}null!==r?e=[e,t,n,r]:(e=null,g=o)}else e=null,g=o}else e=null,g=o}else e=null,g=o;return e}function Bt(){var e,t,n,r;return r=g,null!==(e=O())&&null!==(t=D())?(null===(n=O())&&(n=J()),null!==n?e=[e,t,n]:(e=null,g=r)):(e=null,g=r),e}function Gt(){var e;return null===(e=Wt())&&null===(e=Jt())&&null===(e=zt())&&null===(e=$t())&&null===(e=Xt())&&null===(e=Qt())&&null===(e=Zt())&&(e=Bt()),e}function Wt(){var e,t,n,r;return r=g,"realm"===v.substr(g,5).toLowerCase()?(e=v.substr(g,5),g+=5):(e=null,0===y&&T('"realm"')),null!==e&&null!==(t=D())&&null!==(n=Vt())?e=[e,t,n]:(e=null,g=r),e}function Vt(){var e,t,n;return t=g,null!==(e=Y())&&(n=e,e=void(jn.realm=n)),null===e&&(g=t),e}function Jt(){var e,t,n,r,s,i,o,a,l;if(a=g,"domain"===v.substr(g,6).toLowerCase()?(e=v.substr(g,6),g+=6):(e=null,0===y&&T('"domain"')),null!==e){if(null!==(t=D())){if(null!==(n=G())){if(null!==(r=Yt())){if(s=[],l=g,null!==(o=d()))for(i=[];null!==o;){i.push(o),o=d()}else i=null;for(null!==i&&null!==(o=Yt())?i=[i,o]:(i=null,g=l);null!==i;){if(s.push(i),l=g,null!==(o=d()))for(i=[];null!==o;){i.push(o),o=d()}else i=null;null!==i&&null!==(o=Yt())?i=[i,o]:(i=null,g=l)}null!==s&&null!==(i=W())?e=[e,t,n,r,s,i]:(e=null,g=a)}else e=null,g=a}else e=null,g=a}else e=null,g=a}else e=null,g=a;return e}function Yt(){var e;return null===(e=qe())&&(e=je()),e}function zt(){var e,t,n,r;return r=g,"nonce"===v.substr(g,5).toLowerCase()?(e=v.substr(g,5),g+=5):(e=null,0===y&&T('"nonce"')),null!==e&&null!==(t=D())&&null!==(n=Kt())?e=[e,t,n]:(e=null,g=r),e}function Kt(){var e,t,n;return t=g,null!==(e=Y())&&(n=e,e=void(jn.nonce=n)),null===e&&(g=t),e}function $t(){var e,t,n,r,s,i;return r=g,s=g,"opaque"===v.substr(g,6).toLowerCase()?(e=v.substr(g,6),g+=6):(e=null,0===y&&T('"opaque"')),null!==e&&null!==(t=D())&&null!==(n=Y())?e=[e,t,n]:(e=null,g=s),null!==e&&(i=e[2],e=void(jn.opaque=i)),null===e&&(g=r),e}function Xt(){var e,t,n,r,s;return r=g,"stale"===v.substr(g,5).toLowerCase()?(e=v.substr(g,5),g+=5):(e=null,0===y&&T('"stale"')),null!==e&&null!==(t=D())?(s=g,"true"===v.substr(g,4).toLowerCase()?(n=v.substr(g,4),g+=4):(n=null,0===y&&T('"true"')),null!==n&&(n=void(jn.stale=!0)),null===n&&(g=s),null===n&&(s=g,"false"===v.substr(g,5).toLowerCase()?(n=v.substr(g,5),g+=5):(n=null,0===y&&T('"false"')),null!==n&&(n=void(jn.stale=!1)),null===n&&(g=s)),null!==n?e=[e,t,n]:(e=null,g=r)):(e=null,g=r),e}function Qt(){var e,t,n,r,s,i;return r=g,s=g,"algorithm"===v.substr(g,9).toLowerCase()?(e=v.substr(g,9),g+=9):(e=null,0===y&&T('"algorithm"')),null!==e&&null!==(t=D())?("md5"===v.substr(g,3).toLowerCase()?(n=v.substr(g,3),g+=3):(n=null,0===y&&T('"MD5"')),null===n&&("md5-sess"===v.substr(g,8).toLowerCase()?(n=v.substr(g,8),g+=8):(n=null,0===y&&T('"MD5-sess"')),null===n&&(n=O())),null!==n?e=[e,t,n]:(e=null,g=s)):(e=null,g=s),null!==e&&(i=e[2],e=void(jn.algorithm=i.toUpperCase())),null===e&&(g=r),e}function Zt(){var e,t,n,r,s,i,o,a,l,u;if(a=g,"qop"===v.substr(g,3).toLowerCase()?(e=v.substr(g,3),g+=3):(e=null,0===y&&T('"qop"')),null!==e){if(null!==(t=D())){if(null!==(n=G())){if(l=g,null!==(r=en())){for(s=[],u=g,44===v.charCodeAt(g)?(i=",",g++):(i=null,0===y&&T('","')),null!==i&&null!==(o=en())?i=[i,o]:(i=null,g=u);null!==i;){s.push(i),u=g,44===v.charCodeAt(g)?(i=",",g++):(i=null,0===y&&T('","')),null!==i&&null!==(o=en())?i=[i,o]:(i=null,g=u)}null!==s?r=[r,s]:(r=null,g=l)}else r=null,g=l;null!==r&&null!==(s=W())?e=[e,t,n,r,s]:(e=null,g=a)}else e=null,g=a}else e=null,g=a}else e=null,g=a;return e}function en(){var e,t,n;return t=g,"auth-int"===v.substr(g,8).toLowerCase()?(e=v.substr(g,8),g+=8):(e=null,0===y&&T('"auth-int"')),null===e&&("auth"===v.substr(g,4).toLowerCase()?(e=v.substr(g,4),g+=4):(e=null,0===y&&T('"auth"')),null===e&&(e=O())),null!==e&&(n=e,jn.qop||(jn.qop=[]),e=void jn.qop.push(n.toLowerCase())),null===e&&(g=t),e}function tn(){var e,t,n,r,s,i,o;if(s=g,i=g,null!==(e=_t())){for(t=[],o=g,null!==(n=F())&&null!==(r=St())?n=[n,r]:(n=null,g=o);null!==n;){t.push(n),o=g,null!==(n=F())&&null!==(r=St())?n=[n,r]:(n=null,g=o)}null!==t?e=[e,t]:(e=null,g=i)}else e=null,g=i;return null!==e&&(e=function(e){var t;jn.multi_header||(jn.multi_header=[]);try{t=new Hn(jn.uri,jn.display_name,jn.params),delete jn.uri,delete jn.display_name,delete jn.params}catch(e){t=null}jn.multi_header.push({possition:g,offset:e,parsed:t})}(s)),null===e&&(g=s),e}function nn(){var e;return null===(e=rn())&&(e=St()),e}function rn(){var e,t,n,r,s,i,o;if(s=g,i=g,"cause"===v.substr(g,5).toLowerCase()?(e=v.substr(g,5),g+=5):(e=null,0===y&&T('"cause"')),null!==e){if(null!==(t=D())){if(null!==(r=u()))for(n=[];null!==r;){n.push(r),r=u()}else n=null;null!==n?e=[e,t,n]:(e=null,g=i)}else e=null,g=i}else e=null,g=i;return null!==e&&(o=e[2],e=void(jn.cause=parseInt(o.join("")))),null===e&&(g=s),e}function sn(){var e,t,n,r,s,i;if(s=g,null!==(e=_t())){for(t=[],i=g,null!==(n=F())&&null!==(r=St())?n=[n,r]:(n=null,g=i);null!==n;){t.push(n),i=g,null!==(n=F())&&null!==(r=St())?n=[n,r]:(n=null,g=i)}null!==t?e=[e,t]:(e=null,g=s)}else e=null,g=s;return e}function on(){var e,t,n;return t=g,"active"===v.substr(g,6).toLowerCase()?(e=v.substr(g,6),g+=6):(e=null,0===y&&T('"active"')),null===e&&("pending"===v.substr(g,7).toLowerCase()?(e=v.substr(g,7),g+=7):(e=null,0===y&&T('"pending"')),null===e&&("terminated"===v.substr(g,10).toLowerCase()?(e=v.substr(g,10),g+=10):(e=null,0===y&&T('"terminated"')),null===e&&(e=O()))),null!==e&&(n=t,e=void(jn.state=v.substring(g,n))),null===e&&(g=t),e}function an(){var e,t,n,r,s,i,o,a;return r=g,s=g,"reason"===v.substr(g,6).toLowerCase()?(e=v.substr(g,6),g+=6):(e=null,0===y&&T('"reason"')),null!==e&&null!==(t=D())&&null!==(n=ln())?e=[e,t,n]:(e=null,g=s),null!==e&&(e=void(void 0!==(i=e[2])&&(jn.reason=i))),null===e&&(g=r),null===e&&(r=g,s=g,"expires"===v.substr(g,7).toLowerCase()?(e=v.substr(g,7),g+=7):(e=null,0===y&&T('"expires"')),null!==e&&null!==(t=D())&&null!==(n=Tt())?e=[e,t,n]:(e=null,g=s),null!==e&&(e=void(void 0!==(a=e[2])&&(jn.expires=a))),null===e&&(g=r),null===e&&(r=g,s=g,"retry_after"===v.substr(g,11).toLowerCase()?(e=v.substr(g,11),g+=11):(e=null,0===y&&T('"retry_after"')),null!==e&&null!==(t=D())&&null!==(n=Tt())?e=[e,t,n]:(e=null,g=s),null!==e&&(e=void(void 0!==(o=e[2])&&(jn.retry_after=o))),null===e&&(g=r),null===e&&(e=St()))),e}function ln(){var e;return"deactivated"===v.substr(g,11).toLowerCase()?(e=v.substr(g,11),g+=11):(e=null,0===y&&T('"deactivated"')),null===e&&("probation"===v.substr(g,9).toLowerCase()?(e=v.substr(g,9),g+=9):(e=null,0===y&&T('"probation"')),null===e&&("rejected"===v.substr(g,8).toLowerCase()?(e=v.substr(g,8),g+=8):(e=null,0===y&&T('"rejected"')),null===e&&("timeout"===v.substr(g,7).toLowerCase()?(e=v.substr(g,7),g+=7):(e=null,0===y&&T('"timeout"')),null===e&&("giveup"===v.substr(g,6).toLowerCase()?(e=v.substr(g,6),g+=6):(e=null,0===y&&T('"giveup"')),null===e&&("noresource"===v.substr(g,10).toLowerCase()?(e=v.substr(g,10),g+=10):(e=null,0===y&&T('"noresource"')),null===e&&("invariant"===v.substr(g,9).toLowerCase()?(e=v.substr(g,9),g+=9):(e=null,0===y&&T('"invariant"')),null===e&&(e=O()))))))),e}function un(){var e;return null===(e=Ht())&&(e=St()),e}function cn(){var e,t,n,r,s,i,o,a;if(o=g,null!==(e=gn())){if(null!==(t=C())){if(null!==(n=bn())){for(r=[],a=g,null!==(s=F())&&null!==(i=fn())?s=[s,i]:(s=null,g=a);null!==s;){r.push(s),a=g,null!==(s=F())&&null!==(i=fn())?s=[s,i]:(s=null,g=a)}null!==r?e=[e,t,n,r]:(e=null,g=o)}else e=null,g=o}else e=null,g=o}else e=null,g=o;return e}function fn(){var e;return null===(e=hn())&&null===(e=dn())&&null===(e=pn())&&null===(e=_n())&&null===(e=mn())&&(e=St()),e}function hn(){var e,t,n,r,s,i;return r=g,s=g,"ttl"===v.substr(g,3).toLowerCase()?(e=v.substr(g,3),g+=3):(e=null,0===y&&T('"ttl"')),null!==e&&null!==(t=D())&&null!==(n=En())?e=[e,t,n]:(e=null,g=s),null!==e&&(i=e[2],e=void(jn.ttl=i)),null===e&&(g=r),e}function dn(){var e,t,n,r,s,i;return r=g,s=g,"maddr"===v.substr(g,5).toLowerCase()?(e=v.substr(g,5),g+=5):(e=null,0===y&&T('"maddr"')),null!==e&&null!==(t=D())&&null!==(n=oe())?e=[e,t,n]:(e=null,g=s),null!==e&&(i=e[2],e=void(jn.maddr=i)),null===e&&(g=r),e}function pn(){var e,t,n,r,s,i;return r=g,s=g,"received"===v.substr(g,8).toLowerCase()?(e=v.substr(g,8),g+=8):(e=null,0===y&&T('"received"')),null!==e&&null!==(t=D())?(null===(n=pe())&&(n=fe()),null!==n?e=[e,t,n]:(e=null,g=s)):(e=null,g=s),null!==e&&(i=e[2],e=void(jn.received=i)),null===e&&(g=r),e}function _n(){var e,t,n,r,s,i;return r=g,s=g,"branch"===v.substr(g,6).toLowerCase()?(e=v.substr(g,6),g+=6):(e=null,0===y&&T('"branch"')),null!==e&&null!==(t=D())&&null!==(n=O())?e=[e,t,n]:(e=null,g=s),null!==e&&(i=e[2],e=void(jn.branch=i)),null===e&&(g=r),e}function mn(){var e,t,n,r,s;return r=g,"rport"===v.substr(g,5).toLowerCase()?(e=v.substr(g,5),g+=5):(e=null,0===y&&T('"rport"')),null!==e?(s=g,null!==(t=D())&&null!==(n=vn())?t=[t,n]:(t=null,g=s),null!==(t=null!==t?t:"")?e=[e,t]:(e=null,g=r)):(e=null,g=r),e}function vn(){var e,t,n,r,s,i,o,a;return i=g,o=g,null!==(e=null!==(e=u())?e:"")&&null!==(t=null!==(t=u())?t:"")&&null!==(n=null!==(n=u())?n:"")&&null!==(r=null!==(r=u())?r:"")&&null!==(s=null!==(s=u())?s:"")?e=[e,t,n,r,s]:(e=null,g=o),null!==e&&(a=e,e=void(jn.rport=parseInt(a.join("")))),null===e&&(g=i),e}function gn(){var e,t,n,r,s,i;return i=g,null!==(e=yn())&&null!==(t=P())&&null!==(n=O())&&null!==(r=P())&&null!==(s=Tn())?e=[e,t,n,r,s]:(e=null,g=i),e}function yn(){var e,t,n;return t=g,"sip"===v.substr(g,3).toLowerCase()?(e=v.substr(g,3),g+=3):(e=null,0===y&&T('"SIP"')),null===e&&(e=O()),null!==e&&(n=e,e=void(jn.protocol=n)),null===e&&(g=t),e}function Tn(){var e,t,n;return t=g,"udp"===v.substr(g,3).toLowerCase()?(e=v.substr(g,3),g+=3):(e=null,0===y&&T('"UDP"')),null===e&&("tcp"===v.substr(g,3).toLowerCase()?(e=v.substr(g,3),g+=3):(e=null,0===y&&T('"TCP"')),null===e&&("tls"===v.substr(g,3).toLowerCase()?(e=v.substr(g,3),g+=3):(e=null,0===y&&T('"TLS"')),null===e&&("sctp"===v.substr(g,4).toLowerCase()?(e=v.substr(g,4),g+=4):(e=null,0===y&&T('"SCTP"')),null===e&&(e=O())))),null!==e&&(n=e,e=void(jn.transport=n)),null===e&&(g=t),e}function bn(){var e,t,n,r,s;return r=g,null!==(e=Sn())?(s=g,null!==(t=B())&&null!==(n=Cn())?t=[t,n]:(t=null,g=s),null!==(t=null!==t?t:"")?e=[e,t]:(e=null,g=r)):(e=null,g=r),e}function Sn(){var e,t,n;return t=g,null===(e=pe())&&null===(e=ce())&&(e=ae()),null!==e&&(n=t,e=void(jn.host=v.substring(g,n))),null===e&&(g=t),e}function Cn(){var e,t,n,r,s,i,o,a;return i=g,o=g,null!==(e=null!==(e=u())?e:"")&&null!==(t=null!==(t=u())?t:"")&&null!==(n=null!==(n=u())?n:"")&&null!==(r=null!==(r=u())?r:"")&&null!==(s=null!==(s=u())?s:"")?e=[e,t,n,r,s]:(e=null,g=o),null!==e&&(a=e,e=void(jn.port=parseInt(a.join("")))),null===e&&(g=i),e}function En(){var e,t,n,r,s;return r=g,s=g,null!==(e=u())&&null!==(t=null!==(t=u())?t:"")&&null!==(n=null!==(n=u())?n:"")?e=[e,t,n]:(e=null,g=s),null!==e&&(e=parseInt(e.join(""))),null===e&&(g=r),e}function An(){var e,t,n;return t=g,null!==(e=Tt())&&(n=e,e=void(jn.expires=n)),null===e&&(g=t),e}function wn(){var e;return null===(e=Rn())&&(e=St()),e}function Rn(){var e,t,n,r,s,i;return r=g,s=g,"refresher"===v.substr(g,9).toLowerCase()?(e=v.substr(g,9),g+=9):(e=null,0===y&&T('"refresher"')),null!==e&&null!==(t=D())?("uac"===v.substr(g,3).toLowerCase()?(n=v.substr(g,3),g+=3):(n=null,0===y&&T('"uac"')),null===n&&("uas"===v.substr(g,3).toLowerCase()?(n=v.substr(g,3),g+=3):(n=null,0===y&&T('"uas"'))),null!==n?e=[e,t,n]:(e=null,g=s)):(e=null,g=s),null!==e&&(i=e[2],e=void(jn.refresher=i.toLowerCase())),null===e&&(g=r),e}function In(){var e,t;for(e=[],null===(t=R())&&null===(t=k())&&(t=C());null!==t;){e.push(t),null===(t=R())&&null===(t=k())&&(t=C())}return e}function kn(){var e,t,n,r,s,i,o,a,l,u,c,f;return u=g,c=g,null!==(e=xn())?(45===v.charCodeAt(g)?(t="-",g++):(t=null,0===y&&T('"-"')),null!==t&&null!==(n=On())?(45===v.charCodeAt(g)?(r="-",g++):(r=null,0===y&&T('"-"')),null!==r&&null!==(s=On())?(45===v.charCodeAt(g)?(i="-",g++):(i=null,0===y&&T('"-"')),null!==i&&null!==(o=On())?(45===v.charCodeAt(g)?(a="-",g++):(a=null,0===y&&T('"-"')),null!==a&&null!==(l=Nn())?e=[e,t,n,r,s,i,o,a,l]:(e=null,g=c)):(e=null,g=c)):(e=null,g=c)):(e=null,g=c)):(e=null,g=c),null!==e&&(f=u,e[0],e=void(jn=v.substring(g+5,f))),null===e&&(g=u),e}function On(){var e,t,n,r,s;return s=g,null!==(e=c())&&null!==(t=c())&&null!==(n=c())&&null!==(r=c())?e=[e,t,n,r]:(e=null,g=s),e}function xn(){var e,t,n;return n=g,null!==(e=On())&&null!==(t=On())?e=[e,t]:(e=null,g=n),e}function Nn(){var e,t,n,r;return r=g,null!==(e=On())&&null!==(t=On())&&null!==(n=On())?e=[e,t,n]:(e=null,g=r),e}function Un(){var e,t,n,r,s,i,o;return r=g,s=g,null!==(e=N())?(i=g,64===v.charCodeAt(g)?(t="@",g++):(t=null,0===y&&T('"@"')),null!==t&&null!==(n=N())?t=[t,n]:(t=null,g=i),null!==(t=null!==t?t:"")?e=[e,t]:(e=null,g=s)):(e=null,g=s),null!==e&&(o=r,e=void(jn.call_id=v.substring(g,o))),null===e&&(g=r),e}function Pn(){var e;return null===(e=Dn())&&null===(e=Mn())&&null===(e=qn())&&(e=St()),e}function Dn(){var e,t,n,r,s,i;return r=g,s=g,"to-tag"===v.substr(g,6)?(e="to-tag",g+=6):(e=null,0===y&&T('"to-tag"')),null!==e&&null!==(t=D())&&null!==(n=O())?e=[e,t,n]:(e=null,g=s),null!==e&&(i=e[2],e=void(jn.to_tag=i)),null===e&&(g=r),e}function Mn(){var e,t,n,r,s,i;return r=g,s=g,"from-tag"===v.substr(g,8)?(e="from-tag",g+=8):(e=null,0===y&&T('"from-tag"')),null!==e&&null!==(t=D())&&null!==(n=O())?e=[e,t,n]:(e=null,g=s),null!==e&&(i=e[2],e=void(jn.from_tag=i)),null===e&&(g=r),e}function qn(){var e,t;return t=g,"early-only"===v.substr(g,10)?(e="early-only",g+=10):(e=null,0===y&&T('"early-only"')),null!==e&&(e=void(jn.early_only=!0)),null===e&&(g=t),e}var Ln=Vn("./URI"),Hn=Vn("./NameAddrHeader"),jn={};if(null===t[l]()||g!==v.length){var Fn=Math.max(g,i),Bn=Fn<v.length?v.charAt(Fn):null,Gn=function(){for(var e=1,t=1,n=!1,r=0;r<Math.max(g,i);r++){var s=v.charAt(r);"\n"===s?(n||e++,t=1,n=!1):"\r"===s||"\u2028"===s||"\u2029"===s?(e++,t=1,n=!0):(t++,n=!1)}return{line:e,column:t}}();return new this.SyntaxError(function(e){e.sort();for(var t=null,n=[],r=0;r<e.length;r++){e[r]!==t&&(n.push(e[r]),t=e[r])}return n}(n),Bn,Fn,Gn.line,Gn.column),-1}return jn},toSource:function e(){return this._source},SyntaxError:function e(t,n,r,s,i){this.name="SyntaxError",this.expected=t,this.found=n,this.message=function(e,t){var n;switch(e.length){case 0:n="end of input";break;case 1:n=e[0];break;default:n=e.slice(0,e.length-1).join(", ")+" or "+e[e.length-1]}return"Expected "+n+" but "+(t?Wn(t):"end of input")+" found."}(t,n),this.offset=r,this.line=s,this.column=i}};return e.SyntaxError.prototype=Error.prototype,e}()},{"./NameAddrHeader":10,"./URI":25}],8:[function(e,t,n){"use strict";var r=e("../package.json"),s=e("./Constants"),i=e("./Exceptions"),o=e("./Utils"),a=e("./UA"),l=e("./URI"),u=e("./NameAddrHeader"),c=e("./Grammar"),f=e("./WebSocketInterface");e("debug")("JsSIP")("version %s",r.version),t.exports={C:s,Exceptions:i,Utils:o,UA:a,URI:l,NameAddrHeader:u,WebSocketInterface:f,Grammar:c,debug:e("debug"),get name(){return r.title},get version(){return r.version}}},{"../package.json":38,"./Constants":2,"./Exceptions":6,"./Grammar":7,"./NameAddrHeader":10,"./UA":24,"./URI":25,"./Utils":26,"./WebSocketInterface":27,debug:30}],9:[function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==N(Symbol.iterator)?function(e){return N(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":N(e)})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=u(r);if(s){var n=u(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var c=e("events").EventEmitter,f=e("./Constants"),h=e("./SIPMessage"),d=e("./Utils"),p=e("./RequestSender"),_=e("./Exceptions"),m=e("debug")("JsSIP:Message");t.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(i,c);var t,n,r,s=l(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=s.call(this))._ua=e,t._request=null,t._closed=!1,t._direction=null,t._local_identity=null,t._remote_identity=null,t._is_replied=!1,t._data={},t}return t=i,(n=[{key:"send",value:function e(t,n){var r=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=t;if(void 0===t||void 0===n)throw new TypeError("Not enough arguments");if(!(t=this._ua.normalizeTarget(t)))throw new TypeError("Invalid target: ".concat(i));var o=d.cloneArray(s.extraHeaders),a=d.cloneObject(s.eventHandlers),l=s.contentType||"text/plain";for(var u in a){Object.prototype.hasOwnProperty.call(a,u)&&this.on(u,a[u])}o.push("Content-Type: ".concat(l)),this._request=new h.OutgoingRequest(f.MESSAGE,t,this._ua,null,o),n&&(this._request.body=n);var c=new p(this._ua,this._request,{onRequestTimeout:function e(){r._onRequestTimeout()},onTransportError:function e(){r._onTransportError()},onReceiveResponse:function e(t){r._receiveResponse(t)}});this._newMessage("local",this._request),c.send()}},{key:"init_incoming",value:function e(t){this._request=t,this._newMessage("remote",t),this._is_replied||(this._is_replied=!0,t.reply(200)),this._close()}},{key:"accept",value:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=d.cloneArray(t.extraHeaders),r=t.body;if("incoming"!==this._direction)throw new _.NotSupportedError('"accept" not supported for outgoing Message');if(this._is_replied)throw new Error("incoming Message already replied");this._is_replied=!0,this._request.reply(200,null,n,r)}},{key:"reject",value:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.status_code||480,r=t.reason_phrase,s=d.cloneArray(t.extraHeaders),i=t.body;if("incoming"!==this._direction)throw new _.NotSupportedError('"reject" not supported for outgoing Message');if(this._is_replied)throw new Error("incoming Message already replied");if(n<300||n>=700)throw new TypeError("Invalid status_code: ".concat(n));this._is_replied=!0,this._request.reply(n,r,s,i)}},{key:"_receiveResponse",value:function e(t){if(!this._closed)switch(!0){case/^1[0-9]{2}$/.test(t.status_code):break;case/^2[0-9]{2}$/.test(t.status_code):this._succeeded("remote",t);break;default:var n=d.sipErrorCause(t.status_code);this._failed("remote",t,n)}}},{key:"_onRequestTimeout",value:function e(){this._closed||this._failed("system",null,f.causes.REQUEST_TIMEOUT)}},{key:"_onTransportError",value:function e(){this._closed||this._failed("system",null,f.causes.CONNECTION_ERROR)}},{key:"_close",value:function e(){this._closed=!0,this._ua.destroyMessage(this)}},{key:"_newMessage",value:function e(t,n){"remote"===t?(this._direction="incoming",this._local_identity=n.to,this._remote_identity=n.from):"local"===t&&(this._direction="outgoing",this._local_identity=n.from,this._remote_identity=n.to),this._ua.newMessage(this,{originator:t,message:this,request:n})}},{key:"_failed",value:function e(t,n,r){m("MESSAGE failed"),this._close(),m('emit "failed"'),this.emit("failed",{originator:t,response:n||null,cause:r})}},{key:"_succeeded",value:function e(t,n){m("MESSAGE succeeded"),this._close(),m('emit "succeeded"'),this.emit("succeeded",{originator:t,response:n})}},{key:"direction",get:function e(){return this._direction}},{key:"local_identity",get:function e(){return this._local_identity}},{key:"remote_identity",get:function e(){return this._remote_identity}}])&&o(t.prototype,n),r&&o(t,r),i}()},{"./Constants":2,"./Exceptions":6,"./RequestSender":18,"./SIPMessage":19,"./Utils":26,debug:30,events:29}],10:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}var o=e("./URI"),a=e("./Grammar");t.exports=function(){function s(e,t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),!(e&&e instanceof o))throw new TypeError('missing or invalid "uri" parameter');for(var r in this._uri=e,this._parameters={},this.display_name=t,n){Object.prototype.hasOwnProperty.call(n,r)&&this.setParam(r,n[r])}}return i(s,null,[{key:"parse",value:function e(t){return-1!==(t=a.parse(t,"Name_Addr_Header"))?t:void 0}}]),i(s,[{key:"setParam",value:function e(t,n){t&&(this._parameters[t.toLowerCase()]=null==n?null:n.toString())}},{key:"getParam",value:function e(t){if(t)return this._parameters[t.toLowerCase()]}},{key:"hasParam",value:function e(t){if(t)return!!this._parameters.hasOwnProperty(t.toLowerCase())}},{key:"deleteParam",value:function e(t){if(t=t.toLowerCase(),this._parameters.hasOwnProperty(t)){var n=this._parameters[t];return delete this._parameters[t],n}}},{key:"clearParams",value:function e(){this._parameters={}}},{key:"clone",value:function e(){return new s(this._uri.clone(),this._display_name,JSON.parse(JSON.stringify(this._parameters)))}},{key:"_quote",value:function e(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}},{key:"toString",value:function e(){var t=this._display_name?'"'.concat(this._quote(this._display_name),'" '):"";for(var n in t+="<".concat(this._uri.toString(),">"),this._parameters){Object.prototype.hasOwnProperty.call(this._parameters,n)&&(t+=";".concat(n),null!==this._parameters[n]&&(t+="=".concat(this._parameters[n])))}return t}},{key:"uri",get:function e(){return this._uri}},{key:"display_name",get:function e(){return this._display_name},set:function e(t){this._display_name=0===t?"0":t}}]),s}()},{"./Grammar":7,"./URI":25}],11:[function(e,t,n){"use strict";function p(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(t))){var n=0,e=function e(){};return{s:e,n:function e(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function e(t){throw t},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s,i=!0,o=!1;return{s:function e(){r=t[Symbol.iterator]()},n:function e(){var t=r.next();return i=t.done,t},e:function e(t){o=!0,s=t},f:function e(){try{i||null==r["return"]||r["return"]()}finally{if(o)throw s}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++){r[n]=e[n]}return r}var _=e("./Grammar"),m=e("./SIPMessage"),u=e("debug")("JsSIP:ERROR:Parser");function c(e,t){var n=t,r=0,s=0;if(e.substring(n,n+2).match(/(^\r\n)/))return-2;for(;0===r;){if(-1===(s=e.indexOf("\r\n",n)))return s;!e.substring(s+2,s+4).match(/(^\r\n)/)&&e.charAt(s+2).match(/(^\s+)/)?n=s+2:r=s}return r}function f(e,t,n,r){var s,i=t.indexOf(":",n),o=t.substring(n,i).trim(),a=t.substring(i+1,r).trim();switch(o.toLowerCase()){case"via":case"v":e.addHeader("via",a),1===e.getHeaders("via").length?(s=e.parseHeader("Via"))&&(e.via=s,e.via_branch=s.branch):s=0;break;case"from":case"f":e.setHeader("from",a),(s=e.parseHeader("from"))&&(e.from=s,e.from_tag=s.getParam("tag"));break;case"to":case"t":e.setHeader("to",a),(s=e.parseHeader("to"))&&(e.to=s,e.to_tag=s.getParam("tag"));break;case"record-route":if(-1===(s=_.parse(a,"Record_Route")))s=void 0;else{var l,u=p(s);try{for(u.s();!(l=u.n()).done;){var c=l.value;e.addHeader("record-route",a.substring(c.possition,c.offset)),e.headers["Record-Route"][e.getHeaders("record-route").length-1].parsed=c.parsed}}catch(e){u.e(e)}finally{u.f()}}break;case"call-id":case"i":e.setHeader("call-id",a),(s=e.parseHeader("call-id"))&&(e.call_id=a);break;case"contact":case"m":if(-1===(s=_.parse(a,"Contact")))s=void 0;else{var f,h=p(s);try{for(h.s();!(f=h.n()).done;){var d=f.value;e.addHeader("contact",a.substring(d.possition,d.offset)),e.headers.Contact[e.getHeaders("contact").length-1].parsed=d.parsed}}catch(e){h.e(e)}finally{h.f()}}break;case"content-length":case"l":e.setHeader("content-length",a),s=e.parseHeader("content-length");break;case"content-type":case"c":e.setHeader("content-type",a),s=e.parseHeader("content-type");break;case"cseq":e.setHeader("cseq",a),(s=e.parseHeader("cseq"))&&(e.cseq=s.value),e instanceof m.IncomingResponse&&(e.method=s.method);break;case"max-forwards":e.setHeader("max-forwards",a),s=e.parseHeader("max-forwards");break;case"www-authenticate":e.setHeader("www-authenticate",a),s=e.parseHeader("www-authenticate");break;case"proxy-authenticate":e.setHeader("proxy-authenticate",a),s=e.parseHeader("proxy-authenticate");break;case"session-expires":case"x":e.setHeader("session-expires",a),(s=e.parseHeader("session-expires"))&&(e.session_expires=s.expires,e.session_expires_refresher=s.refresher);break;case"refer-to":case"r":e.setHeader("refer-to",a),(s=e.parseHeader("refer-to"))&&(e.refer_to=s);break;case"replaces":e.setHeader("replaces",a),(s=e.parseHeader("replaces"))&&(e.replaces=s);break;case"event":case"o":e.setHeader("event",a),(s=e.parseHeader("event"))&&(e.event=s);break;default:e.addHeader(o,a),s=0}return void 0!==s||{error:'error parsing header "'.concat(o,'"')}}u.log=console.warn.bind(console),n.parseMessage=function(e,t){var n,r,s=e.indexOf("\r\n");if(-1!==s){var i=e.substring(0,s),o=_.parse(i,"Request_Response");if(-1!==o){o.status_code?((n=new m.IncomingResponse).status_code=o.status_code,n.reason_phrase=o.reason_phrase):((n=new m.IncomingRequest(t)).method=o.method,n.ruri=o.uri),n.data=e;for(var a=s+2;;){if(-2===(s=c(e,a))){r=a+2;break}if(-1===s)return void u("parseMessage() | malformed message");if(!0!==(o=f(n,e,a,s)))return void u("parseMessage() |",o.error);a=s+2}if(n.hasHeader("content-length")){var l=n.getHeader("content-length");n.body=e.substr(r,l)}else n.body=e.substring(r);return n}u('parseMessage() | error parsing first line of SIP message: "'.concat(i,'"'))}else u("parseMessage() | no CRLF found, not a SIP message")}},{"./Grammar":7,"./SIPMessage":19,debug:30}],12:[function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==N(Symbol.iterator)?function(e){return N(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":N(e)})(e)}function A(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(t))){var n=0,e=function e(){};return{s:e,n:function e(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function e(t){throw t},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s,i=!0,o=!1;return{s:function e(){r=t[Symbol.iterator]()},n:function e(){var t=r.next();return i=t.done,t},e:function e(t){o=!0,s=t},f:function e(){try{i||null==r["return"]||r["return"]()}finally{if(o)throw s}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++){r[n]=e[n]}return r}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r);if(s){var n=o(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var c=e("events").EventEmitter,f=e("sdp-transform"),w=e("./Constants"),R=e("./Exceptions"),h=e("./Transactions"),I=e("./Utils"),d=e("./Timers"),_=e("./SIPMessage"),p=e("./Dialog"),m=e("./RequestSender"),v=e("./RTCSession/DTMF"),g=e("./RTCSession/Info"),y=e("./RTCSession/ReferNotifier"),T=e("./RTCSession/ReferSubscriber"),b=e("./URI"),k=e("debug")("JsSIP:RTCSession"),O=e("debug")("JsSIP:ERROR:RTCSession");O.log=console.warn.bind(console);var x={STATUS_NULL:0,STATUS_INVITE_SENT:1,STATUS_1XX_RECEIVED:2,STATUS_INVITE_RECEIVED:3,STATUS_WAITING_FOR_ANSWER:4,STATUS_ANSWERED:5,STATUS_WAITING_FOR_ACK:6,STATUS_CANCELED:7,STATUS_TERMINATED:8,STATUS_CONFIRMED:9},S=["audio","video"];t.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(o,c);var n=u(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),k("new"),(t=n.call(this))._id=null,t._ua=e,t._status=x.STATUS_NULL,t._dialog=null,t._earlyDialogs={},t._contact=null,t._from_tag=null,t._to_tag=null,t._connection=null,t._connectionPromiseQueue=Promise.resolve(),t._request=null,t._is_canceled=!1,t._cancel_reason="",t._is_confirmed=!1,t._late_sdp=!1,t._rtcOfferConstraints=null,t._rtcAnswerConstraints=null,t._localMediaStream=null,t._localMediaStreamLocallyGenerated=!1,t._rtcReady=!0,t._timers={ackTimer:null,expiresTimer:null,invite2xxTimer:null,userNoAnswerTimer:null},t._direction=null,t._local_identity=null,t._remote_identity=null,t._start_time=null,t._end_time=null,t._tones=null,t._audioMuted=!1,t._videoMuted=!1,t._localHold=!1,t._remoteHold=!1,t._sessionTimers={enabled:t._ua.configuration.session_timers,refreshMethod:t._ua.configuration.session_timers_refresh_method,defaultExpires:w.SESSION_EXPIRES,currentExpires:null,running:!1,refresher:!1,timer:null},t._referSubscribers={},t._data={},t}return s(o,null,[{key:"C",get:function e(){return x}}]),s(o,[{key:"isInProgress",value:function e(){switch(this._status){case x.STATUS_NULL:case x.STATUS_INVITE_SENT:case x.STATUS_1XX_RECEIVED:case x.STATUS_INVITE_RECEIVED:case x.STATUS_WAITING_FOR_ANSWER:return!0;default:return!1}}},{key:"isEstablished",value:function e(){switch(this._status){case x.STATUS_ANSWERED:case x.STATUS_WAITING_FOR_ACK:case x.STATUS_CONFIRMED:return!0;default:return!1}}},{key:"isEnded",value:function e(){switch(this._status){case x.STATUS_CANCELED:case x.STATUS_TERMINATED:return!0;default:return!1}}},{key:"isMuted",value:function e(){return{audio:this._audioMuted,video:this._videoMuted}}},{key:"isOnHold",value:function e(){return{local:this._localHold,remote:this._remoteHold}}},{key:"connect",value:function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;k("connect()");var s=t,i=I.cloneObject(n.eventHandlers),o=I.cloneArray(n.extraHeaders),a=I.cloneObject(n.mediaConstraints,{audio:!0,video:!0}),l=n.mediaStream||null,u=I.cloneObject(n.pcConfig,{iceServers:[]}),c=n.rtcConstraints||null,f=n.rtcOfferConstraints||null;if(this._rtcOfferConstraints=f,this._rtcAnswerConstraints=n.rtcAnswerConstraints||null,this._data=n.data||this._data,void 0===t)throw new TypeError("Not enough arguments");if(this._status!==x.STATUS_NULL)throw new R.InvalidStateError(this._status);if(!window.RTCPeerConnection)throw new R.NotSupportedError("WebRTC not supported");if(!(t=this._ua.normalizeTarget(t)))throw new TypeError("Invalid target: ".concat(s));for(var h in this._sessionTimers.enabled&&I.isDecimal(n.sessionTimersExpires)&&(n.sessionTimersExpires>=w.MIN_SESSION_EXPIRES?this._sessionTimers.defaultExpires=n.sessionTimersExpires:this._sessionTimers.defaultExpires=w.SESSION_EXPIRES),i){Object.prototype.hasOwnProperty.call(i,h)&&this.on(h,i[h])}this._from_tag=I.newTag();var d=n.anonymous||!1,p={from_tag:this._from_tag};this._contact=this._ua.contact.toString({anonymous:d,outbound:!0}),d&&(p.from_display_name="Anonymous",p.from_uri=new b("sip","anonymous","anonymous.invalid"),o.push("P-Preferred-Identity: ".concat(this._ua.configuration.uri.toString())),o.push("Privacy: id")),o.push("Contact: ".concat(this._contact)),o.push("Content-Type: application/sdp"),this._sessionTimers.enabled&&o.push("Session-Expires: ".concat(this._sessionTimers.defaultExpires)),this._request=new _.InitialOutgoingInviteRequest(t,this._ua,p,o),this._id=this._request.call_id+this._from_tag,this._createRTCConnection(u,c),this._direction="outgoing",this._local_identity=this._request.from,this._remote_identity=this._request.to,r&&r(this),this._newRTCSession("local",this._request),this._sendInitialRequest(a,f,l)}},{key:"init_incoming",value:function e(t,n){var r,s=this;k("init_incoming()");var i=t.hasHeader("Content-Type")?t.getHeader("Content-Type").toLowerCase():void 0;t.body&&"application/sdp"!==i?t.reply(415):(this._status=x.STATUS_INVITE_RECEIVED,this._from_tag=t.from_tag,this._id=t.call_id+this._from_tag,this._request=t,this._contact=this._ua.contact.toString(),t.hasHeader("expires")&&(r=1e3*t.getHeader("expires")),t.to_tag=I.newTag(),this._createDialog(t,"UAS",!0)?(t.body?this._late_sdp=!1:this._late_sdp=!0,this._status=x.STATUS_WAITING_FOR_ANSWER,this._timers.userNoAnswerTimer=setTimeout(function(){t.reply(408),s._failed("local",null,w.causes.NO_ANSWER)},this._ua.configuration.no_answer_timeout),r&&(this._timers.expiresTimer=setTimeout(function(){s._status===x.STATUS_WAITING_FOR_ANSWER&&(t.reply(487),s._failed("system",null,w.causes.EXPIRES))},r)),this._direction="incoming",this._local_identity=t.to,this._remote_identity=t.from,n&&n(this),this._newRTCSession("remote",t),this._status!==x.STATUS_TERMINATED&&(t.reply(180,null,["Contact: ".concat(this._contact)]),this._progress("local",null))):t.reply(500,"Missing Contact header field"))}},{key:"answer",value:function e(){var n=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};k("answer()");var r=this._request,s=I.cloneArray(t.extraHeaders),i=I.cloneObject(t.mediaConstraints),o=t.mediaStream||null,a=I.cloneObject(t.pcConfig,{iceServers:[]}),l=t.rtcConstraints||null,u=t.rtcAnswerConstraints||null,c=I.cloneObject(t.rtcOfferConstraints),f=!1,h=!1,d=!1,p=!1;if(this._rtcAnswerConstraints=u,this._rtcOfferConstraints=t.rtcOfferConstraints||null,this._data=t.data||this._data,"incoming"!==this._direction)throw new R.NotSupportedError('"answer" not supported for outgoing RTCSession');if(this._status!==x.STATUS_WAITING_FOR_ANSWER)throw new R.InvalidStateError(this._status);if(this._sessionTimers.enabled&&I.isDecimal(t.sessionTimersExpires)&&(t.sessionTimersExpires>=w.MIN_SESSION_EXPIRES?this._sessionTimers.defaultExpires=t.sessionTimersExpires:this._sessionTimers.defaultExpires=w.SESSION_EXPIRES),this._status=x.STATUS_ANSWERED,this._createDialog(r,"UAS")){clearTimeout(this._timers.userNoAnswerTimer),s.unshift("Contact: ".concat(this._contact));var _=r.parseSDP();Array.isArray(_.media)||(_.media=[_.media]);var m,v=A(_.media);try{for(v.s();!(m=v.n()).done;){var g=m.value;"audio"===g.type&&(f=!0,g.direction&&"sendrecv"!==g.direction||(d=!0)),"video"===g.type&&(h=!0,g.direction&&"sendrecv"!==g.direction||(p=!0))}}catch(n){v.e(n)}finally{v.f()}if(o&&!1===i.audio){var y,T=A(o.getAudioTracks());try{for(T.s();!(y=T.n()).done;){var b=y.value;o.removeTrack(b)}}catch(n){T.e(n)}finally{T.f()}}if(o&&!1===i.video){var S,C=A(o.getVideoTracks());try{for(C.s();!(S=C.n()).done;){var E=S.value;o.removeTrack(E)}}catch(n){C.e(n)}finally{C.f()}}o||void 0!==i.audio||(i.audio=d),o||void 0!==i.video||(i.video=p),o||f||c.offerToReceiveAudio||(i.audio=!1),o||h||c.offerToReceiveVideo||(i.video=!1),this._createRTCConnection(a,l),Promise.resolve().then(function(){return o||(i.audio||i.video?(n._localMediaStreamLocallyGenerated=!0,navigator.mediaDevices.getUserMedia(i)["catch"](function(e){if(n._status===x.STATUS_TERMINATED)throw new Error("terminated");throw r.reply(480),n._failed("local",null,w.causes.USER_DENIED_MEDIA_ACCESS),O('emit "getusermediafailed" [error:%o]',e),n.emit("getusermediafailed",e),new Error("getUserMedia() failed")})):void 0)}).then(function(t){if(n._status===x.STATUS_TERMINATED)throw new Error("terminated");n._localMediaStream=t,t&&t.getTracks().forEach(function(e){n._connection.addTrack(e,t)})}).then(function(){if(!n._late_sdp){var e={originator:"remote",type:"offer",sdp:r.body};k('emit "sdp"'),n.emit("sdp",e);var t=new RTCSessionDescription({type:"offer",sdp:e.sdp});return n._connectionPromiseQueue=n._connectionPromiseQueue.then(function(){return n._connection.setRemoteDescription(t)})["catch"](function(e){throw r.reply(488),n._failed("system",null,w.causes.WEBRTC_ERROR),O('emit "peerconnection:setremotedescriptionfailed" [error:%o]',e),n.emit("peerconnection:setremotedescriptionfailed",e),new Error("peerconnection.setRemoteDescription() failed")}),n._connectionPromiseQueue}}).then(function(){if(n._status===x.STATUS_TERMINATED)throw new Error("terminated");return n._connecting(r),n._late_sdp?n._createLocalDescription("offer",n._rtcOfferConstraints)["catch"](function(){throw r.reply(500),new Error("_createLocalDescription() failed")}):n._createLocalDescription("answer",u)["catch"](function(){throw r.reply(500),new Error("_createLocalDescription() failed")})}).then(function(e){if(n._status===x.STATUS_TERMINATED)throw new Error("terminated");n._handleSessionTimersInIncomingRequest(r,s),r.reply(200,null,s,e,function(){n._status=x.STATUS_WAITING_FOR_ACK,n._setInvite2xxTimer(r,e),n._setACKTimer(),n._accepted("local")},function(){n._failed("system",null,w.causes.CONNECTION_ERROR)})})["catch"](function(e){n._status!==x.STATUS_TERMINATED&&O(e)})}else r.reply(500,"Error creating dialog")}},{key:"terminate",value:function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};k("terminate()");var r,s=n.cause||w.causes.BYE,i=I.cloneArray(n.extraHeaders),o=n.body,a=n.status_code,l=n.reason_phrase;if(this._status===x.STATUS_TERMINATED)throw new R.InvalidStateError(this._status);switch(this._status){case x.STATUS_NULL:case x.STATUS_INVITE_SENT:case x.STATUS_1XX_RECEIVED:if(k("canceling session"),a&&(a<200||a>=700))throw new TypeError("Invalid status_code: ".concat(a));a&&(l=l||w.REASON_PHRASE[a]||"",r="SIP ;cause=".concat(a,' ;text="').concat(l,'"')),this._status===x.STATUS_NULL||this._status===x.STATUS_INVITE_SENT?(this._is_canceled=!0,this._cancel_reason=r):this._status===x.STATUS_1XX_RECEIVED&&this._request.cancel(r),this._status=x.STATUS_CANCELED,this._failed("local",null,w.causes.CANCELED);break;case x.STATUS_WAITING_FOR_ANSWER:case x.STATUS_ANSWERED:if(k("rejecting session"),(a=a||480)<300||a>=700)throw new TypeError("Invalid status_code: ".concat(a));this._request.reply(a,l,i,o),this._failed("local",null,w.causes.REJECTED);break;case x.STATUS_WAITING_FOR_ACK:case x.STATUS_CONFIRMED:if(k("terminating session"),l=n.reason_phrase||w.REASON_PHRASE[a]||"",a&&(a<200||a>=700))throw new TypeError("Invalid status_code: ".concat(a));if(a&&i.push("Reason: SIP ;cause=".concat(a,'; text="').concat(l,'"')),this._status===x.STATUS_WAITING_FOR_ACK&&"incoming"===this._direction&&this._request.server_transaction.state!==h.C.STATUS_TERMINATED){var u=this._dialog;this.receiveRequest=function(e){e.method===w.ACK&&(t.sendRequest(w.BYE,{extraHeaders:i,body:o}),u.terminate())},this._request.server_transaction.on("stateChanged",function(){t._request.server_transaction.state===h.C.STATUS_TERMINATED&&(t.sendRequest(w.BYE,{extraHeaders:i,body:o}),u.terminate())}),this._ended("local",null,s),this._dialog=u,this._ua.newDialog(u)}else this.sendRequest(w.BYE,{extraHeaders:i,body:o}),this._ended("local",null,s)}}},{key:"sendDTMF",value:function e(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};k("sendDTMF() | tones: %s",t);var a=0,l=o.duration||null,u=o.interToneGap||null,c=o.transportType||w.DTMF_TRANSPORT.INFO;if(void 0===t)throw new TypeError("Not enough arguments");if(this._status!==x.STATUS_CONFIRMED&&this._status!==x.STATUS_WAITING_FOR_ACK)throw new R.InvalidStateError(this._status);if("number"==typeof t&&(t=t.toString()),!t||"string"!=typeof t||!t.match(/^[0-9A-DR#*,]+$/i))throw new TypeError("Invalid tones: ".concat(t));if(l&&!I.isDecimal(l))throw new TypeError("Invalid tone duration: ".concat(l));if(l?l<v.C.MIN_DURATION?(k('"duration" value is lower than the minimum allowed, setting it to '.concat(v.C.MIN_DURATION," milliseconds")),l=v.C.MIN_DURATION):l>v.C.MAX_DURATION?(k('"duration" value is greater than the maximum allowed, setting it to '.concat(v.C.MAX_DURATION," milliseconds")),l=v.C.MAX_DURATION):l=Math.abs(l):l=v.C.DEFAULT_DURATION,o.duration=l,u&&!I.isDecimal(u))throw new TypeError("Invalid interToneGap: ".concat(u));u?u<v.C.MIN_INTER_TONE_GAP?(k('"interToneGap" value is lower than the minimum allowed, setting it to '.concat(v.C.MIN_INTER_TONE_GAP," milliseconds")),u=v.C.MIN_INTER_TONE_GAP):u=Math.abs(u):u=v.C.DEFAULT_INTER_TONE_GAP,this._tones?this._tones+=t:(this._tones=t,function e(){var t=this;var n;if(this._status===x.STATUS_TERMINATED||!this._tones||a>=this._tones.length)return void(this._tones=null);var r=this._tones[a];a+=1;if(","===r)n=2e3;else{if(c!==w.DTMF_TRANSPORT.INFO&&c!==w.DTMF_TRANSPORT.RFC2833)throw new TypeError("invalid transportType: ".concat(c));switch(c){case w.DTMF_TRANSPORT.RFC2833:var s=this._getDTMFRTPSender();s&&s.insertDTMF(r,l,u);break;case w.DTMF_TRANSPORT.INFO:var i=new v(this);o.eventHandlers={onFailed:function e(){t._tones=null}},i.send(r,o),n=l+u}}setTimeout(e.bind(this),n)}.call(this))}},{key:"sendInfo",value:function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(k("sendInfo()"),this._status!==x.STATUS_CONFIRMED&&this._status!==x.STATUS_WAITING_FOR_ACK)throw new R.InvalidStateError(this._status);new g(this).send(t,n,r)}},{key:"mute",value:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{audio:!0,video:!1};k("mute()");var n=!1,r=!1;!1===this._audioMuted&&t.audio&&(n=!0,this._audioMuted=!0,this._toggleMuteAudio(!0)),!1===this._videoMuted&&t.video&&(r=!0,this._videoMuted=!0,this._toggleMuteVideo(!0)),!0!==n&&!0!==r||this._onmute({audio:n,video:r})}},{key:"unmute",value:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{audio:!0,video:!0};k("unmute()");var n=!1,r=!1;!0===this._audioMuted&&t.audio&&(n=!0,this._audioMuted=!1,!1===this._localHold&&this._toggleMuteAudio(!1)),!0===this._videoMuted&&t.video&&(r=!0,this._videoMuted=!1,!1===this._localHold&&this._toggleMuteVideo(!1)),!0!==n&&!0!==r||this._onunmute({audio:n,video:r})}},{key:"hold",value:function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;if(k("hold()"),this._status!==x.STATUS_WAITING_FOR_ACK&&this._status!==x.STATUS_CONFIRMED)return!1;if(!0===this._localHold)return!1;if(!this._isReadyToReOffer())return!1;this._localHold=!0,this._onhold("local");var s={succeeded:function e(){r&&r()},failed:function e(){t.terminate({cause:w.causes.WEBRTC_ERROR,status_code:500,reason_phrase:"Hold Failed"})}};return n.useUpdate?this._sendUpdate({sdpOffer:!0,eventHandlers:s,extraHeaders:n.extraHeaders}):this._sendReinvite({eventHandlers:s,extraHeaders:n.extraHeaders}),!0}},{key:"unhold",value:function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;if(k("unhold()"),this._status!==x.STATUS_WAITING_FOR_ACK&&this._status!==x.STATUS_CONFIRMED)return!1;if(!1===this._localHold)return!1;if(!this._isReadyToReOffer())return!1;this._localHold=!1,this._onunhold("local");var s={succeeded:function e(){r&&r()},failed:function e(){t.terminate({cause:w.causes.WEBRTC_ERROR,status_code:500,reason_phrase:"Unhold Failed"})}};return n.useUpdate?this._sendUpdate({sdpOffer:!0,eventHandlers:s,extraHeaders:n.extraHeaders}):this._sendReinvite({eventHandlers:s,extraHeaders:n.extraHeaders}),!0}},{key:"renegotiate",value:function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;k("renegotiate()");var s=n.rtcOfferConstraints||null;if(this._status!==x.STATUS_WAITING_FOR_ACK&&this._status!==x.STATUS_CONFIRMED)return!1;if(!this._isReadyToReOffer())return!1;var i={succeeded:function e(){r&&r()},failed:function e(){t.terminate({cause:w.causes.WEBRTC_ERROR,status_code:500,reason_phrase:"Media Renegotiation Failed"})}};return this._setLocalMediaStatus(),n.useUpdate?this._sendUpdate({sdpOffer:!0,eventHandlers:i,rtcOfferConstraints:s,extraHeaders:n.extraHeaders}):this._sendReinvite({eventHandlers:i,rtcOfferConstraints:s,extraHeaders:n.extraHeaders}),!0}},{key:"refer",value:function e(t,n){var r=this;k("refer()");var s=t;if(this._status!==x.STATUS_WAITING_FOR_ACK&&this._status!==x.STATUS_CONFIRMED)return!1;if(!(t=this._ua.normalizeTarget(t)))throw new TypeError("Invalid target: ".concat(s));var i=new T(this);i.sendRefer(t,n);var o=i.id;return this._referSubscribers[o]=i,i.on("requestFailed",function(){delete r._referSubscribers[o]}),i.on("accepted",function(){delete r._referSubscribers[o]}),i.on("failed",function(){delete r._referSubscribers[o]}),i}},{key:"sendRequest",value:function e(t,n){return k("sendRequest()"),this._dialog.sendRequest(t,n)}},{key:"receiveRequest",value:function e(t){var n=this;if(k("receiveRequest()"),t.method===w.CANCEL)this._status!==x.STATUS_WAITING_FOR_ANSWER&&this._status!==x.STATUS_ANSWERED||(this._status=x.STATUS_CANCELED,this._request.reply(487),this._failed("remote",t,w.causes.CANCELED));else switch(t.method){case w.ACK:if(this._status!==x.STATUS_WAITING_FOR_ACK)return;if(this._status=x.STATUS_CONFIRMED,clearTimeout(this._timers.ackTimer),clearTimeout(this._timers.invite2xxTimer),this._late_sdp){if(!t.body){this.terminate({cause:w.causes.MISSING_SDP,status_code:400});break}var r={originator:"remote",type:"answer",sdp:t.body};k('emit "sdp"'),this.emit("sdp",r);var s=new RTCSessionDescription({type:"answer",sdp:r.sdp});this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return n._connection.setRemoteDescription(s)}).then(function(){n._is_confirmed||n._confirmed("remote",t)})["catch"](function(e){n.terminate({cause:w.causes.BAD_MEDIA_DESCRIPTION,status_code:488}),O('emit "peerconnection:setremotedescriptionfailed" [error:%o]',e),n.emit("peerconnection:setremotedescriptionfailed",e)})}else this._is_confirmed||this._confirmed("remote",t);break;case w.BYE:this._status===x.STATUS_CONFIRMED||this._status===x.STATUS_WAITING_FOR_ACK?(t.reply(200),this._ended("remote",t,w.causes.BYE)):this._status===x.STATUS_INVITE_RECEIVED?(t.reply(200),this._request.reply(487,"BYE Received"),this._ended("remote",t,w.causes.BYE)):t.reply(403,"Wrong Status");break;case w.INVITE:this._status===x.STATUS_CONFIRMED?t.hasHeader("replaces")?this._receiveReplaces(t):this._receiveReinvite(t):t.reply(403,"Wrong Status");break;case w.INFO:if(this._status===x.STATUS_1XX_RECEIVED||this._status===x.STATUS_WAITING_FOR_ANSWER||this._status===x.STATUS_ANSWERED||this._status===x.STATUS_WAITING_FOR_ACK||this._status===x.STATUS_CONFIRMED){var i=t.hasHeader("Content-Type")?t.getHeader("Content-Type").toLowerCase():void 0;i&&i.match(/^application\/dtmf-relay/i)?new v(this).init_incoming(t):void 0!==i?new g(this).init_incoming(t):t.reply(415)}else t.reply(403,"Wrong Status");break;case w.UPDATE:this._status===x.STATUS_CONFIRMED?this._receiveUpdate(t):t.reply(403,"Wrong Status");break;case w.REFER:this._status===x.STATUS_CONFIRMED?this._receiveRefer(t):t.reply(403,"Wrong Status");break;case w.NOTIFY:this._status===x.STATUS_CONFIRMED?this._receiveNotify(t):t.reply(403,"Wrong Status");break;default:t.reply(501)}}},{key:"onTransportError",value:function e(){O("onTransportError()"),this._status!==x.STATUS_TERMINATED&&this.terminate({status_code:500,reason_phrase:w.causes.CONNECTION_ERROR,cause:w.causes.CONNECTION_ERROR})}},{key:"onRequestTimeout",value:function e(){O("onRequestTimeout()"),this._status!==x.STATUS_TERMINATED&&this.terminate({status_code:408,reason_phrase:w.causes.REQUEST_TIMEOUT,cause:w.causes.REQUEST_TIMEOUT})}},{key:"onDialogError",value:function e(){O("onDialogError()"),this._status!==x.STATUS_TERMINATED&&this.terminate({status_code:500,reason_phrase:w.causes.DIALOG_ERROR,cause:w.causes.DIALOG_ERROR})}},{key:"newDTMF",value:function e(t){k("newDTMF()"),this.emit("newDTMF",t)}},{key:"newInfo",value:function e(t){k("newInfo()"),this.emit("newInfo",t)}},{key:"_isReadyToReOffer",value:function e(){return this._rtcReady?this._dialog?!0!==this._dialog.uac_pending_reply&&!0!==this._dialog.uas_pending_reply||(k("_isReadyToReOffer() | there is another INVITE/UPDATE transaction in progress"),!1):(k("_isReadyToReOffer() | session not established yet"),!1):(k("_isReadyToReOffer() | internal WebRTC status not ready"),!1)}},{key:"_close",value:function e(){if(k("close()"),this._status!==x.STATUS_TERMINATED){if(this._status=x.STATUS_TERMINATED,this._connection)try{this._connection.close()}catch(t){O("close() | error closing the RTCPeerConnection: %o",t)}for(var t in this._localMediaStream&&this._localMediaStreamLocallyGenerated&&(k("close() | closing local MediaStream"),I.closeMediaStream(this._localMediaStream)),this._timers){Object.prototype.hasOwnProperty.call(this._timers,t)&&clearTimeout(this._timers[t])}for(var n in clearTimeout(this._sessionTimers.timer),this._dialog&&(this._dialog.terminate(),delete this._dialog),this._earlyDialogs){Object.prototype.hasOwnProperty.call(this._earlyDialogs,n)&&(this._earlyDialogs[n].terminate(),delete this._earlyDialogs[n])}for(var r in this._referSubscribers){Object.prototype.hasOwnProperty.call(this._referSubscribers,r)&&delete this._referSubscribers[r]}this._ua.destroyRTCSession(this)}}},{key:"_setInvite2xxTimer",value:function e(t,n){var r=d.T1;this._timers.invite2xxTimer=setTimeout(function e(){this._status===x.STATUS_WAITING_FOR_ACK&&(t.reply(200,null,["Contact: ".concat(this._contact)],n),r<d.T2&&(r*=2)>d.T2&&(r=d.T2),this._timers.invite2xxTimer=setTimeout(e.bind(this),r))}.bind(this),r)}},{key:"_setACKTimer",value:function e(){var t=this;this._timers.ackTimer=setTimeout(function(){t._status===x.STATUS_WAITING_FOR_ACK&&(k("no ACK received, terminating the session"),clearTimeout(t._timers.invite2xxTimer),t.sendRequest(w.BYE),t._ended("remote",null,w.causes.NO_ACK))},d.TIMER_H)}},{key:"_createRTCConnection",value:function e(t,n){var r=this;this._connection=new RTCPeerConnection(t,n),this._connection.addEventListener("iceconnectionstatechange",function(){"failed"===r._connection.iceConnectionState&&r.terminate({cause:w.causes.RTP_TIMEOUT,status_code:408,reason_phrase:w.causes.RTP_TIMEOUT})}),k('emit "peerconnection"'),this.emit("peerconnection",{peerconnection:this._connection})}},{key:"_createLocalDescription",value:function e(o,t){var a=this;if(k("createLocalDescription()"),"offer"!==o&&"answer"!==o)throw new Error('createLocalDescription() | invalid type "'.concat(o,'"'));var l=this._connection;return this._rtcReady=!1,Promise.resolve().then(function(){return"offer"===o?l.createOffer(t)["catch"](function(e){return O('emit "peerconnection:createofferfailed" [error:%o]',e),a.emit("peerconnection:createofferfailed",e),Promise.reject(e)}):l.createAnswer(t)["catch"](function(e){return O('emit "peerconnection:createanswerfailed" [error:%o]',e),a.emit("peerconnection:createanswerfailed",e),Promise.reject(e)})}).then(function(e){return l.setLocalDescription(e)["catch"](function(e){return a._rtcReady=!0,O('emit "peerconnection:setlocaldescriptionfailed" [error:%o]',e),a.emit("peerconnection:setlocaldescriptionfailed",e),Promise.reject(e)})}).then(function(){if(!("complete"!==l.iceGatheringState||t&&t.iceRestart)){a._rtcReady=!0;var e={originator:"local",type:o,sdp:l.localDescription.sdp};return k('emit "sdp"'),a.emit("sdp",e),Promise.resolve(e.sdp)}return new Promise(function(t){var n,r,s=!1,i=function e(){l.removeEventListener("icecandidate",n),l.removeEventListener("icegatheringstatechange",r),s=!0,a._rtcReady=!0;var e={originator:"local",type:o,sdp:l.localDescription.sdp};k('emit "sdp"'),a.emit("sdp",e),t(e.sdp)};l.addEventListener("icecandidate",n=function e(t){var n=t.candidate;n?a.emit("icecandidate",{candidate:n,ready:i}):s||i()}),l.addEventListener("icegatheringstatechange",r=function e(){"complete"!==l.iceGatheringState||s||i()})})})}},{key:"_createDialog",value:function e(t,n,r){var s="UAS"===n?t.to_tag:t.from_tag,i="UAS"===n?t.from_tag:t.to_tag,o=t.call_id+s+i,a=this._earlyDialogs[o];if(r)return!!a||((a=new p(this,t,n,p.C.STATUS_EARLY)).error?(k(a.error),this._failed("remote",t,w.causes.INTERNAL_ERROR),!1):(this._earlyDialogs[o]=a,!0));if(this._from_tag=t.from_tag,this._to_tag=t.to_tag,a)return a.update(t,n),this._dialog=a,delete this._earlyDialogs[o],!0;var l=new p(this,t,n);return l.error?(k(l.error),this._failed("remote",t,w.causes.INTERNAL_ERROR),!1):(this._dialog=l,!0)}},{key:"_receiveReinvite",value:function e(s){var t=this;k("receiveReinvite()");var n=s.hasHeader("Content-Type")?s.getHeader("Content-Type").toLowerCase():void 0,r={request:s,callback:void 0,reject:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i=!0;var t=e.status_code||403,n=e.reason_phrase||"",r=I.cloneArray(e.extraHeaders);if(this._status!==x.STATUS_CONFIRMED)return!1;if(t<300||t>=700)throw new TypeError("Invalid status_code: ".concat(t));s.reply(t,n,r)}.bind(this)},i=!1;if(this.emit("reinvite",r),!i){if(this._late_sdp=!1,!s.body)return this._late_sdp=!0,this._remoteHold&&(this._remoteHold=!1,this._onunhold("remote")),void(this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return t._createLocalDescription("offer",t._rtcOfferConstraints)}).then(function(e){o.call(t,e)})["catch"](function(){s.reply(500)}));if("application/sdp"!==n)return k("invalid Content-Type"),void s.reply(415);this._processInDialogSdpOffer(s).then(function(e){t._status!==x.STATUS_TERMINATED&&o.call(t,e)})["catch"](function(e){O(e)})}function o(e){var t=this,n=["Contact: ".concat(this._contact)];this._handleSessionTimersInIncomingRequest(s,n),this._late_sdp&&(e=this._mangleOffer(e)),s.reply(200,null,n,e,function(){t._status=x.STATUS_WAITING_FOR_ACK,t._setInvite2xxTimer(s,e),t._setACKTimer()}),"function"==typeof r.callback&&r.callback()}}},{key:"_receiveUpdate",value:function e(s){var t=this;k("receiveUpdate()");var n=s.hasHeader("Content-Type")?s.getHeader("Content-Type").toLowerCase():void 0,r={request:s,callback:void 0,reject:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i=!0;var t=e.status_code||403,n=e.reason_phrase||"",r=I.cloneArray(e.extraHeaders);if(this._status!==x.STATUS_CONFIRMED)return!1;if(t<300||t>=700)throw new TypeError("Invalid status_code: ".concat(t));s.reply(t,n,r)}.bind(this)},i=!1;if(this.emit("update",r),!i)if(s.body){if("application/sdp"!==n)return k("invalid Content-Type"),void s.reply(415);this._processInDialogSdpOffer(s).then(function(e){t._status!==x.STATUS_TERMINATED&&o.call(t,e)})["catch"](function(e){O(e)})}else o.call(this,null);function o(e){var t=["Contact: ".concat(this._contact)];this._handleSessionTimersInIncomingRequest(s,t),s.reply(200,null,t,e),"function"==typeof r.callback&&r.callback()}}},{key:"_processInDialogSdpOffer",value:function e(t){var n=this;k("_processInDialogSdpOffer()");var r,s=t.parseSDP(),i=!1,o=A(s.media);try{for(o.s();!(r=o.n()).done;){var a=r.value;if(-1!==S.indexOf(a.type)){var l=a.direction||s.direction||"sendrecv";if("sendonly"!==l&&"inactive"!==l){i=!1;break}i=!0}}}catch(t){o.e(t)}finally{o.f()}var u={originator:"remote",type:"offer",sdp:t.body};k('emit "sdp"'),this.emit("sdp",u);var c=new RTCSessionDescription({type:"offer",sdp:u.sdp});return this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){if(n._status===x.STATUS_TERMINATED)throw new Error("terminated");return n._connection.setRemoteDescription(c)["catch"](function(e){throw t.reply(488),O('emit "peerconnection:setremotedescriptionfailed" [error:%o]',e),n.emit("peerconnection:setremotedescriptionfailed",e),new Error("peerconnection.setRemoteDescription() failed")})}).then(function(){if(n._status===x.STATUS_TERMINATED)throw new Error("terminated");!0===n._remoteHold&&!1===i?(n._remoteHold=!1,n._onunhold("remote")):!1===n._remoteHold&&!0===i&&(n._remoteHold=!0,n._onhold("remote"))}).then(function(){if(n._status===x.STATUS_TERMINATED)throw new Error("terminated");return n._createLocalDescription("answer",n._rtcAnswerConstraints)["catch"](function(){throw t.reply(500),new Error("_createLocalDescription() failed")})}),this._connectionPromiseQueue}},{key:"_receiveRefer",value:function e(s){var r=this;if(k("receiveRefer()"),!s.refer_to)return k("no Refer-To header field present in REFER"),void s.reply(400);if(s.refer_to.uri.scheme!==w.SIP)return k("Refer-To header field points to a non-SIP URI scheme"),void s.reply(416);s.reply(202);var i=new y(this,s.cseq);k('emit "refer"'),this.emit("refer",{request:s,accept:function e(t,n){(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e="function"==typeof e?e:null,this._status!==x.STATUS_WAITING_FOR_ACK&&this._status!==x.STATUS_CONFIRMED)return!1;var n=new o(this._ua);if(n.on("progress",function(e){var t=e.response;i.notify(t.status_code,t.reason_phrase)}),n.on("accepted",function(e){var t=e.response;i.notify(t.status_code,t.reason_phrase)}),n.on("_failed",function(e){var t=e.message,n=e.cause;t?i.notify(t.status_code,t.reason_phrase):i.notify(487,n)}),s.refer_to.uri.hasHeader("replaces")){var r=decodeURIComponent(s.refer_to.uri.getHeader("replaces"));t.extraHeaders=I.cloneArray(t.extraHeaders),t.extraHeaders.push("Replaces: ".concat(r))}n.connect(s.refer_to.uri.toAor(),t,e)}).call(r,t,n)},reject:function e(){(function(){i.notify(603)}).call(r)}})}},{key:"_receiveNotify",value:function e(t){switch(k("receiveNotify()"),t.event||t.reply(400),t.event.event){case"refer":var n,r;if(t.event.params&&t.event.params.id)n=t.event.params.id,r=this._referSubscribers[n];else{if(1!==Object.keys(this._referSubscribers).length)return void t.reply(400,"Missing event id parameter");r=this._referSubscribers[Object.keys(this._referSubscribers)[0]]}if(!r)return void t.reply(481,"Subscription does not exist");r.receiveNotify(t),t.reply(200);break;default:t.reply(489)}}},{key:"_receiveReplaces",value:function e(r){var n=this;k("receiveReplaces()"),this.emit("replaces",{request:r,accept:function e(t){(function(e){var t=this;if(this._status!==x.STATUS_WAITING_FOR_ACK&&this._status!==x.STATUS_CONFIRMED)return!1;var n=new o(this._ua);n.on("confirmed",function(){t.terminate()}),n.init_incoming(r,e)}).call(n,t)},reject:function e(){(function(){k("Replaced INVITE rejected by the user"),r.reply(486)}).call(n)}})}},{key:"_sendInitialRequest",value:function e(t,n,r){var s=this,i=new m(this._ua,this._request,{onRequestTimeout:function e(){s.onRequestTimeout()},onTransportError:function e(){s.onTransportError()},onAuthenticated:function e(t){s._request=t},onReceiveResponse:function e(t){s._receiveInviteResponse(t)}});Promise.resolve().then(function(){return r||(t.audio||t.video?(s._localMediaStreamLocallyGenerated=!0,navigator.mediaDevices.getUserMedia(t)["catch"](function(e){if(s._status===x.STATUS_TERMINATED)throw new Error("terminated");throw s._failed("local",null,w.causes.USER_DENIED_MEDIA_ACCESS),O('emit "getusermediafailed" [error:%o]',e),s.emit("getusermediafailed",e),e})):void 0)}).then(function(t){if(s._status===x.STATUS_TERMINATED)throw new Error("terminated");return s._localMediaStream=t,t&&t.getTracks().forEach(function(e){s._connection.addTrack(e,t)}),s._connecting(s._request),s._createLocalDescription("offer",n)["catch"](function(e){throw s._failed("local",null,w.causes.WEBRTC_ERROR),e})}).then(function(e){if(s._is_canceled||s._status===x.STATUS_TERMINATED)throw new Error("terminated");s._request.body=e,s._status=x.STATUS_INVITE_SENT,k('emit "sending" [request:%o]',s._request),s.emit("sending",{request:s._request}),i.send()})["catch"](function(e){s._status!==x.STATUS_TERMINATED&&O(e)})}},{key:"_getDTMFRTPSender",value:function e(){var t=this._connection.getSenders().find(function(e){return e.track&&"audio"===e.track.kind});if(t&&t.dtmf)return t.dtmf;O("sendDTMF() | no local audio track to send DTMF with")}},{key:"_receiveInviteResponse",value:function e(t){var n=this;if(k("receiveInviteResponse()"),this._dialog&&t.status_code>=200&&t.status_code<=299){if(this._dialog.id.call_id===t.call_id&&this._dialog.id.local_tag===t.from_tag&&this._dialog.id.remote_tag===t.to_tag)return void this.sendRequest(w.ACK);var r=new p(this,t,"UAC");return void 0!==r.error?void k(r.error):(this.sendRequest(w.ACK),void this.sendRequest(w.BYE))}if(this._is_canceled)t.status_code>=100&&t.status_code<200?this._request.cancel(this._cancel_reason):t.status_code>=200&&t.status_code<299&&this._acceptAndTerminate(t);else if(this._status===x.STATUS_INVITE_SENT||this._status===x.STATUS_1XX_RECEIVED)switch(!0){case/^100$/.test(t.status_code):this._status=x.STATUS_1XX_RECEIVED;break;case/^1[0-9]{2}$/.test(t.status_code):if(!t.to_tag){k("1xx response received without to tag");break}if(t.hasHeader("contact")&&!this._createDialog(t,"UAC",!0))break;if(this._status=x.STATUS_1XX_RECEIVED,this._progress("remote",t),!t.body)break;var s={originator:"remote",type:"answer",sdp:t.body};k('emit "sdp"'),this.emit("sdp",s);var i=new RTCSessionDescription({type:"answer",sdp:s.sdp});this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return n._connection.setRemoteDescription(i)})["catch"](function(e){O('emit "peerconnection:setremotedescriptionfailed" [error:%o]',e),n.emit("peerconnection:setremotedescriptionfailed",e)});break;case/^2[0-9]{2}$/.test(t.status_code):if(this._status=x.STATUS_CONFIRMED,!t.body){this._acceptAndTerminate(t,400,w.causes.MISSING_SDP),this._failed("remote",t,w.causes.BAD_MEDIA_DESCRIPTION);break}if(!this._createDialog(t,"UAC"))break;var o={originator:"remote",type:"answer",sdp:t.body};k('emit "sdp"'),this.emit("sdp",o);var a=new RTCSessionDescription({type:"answer",sdp:o.sdp});this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){if("stable"===n._connection.signalingState)return n._connection.createOffer(n._rtcOfferConstraints).then(function(e){return n._connection.setLocalDescription(e)})["catch"](function(e){n._acceptAndTerminate(t,500,e.toString()),n._failed("local",t,w.causes.WEBRTC_ERROR)})}).then(function(){n._connection.setRemoteDescription(a).then(function(){n._handleSessionTimersInIncomingResponse(t),n._accepted("remote",t),n.sendRequest(w.ACK),n._confirmed("local",null)})["catch"](function(e){n._acceptAndTerminate(t,488,"Not Acceptable Here"),n._failed("remote",t,w.causes.BAD_MEDIA_DESCRIPTION),O('emit "peerconnection:setremotedescriptionfailed" [error:%o]',e),n.emit("peerconnection:setremotedescriptionfailed",e)})});break;default:var l=I.sipErrorCause(t.status_code);this._failed("remote",t,l)}}},{key:"_sendReinvite",value:function e(){var n=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};k("sendReinvite()");var r=I.cloneArray(t.extraHeaders),s=I.cloneObject(t.eventHandlers),i=t.rtcOfferConstraints||this._rtcOfferConstraints||null,o=!1;function a(e){s.failed&&s.failed(e)}r.push("Contact: ".concat(this._contact)),r.push("Content-Type: application/sdp"),this._sessionTimers.running&&r.push("Session-Expires: ".concat(this._sessionTimers.currentExpires,";refresher=").concat(this._sessionTimers.refresher?"uac":"uas")),this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return n._createLocalDescription("offer",i)}).then(function(e){var t={originator:"local",type:"offer",sdp:e=n._mangleOffer(e)};k('emit "sdp"'),n.emit("sdp",t),n.sendRequest(w.INVITE,{extraHeaders:r,body:e,eventHandlers:{onSuccessResponse:function e(t){(function(e){var t=this;if(this._status===x.STATUS_TERMINATED)return;if(this.sendRequest(w.ACK),o)return;if(this._handleSessionTimersInIncomingResponse(e),!e.body)return void a.call(this);if(!e.hasHeader("Content-Type")||"application/sdp"!==e.getHeader("Content-Type").toLowerCase())return void a.call(this);var n={originator:"remote",type:"answer",sdp:e.body};k('emit "sdp"'),this.emit("sdp",n);var r=new RTCSessionDescription({type:"answer",sdp:n.sdp});this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return t._connection.setRemoteDescription(r)}).then(function(){s.succeeded&&s.succeeded(e)})["catch"](function(e){a.call(t),O('emit "peerconnection:setremotedescriptionfailed" [error:%o]',e),t.emit("peerconnection:setremotedescriptionfailed",e)})}).call(n,t),o=!0},onErrorResponse:function e(t){a.call(n,t)},onTransportError:function e(){n.onTransportError()},onRequestTimeout:function e(){n.onRequestTimeout()},onDialogError:function e(){n.onDialogError()}}})})["catch"](function(){a()})}},{key:"_sendUpdate",value:function e(){var n=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};k("sendUpdate()");var r=I.cloneArray(t.extraHeaders),s=I.cloneObject(t.eventHandlers),i=t.rtcOfferConstraints||this._rtcOfferConstraints||null,o=t.sdpOffer||!1,a=!1;function l(e){var t=this;if(this._status!==x.STATUS_TERMINATED&&!a)if(this._handleSessionTimersInIncomingResponse(e),o){if(!e.body)return void u.call(this);if(!e.hasHeader("Content-Type")||"application/sdp"!==e.getHeader("Content-Type").toLowerCase())return void u.call(this);var n={originator:"remote",type:"answer",sdp:e.body};k('emit "sdp"'),this.emit("sdp",n);var r=new RTCSessionDescription({type:"answer",sdp:n.sdp});this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return t._connection.setRemoteDescription(r)}).then(function(){s.succeeded&&s.succeeded(e)})["catch"](function(e){u.call(t),O('emit "peerconnection:setremotedescriptionfailed" [error:%o]',e),t.emit("peerconnection:setremotedescriptionfailed",e)})}else s.succeeded&&s.succeeded(e)}function u(e){s.failed&&s.failed(e)}r.push("Contact: ".concat(this._contact)),this._sessionTimers.running&&r.push("Session-Expires: ".concat(this._sessionTimers.currentExpires,";refresher=").concat(this._sessionTimers.refresher?"uac":"uas")),o?(r.push("Content-Type: application/sdp"),this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return n._createLocalDescription("offer",i)}).then(function(e){var t={originator:"local",type:"offer",sdp:e=n._mangleOffer(e)};k('emit "sdp"'),n.emit("sdp",t),n.sendRequest(w.UPDATE,{extraHeaders:r,body:e,eventHandlers:{onSuccessResponse:function e(t){l.call(n,t),a=!0},onErrorResponse:function e(t){u.call(n,t)},onTransportError:function e(){n.onTransportError()},onRequestTimeout:function e(){n.onRequestTimeout()},onDialogError:function e(){n.onDialogError()}}})})["catch"](function(){u.call(n)})):this.sendRequest(w.UPDATE,{extraHeaders:r,eventHandlers:{onSuccessResponse:function e(t){l.call(n,t)},onErrorResponse:function e(t){u.call(n,t)},onTransportError:function e(){n.onTransportError()},onRequestTimeout:function e(){n.onRequestTimeout()},onDialogError:function e(){n.onDialogError()}}})}},{key:"_acceptAndTerminate",value:function e(t,n,r){k("acceptAndTerminate()");var s=[];n&&(r=r||w.REASON_PHRASE[n]||"",s.push("Reason: SIP ;cause=".concat(n,'; text="').concat(r,'"'))),(this._dialog||this._createDialog(t,"UAC"))&&(this.sendRequest(w.ACK),this.sendRequest(w.BYE,{extraHeaders:s})),this._status=x.STATUS_TERMINATED}},{key:"_mangleOffer",value:function e(t){if(!this._localHold&&!this._remoteHold)return t;if(t=f.parse(t),this._localHold&&!this._remoteHold){k("mangleOffer() | me on hold, mangling offer");var n,r=A(t.media);try{for(r.s();!(n=r.n()).done;){var s=n.value;-1!==S.indexOf(s.type)&&(s.direction?"sendrecv"===s.direction?s.direction="sendonly":"recvonly"===s.direction&&(s.direction="inactive"):s.direction="sendonly")}}catch(t){r.e(t)}finally{r.f()}}else if(this._localHold&&this._remoteHold){k("mangleOffer() | both on hold, mangling offer");var i,o=A(t.media);try{for(o.s();!(i=o.n()).done;){var a=i.value;-1!==S.indexOf(a.type)&&(a.direction="inactive")}}catch(t){o.e(t)}finally{o.f()}}else if(this._remoteHold){k("mangleOffer() | remote on hold, mangling offer");var l,u=A(t.media);try{for(u.s();!(l=u.n()).done;){var c=l.value;-1!==S.indexOf(c.type)&&(c.direction?"sendrecv"===c.direction?c.direction="recvonly":"recvonly"===c.direction&&(c.direction="inactive"):c.direction="recvonly")}}catch(t){u.e(t)}finally{u.f()}}return f.write(t)}},{key:"_setLocalMediaStatus",value:function e(){var t=!0,n=!0;(this._localHold||this._remoteHold)&&(t=!1,n=!1),this._audioMuted&&(t=!1),this._videoMuted&&(n=!1),this._toggleMuteAudio(!t),this._toggleMuteVideo(!n)}},{key:"_handleSessionTimersInIncomingRequest",value:function e(t,n){var r;this._sessionTimers.enabled&&(t.session_expires&&t.session_expires>=w.MIN_SESSION_EXPIRES?(this._sessionTimers.currentExpires=t.session_expires,r=t.session_expires_refresher||"uas"):(this._sessionTimers.currentExpires=this._sessionTimers.defaultExpires,r="uas"),n.push("Session-Expires: ".concat(this._sessionTimers.currentExpires,";refresher=").concat(r)),this._sessionTimers.refresher="uas"===r,this._runSessionTimer())}},{key:"_handleSessionTimersInIncomingResponse",value:function e(t){var n;this._sessionTimers.enabled&&(t.session_expires&&t.session_expires>=w.MIN_SESSION_EXPIRES?(this._sessionTimers.currentExpires=t.session_expires,n=t.session_expires_refresher||"uac"):(this._sessionTimers.currentExpires=this._sessionTimers.defaultExpires,n="uac"),this._sessionTimers.refresher="uac"===n,this._runSessionTimer())}},{key:"_runSessionTimer",value:function e(){var t=this,n=this._sessionTimers.currentExpires;this._sessionTimers.running=!0,clearTimeout(this._sessionTimers.timer),this._sessionTimers.refresher?this._sessionTimers.timer=setTimeout(function(){t._status!==x.STATUS_TERMINATED&&(k("runSessionTimer() | sending session refresh request"),t._sessionTimers.refreshMethod===w.UPDATE?t._sendUpdate():t._sendReinvite())},500*n):this._sessionTimers.timer=setTimeout(function(){t._status!==x.STATUS_TERMINATED&&(O("runSessionTimer() | timer expired, terminating the session"),t.terminate({cause:w.causes.REQUEST_TIMEOUT,status_code:408,reason_phrase:"Session Timer Expired"}))},1100*n)}},{key:"_toggleMuteAudio",value:function e(t){var n,r=A(this._connection.getSenders().filter(function(e){return e.track&&"audio"===e.track.kind}));try{for(r.s();!(n=r.n()).done;){n.value.track.enabled=!t}}catch(t){r.e(t)}finally{r.f()}}},{key:"_toggleMuteVideo",value:function e(t){var n,r=A(this._connection.getSenders().filter(function(e){return e.track&&"video"===e.track.kind}));try{for(r.s();!(n=r.n()).done;){n.value.track.enabled=!t}}catch(t){r.e(t)}finally{r.f()}}},{key:"_newRTCSession",value:function e(t,n){k("newRTCSession()"),this._ua.newRTCSession(this,{originator:t,session:this,request:n})}},{key:"_connecting",value:function e(t){k("session connecting"),k('emit "connecting"'),this.emit("connecting",{request:t})}},{key:"_progress",value:function e(t,n){k("session progress"),k('emit "progress"'),this.emit("progress",{originator:t,response:n||null})}},{key:"_accepted",value:function e(t,n){k("session accepted"),this._start_time=new Date,k('emit "accepted"'),this.emit("accepted",{originator:t,response:n||null})}},{key:"_confirmed",value:function e(t,n){k("session confirmed"),this._is_confirmed=!0,k('emit "confirmed"'),this.emit("confirmed",{originator:t,ack:n||null})}},{key:"_ended",value:function e(t,n,r){k("session ended"),this._end_time=new Date,this._close(),k('emit "ended"'),this.emit("ended",{originator:t,message:n||null,cause:r})}},{key:"_failed",value:function e(t,n,r){k("session failed"),k('emit "_failed"'),this.emit("_failed",{originator:t,message:n||null,cause:r}),this._close(),k('emit "failed"'),this.emit("failed",{originator:t,message:n||null,cause:r})}},{key:"_onhold",value:function e(t){k("session onhold"),this._setLocalMediaStatus(),k('emit "hold"'),this.emit("hold",{originator:t})}},{key:"_onunhold",value:function e(t){k("session onunhold"),this._setLocalMediaStatus(),k('emit "unhold"'),this.emit("unhold",{originator:t})}},{key:"_onmute",value:function e(t){var n=t.audio,r=t.video;k("session onmute"),this._setLocalMediaStatus(),k('emit "muted"'),this.emit("muted",{audio:n,video:r})}},{key:"_onunmute",value:function e(t){var n=t.audio,r=t.video;k("session onunmute"),this._setLocalMediaStatus(),k('emit "unmuted"'),this.emit("unmuted",{audio:n,video:r})}},{key:"C",get:function e(){return x}},{key:"causes",get:function e(){return w.causes}},{key:"id",get:function e(){return this._id}},{key:"connection",get:function e(){return this._connection}},{key:"contact",get:function e(){return this._contact}},{key:"direction",get:function e(){return this._direction}},{key:"local_identity",get:function e(){return this._local_identity}},{key:"remote_identity",get:function e(){return this._remote_identity}},{key:"start_time",get:function e(){return this._start_time}},{key:"end_time",get:function e(){return this._end_time}},{key:"data",get:function e(){return this._data},set:function e(t){this._data=t}},{key:"status",get:function e(){return this._status}}]),o}()},{"./Constants":2,"./Dialog":3,"./Exceptions":6,"./RTCSession/DTMF":13,"./RTCSession/Info":14,"./RTCSession/ReferNotifier":15,"./RTCSession/ReferSubscriber":16,"./RequestSender":18,"./SIPMessage":19,"./Timers":21,"./Transactions":22,"./URI":25,"./Utils":26,debug:30,events:29,"sdp-transform":35}],13:[function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==N(Symbol.iterator)?function(e){return N(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":N(e)})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=u(r);if(s){var n=u(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var c=e("events").EventEmitter,f=e("../Constants"),h=e("../Exceptions"),d=e("../Utils"),p=e("debug")("JsSIP:RTCSession:DTMF");e("debug")("JsSIP:ERROR:RTCSession:DTMF").log=console.warn.bind(console);var _={MIN_DURATION:70,MAX_DURATION:6e3,DEFAULT_DURATION:100,MIN_INTER_TONE_GAP:50,DEFAULT_INTER_TONE_GAP:500};t.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(i,c);var t,n,r,s=l(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=s.call(this))._session=e,t._direction=null,t._tone=null,t._duration=null,t._request=null,t}return t=i,(n=[{key:"send",value:function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(void 0===t)throw new TypeError("Not enough arguments");if(this._direction="outgoing",this._session.status!==this._session.C.STATUS_CONFIRMED&&this._session.status!==this._session.C.STATUS_WAITING_FOR_ACK)throw new h.InvalidStateError(this._session.status);var s=d.cloneArray(r.extraHeaders);if(this.eventHandlers=d.cloneObject(r.eventHandlers),"string"==typeof t)t=t.toUpperCase();else{if("number"!=typeof t)throw new TypeError("Invalid tone: ".concat(t));t=t.toString()}if(!t.match(/^[0-9A-DR#*]$/))throw new TypeError("Invalid tone: ".concat(t));this._tone=t,this._duration=r.duration,s.push("Content-Type: application/dtmf-relay");var i="Signal=".concat(this._tone,"\r\n");i+="Duration=".concat(this._duration),this._session.newDTMF({originator:"local",dtmf:this,request:this._request}),this._session.sendRequest(f.INFO,{extraHeaders:s,eventHandlers:{onSuccessResponse:function e(t){n.emit("succeeded",{originator:"remote",response:t})},onErrorResponse:function e(t){n.eventHandlers.onFailed&&n.eventHandlers.onFailed(),n.emit("failed",{originator:"remote",response:t})},onRequestTimeout:function e(){n._session.onRequestTimeout()},onTransportError:function e(){n._session.onTransportError()},onDialogError:function e(){n._session.onDialogError()}},body:i})}},{key:"init_incoming",value:function e(t){var n=/^(Signal\s*?=\s*?)([0-9A-D#*]{1})(\s)?.*/,r=/^(Duration\s?=\s?)([0-9]{1,4})(\s)?.*/;if(this._direction="incoming",this._request=t,t.reply(200),t.body){var s=t.body.split("\n");s.length>=1&&n.test(s[0])&&(this._tone=s[0].replace(n,"$2")),s.length>=2&&r.test(s[1])&&(this._duration=parseInt(s[1].replace(r,"$2"),10))}this._duration||(this._duration=_.DEFAULT_DURATION),this._tone?this._session.newDTMF({originator:"remote",dtmf:this,request:t}):p("invalid INFO DTMF received, discarded")}},{key:"tone",get:function e(){return this._tone}},{key:"duration",get:function e(){return this._duration}}])&&o(t.prototype,n),r&&o(t,r),i}(),t.exports.C=_},{"../Constants":2,"../Exceptions":6,"../Utils":26,debug:30,events:29}],14:[function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==N(Symbol.iterator)?function(e){return N(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":N(e)})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=u(r);if(s){var n=u(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var c=e("events").EventEmitter;e("debug")("JsSIP:ERROR:RTCSession:Info").log=console.warn.bind(console);var f=e("../Constants"),h=e("../Exceptions"),d=e("../Utils");t.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(i,c);var t,n,r,s=l(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=s.call(this))._session=e,t._direction=null,t._contentType=null,t._body=null,t}return t=i,(n=[{key:"send",value:function e(t,n){var r=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this._direction="outgoing",void 0===t)throw new TypeError("Not enough arguments");if(this._session.status!==this._session.C.STATUS_CONFIRMED&&this._session.status!==this._session.C.STATUS_WAITING_FOR_ACK)throw new h.InvalidStateError(this._session.status);this._contentType=t,this._body=n;var i=d.cloneArray(s.extraHeaders);i.push("Content-Type: ".concat(t)),this._session.newInfo({originator:"local",info:this,request:this.request}),this._session.sendRequest(f.INFO,{extraHeaders:i,eventHandlers:{onSuccessResponse:function e(t){r.emit("succeeded",{originator:"remote",response:t})},onErrorResponse:function e(t){r.emit("failed",{originator:"remote",response:t})},onTransportError:function e(){r._session.onTransportError()},onRequestTimeout:function e(){r._session.onRequestTimeout()},onDialogError:function e(){r._session.onDialogError()}},body:n})}},{key:"init_incoming",value:function e(t){this._direction="incoming",this.request=t,t.reply(200),this._contentType=t.hasHeader("Content-Type")?t.getHeader("Content-Type").toLowerCase():void 0,this._body=t.body,this._session.newInfo({originator:"remote",info:this,request:t})}},{key:"contentType",get:function e(){return this._contentType}},{key:"body",get:function e(){return this._body}}])&&o(t.prototype,n),r&&o(t,r),i}()},{"../Constants":2,"../Exceptions":6,"../Utils":26,debug:30,events:29}],15:[function(e,t,n){"use strict";function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=e("../Constants"),o=e("debug")("JsSIP:RTCSession:ReferNotifier"),a={event_type:"refer",body_type:"message/sipfrag;version=2.0",expires:300};t.exports=function(){function r(e,t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this._session=e,this._id=t,this._expires=n||a.expires,this._active=!0,this.notify(100)}var e,t,n;return e=r,(t=[{key:"notify",value:function e(t,n){var r;(o("notify()"),!1!==this._active)&&(n=n||i.REASON_PHRASE[t]||"",r=t>=200?"terminated;reason=noresource":"active;expires=".concat(this._expires),this._session.sendRequest(i.NOTIFY,{extraHeaders:["Event: ".concat(a.event_type,";id=").concat(this._id),"Subscription-State: ".concat(r),"Content-Type: ".concat(a.body_type)],body:"SIP/2.0 ".concat(t," ").concat(n),eventHandlers:{onErrorResponse:function e(){this._active=!1}}}))}}])&&s(e.prototype,t),n&&s(e,n),r}()},{"../Constants":2,debug:30}],16:[function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==N(Symbol.iterator)?function(e){return N(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":N(e)})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=u(r);if(s){var n=u(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var c=e("events").EventEmitter,f=e("../Constants"),h=e("../Grammar"),d=e("../Utils"),p=e("debug")("JsSIP:RTCSession:ReferSubscriber");t.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(i,c);var t,n,r,s=l(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=s.call(this))._id=null,t._session=e,t}return t=i,(n=[{key:"sendRefer",value:function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};p("sendRefer()");var s=d.cloneArray(r.extraHeaders),i=d.cloneObject(r.eventHandlers);for(var o in i){Object.prototype.hasOwnProperty.call(i,o)&&this.on(o,i[o])}var a=null;r.replaces&&(a=r.replaces._request.call_id,a+=";to-tag=".concat(r.replaces._to_tag),a+=";from-tag=".concat(r.replaces._from_tag),a=encodeURIComponent(a));var l="Refer-To: <".concat(t).concat(a?"?Replaces=".concat(a):"",">");s.push(l);var u="Referred-By: <".concat(this._session._ua._configuration.uri._scheme,":").concat(this._session._ua._configuration.uri._user,"@").concat(this._session._ua._configuration.uri._host,">");s.push(u),s.push("Contact: ".concat(this._session.contact));var c=this._session.sendRequest(f.REFER,{extraHeaders:s,eventHandlers:{onSuccessResponse:function e(t){n._requestSucceeded(t)},onErrorResponse:function e(t){n._requestFailed(t,f.causes.REJECTED)},onTransportError:function e(){n._requestFailed(null,f.causes.CONNECTION_ERROR)},onRequestTimeout:function e(){n._requestFailed(null,f.causes.REQUEST_TIMEOUT)},onDialogError:function e(){n._requestFailed(null,f.causes.DIALOG_ERROR)}}});this._id=c.cseq}},{key:"receiveNotify",value:function e(t){if(p("receiveNotify()"),t.body){var n=h.parse(t.body.trim(),"Status_Line");if(-1!==n)switch(!0){case/^100$/.test(n.status_code):this.emit("trying",{request:t,status_line:n});break;case/^1[0-9]{2}$/.test(n.status_code):this.emit("progress",{request:t,status_line:n});break;case/^2[0-9]{2}$/.test(n.status_code):this.emit("accepted",{request:t,status_line:n});break;default:this.emit("failed",{request:t,status_line:n})}else p('receiveNotify() | error parsing NOTIFY body: "'.concat(t.body,'"'))}}},{key:"_requestSucceeded",value:function e(t){p("REFER succeeded"),p('emit "requestSucceeded"'),this.emit("requestSucceeded",{response:t})}},{key:"_requestFailed",value:function e(t,n){p("REFER failed"),p('emit "requestFailed"'),this.emit("requestFailed",{response:t||null,cause:n})}},{key:"id",get:function e(){return this._id}}])&&o(t.prototype,n),r&&o(t,r),i}()},{"../Constants":2,"../Grammar":7,"../Utils":26,debug:30,events:29}],17:[function(e,t,n){"use strict";function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=e("./Utils"),a=e("./Constants"),l=e("./SIPMessage"),u=e("./RequestSender"),c=e("debug")("JsSIP:Registrator");t.exports=function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);this._ua=e,this._transport=t,this._registrar=e.configuration.registrar_server,this._expires=e.configuration.register_expires,this._call_id=o.createRandomToken(22),this._cseq=0,this._to_uri=e.configuration.uri,this._registrationTimer=null,this._registering=!1,this._registered=!1,this._contact=this._ua.contact.toString(),this._contact+=";+sip.ice",this._extraHeaders=[],this._extraContactParams="",this._contact+=";reg-id=".concat(1),this._contact+=';+sip.instance="<urn:uuid:'.concat(this._ua.configuration.instance_id,'>"')}var e,t,r;return e=n,(t=[{key:"setExtraHeaders",value:function e(t){Array.isArray(t)||(t=[]),this._extraHeaders=t.slice()}},{key:"setExtraContactParams",value:function e(t){for(var n in t instanceof Object||(t={}),this._extraContactParams="",t){if(Object.prototype.hasOwnProperty.call(t,n)){var r=t[n];this._extraContactParams+=";".concat(n),r&&(this._extraContactParams+="=".concat(r))}}}},{key:"register",value:function e(){var i=this;if(this._registering)c("Register request in progress...");else{var t=this._extraHeaders.slice();t.push("Contact: ".concat(this._contact,";expires=").concat(this._expires).concat(this._extraContactParams)),t.push("Expires: ".concat(this._expires));var n=new l.OutgoingRequest(a.REGISTER,this._registrar,this._ua,{to_uri:this._to_uri,call_id:this._call_id,cseq:this._cseq+=1},t),r=new u(this._ua,n,{onRequestTimeout:function e(){i._registrationFailure(null,a.causes.REQUEST_TIMEOUT)},onTransportError:function e(){i._registrationFailure(null,a.causes.CONNECTION_ERROR)},onAuthenticated:function e(){i._cseq+=1},onReceiveResponse:function e(t){if(t.cseq===i._cseq)switch(null!==i._registrationTimer&&(clearTimeout(i._registrationTimer),i._registrationTimer=null),!0){case/^1[0-9]{2}$/.test(t.status_code):break;case/^2[0-9]{2}$/.test(t.status_code):if(i._registering=!1,!t.hasHeader("Contact")){c("no Contact header in response to REGISTER, response ignored");break}var n=t.headers.Contact.reduce(function(e,t){return e.concat(t.parsed)},[]).find(function(e){return e.uri.user===i._ua.contact.uri.user});if(!n){c("no Contact header pointing to us, response ignored");break}var r=n.getParam("expires");!r&&t.hasHeader("expires")&&(r=t.getHeader("expires")),r||(r=i._expires),(r=Number(r))<10&&(r=10),i._registrationTimer=setTimeout(function(){i._registrationTimer=null,0===i._ua.listeners("registrationExpiring").length?i.register():i._ua.emit("registrationExpiring")},1e3*r-5e3),n.hasParam("temp-gruu")&&(i._ua.contact.temp_gruu=n.getParam("temp-gruu").replace(/"/g,"")),n.hasParam("pub-gruu")&&(i._ua.contact.pub_gruu=n.getParam("pub-gruu").replace(/"/g,"")),i._registered||(i._registered=!0,i._ua.registered({response:t}));break;case/^423$/.test(t.status_code):t.hasHeader("min-expires")?(i._expires=Number(t.getHeader("min-expires")),i._expires<10&&(i._expires=10),i.register()):(c("423 response received for REGISTER without Min-Expires"),i._registrationFailure(t,a.causes.SIP_FAILURE_CODE));break;default:var s=o.sipErrorCause(t.status_code);i._registrationFailure(t,s)}}});this._registering=!0,r.send()}}},{key:"unregister",value:function e(){var r=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._registered){this._registered=!1,null!==this._registrationTimer&&(clearTimeout(this._registrationTimer),this._registrationTimer=null);var n=this._extraHeaders.slice();t.all?n.push("Contact: *".concat(this._extraContactParams)):n.push("Contact: ".concat(this._contact,";expires=0").concat(this._extraContactParams)),n.push("Expires: 0");var s=new l.OutgoingRequest(a.REGISTER,this._registrar,this._ua,{to_uri:this._to_uri,call_id:this._call_id,cseq:this._cseq+=1},n);new u(this._ua,s,{onRequestTimeout:function e(){r._unregistered(null,a.causes.REQUEST_TIMEOUT)},onTransportError:function e(){r._unregistered(null,a.causes.CONNECTION_ERROR)},onAuthenticated:function e(){r._cseq+=1},onReceiveResponse:function e(t){switch(!0){case/^1[0-9]{2}$/.test(t.status_code):break;case/^2[0-9]{2}$/.test(t.status_code):r._unregistered(t);break;default:var n=o.sipErrorCause(t.status_code);r._unregistered(t,n)}}}).send()}else c("already unregistered")}},{key:"close",value:function e(){this._registered&&this.unregister()}},{key:"onTransportClosed",value:function e(){this._registering=!1,null!==this._registrationTimer&&(clearTimeout(this._registrationTimer),this._registrationTimer=null),this._registered&&(this._registered=!1,this._ua.unregistered({}))}},{key:"_registrationFailure",value:function e(t,n){this._registering=!1,this._ua.registrationFailed({response:t||null,cause:n}),this._registered&&(this._registered=!1,this._ua.unregistered({response:t||null,cause:n}))}},{key:"_unregistered",value:function e(t,n){this._registering=!1,this._registered=!1,this._ua.unregistered({response:t||null,cause:n||null})}},{key:"registered",get:function e(){return this._registered}}])&&s(e.prototype,t),r&&s(e,r),n}()},{"./Constants":2,"./RequestSender":18,"./SIPMessage":19,"./Utils":26,debug:30}],18:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=e("./Constants"),o=e("./DigestAuthentication"),a=e("./Transactions"),l=e("debug")("JsSIP:RequestSender"),u={onRequestTimeout:function e(){},onTransportError:function e(){},onReceiveResponse:function e(){},onAuthenticated:function e(){}};t.exports=function(){function s(e,t,n){for(var r in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),this._ua=e,this._eventHandlers=n,this._method=t.method,this._request=t,this._auth=null,this._challenged=!1,this._staled=!1,u){Object.prototype.hasOwnProperty.call(u,r)&&(this._eventHandlers[r]||(this._eventHandlers[r]=u[r]))}e.status!==e.C.STATUS_USER_CLOSED||this._method===i.BYE&&this._method===i.ACK||this._eventHandlers.onTransportError()}var e,t,n;return e=s,(t=[{key:"send",value:function e(){var n=this,t={onRequestTimeout:function e(){n._eventHandlers.onRequestTimeout()},onTransportError:function e(){n._eventHandlers.onTransportError()},onReceiveResponse:function e(t){n._receiveResponse(t)}};switch(this._method){case"INVITE":this.clientTransaction=new a.InviteClientTransaction(this._ua,this._ua.transport,this._request,t);break;case"ACK":this.clientTransaction=new a.AckClientTransaction(this._ua,this._ua.transport,this._request,t);break;default:this.clientTransaction=new a.NonInviteClientTransaction(this._ua,this._ua.transport,this._request,t)}this._ua._configuration.authorization_jwt&&this._request.setHeader("Authorization",this._ua._configuration.authorization_jwt),this.clientTransaction.send()}},{key:"_receiveResponse",value:function e(t){var n,r,s=t.status_code;if(401!==s&&407!==s||null===this._ua.configuration.password&&null===this._ua.configuration.ha1)this._eventHandlers.onReceiveResponse(t);else{if(401===t.status_code?(n=t.parseHeader("www-authenticate"),r="authorization"):(n=t.parseHeader("proxy-authenticate"),r="proxy-authorization"),!n)return l("".concat(t.status_code," with wrong or missing challenge, cannot authenticate")),void this._eventHandlers.onReceiveResponse(t);if(!this._challenged||!this._staled&&!0===n.stale){if(this._auth||(this._auth=new o({username:this._ua.configuration.authorization_user,password:this._ua.configuration.password,realm:this._ua.configuration.realm,ha1:this._ua.configuration.ha1})),!this._auth.authenticate(this._request,n))return void this._eventHandlers.onReceiveResponse(t);this._challenged=!0,this._ua.set("realm",this._auth.get("realm")),this._ua.set("ha1",this._auth.get("ha1")),n.stale&&(this._staled=!0),this._request=this._request.clone(),this._request.cseq+=1,this._request.setHeader("cseq","".concat(this._request.cseq," ").concat(this._method)),this._request.setHeader(r,this._auth.toString()),this._eventHandlers.onAuthenticated(this._request),this.send()}else this._eventHandlers.onReceiveResponse(t)}}}])&&r(e.prototype,t),n&&r(e,n),s}()},{"./Constants":2,"./DigestAuthentication":5,"./Transactions":22,debug:30}],19:[function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==N(Symbol.iterator)?function(e){return N(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":N(e)})(e)}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r);if(s){var n=o(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function T(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(t))){var n=0,e=function e(){};return{s:e,n:function e(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function e(t){throw t},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s,i=!0,o=!1;return{s:function e(){r=t[Symbol.iterator]()},n:function e(){var t=r.next();return i=t.done,t},e:function e(t){o=!0,s=t},f:function e(){try{i||null==r["return"]||r["return"]()}finally{if(o)throw s}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++){r[n]=e[n]}return r}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}var f=e("sdp-transform"),b=e("./Constants"),S=e("./Utils"),m=e("./NameAddrHeader"),h=e("./Grammar"),d=e("debug")("JsSIP:SIPMessage"),p=function(){function p(e,t,n,r,s,i){if(_(this,p),!e||!t||!n)return null;r=r||{},this.ua=n,this.headers={},this.method=e,this.ruri=t,this.body=i,this.extraHeaders=S.cloneArray(s),r.route_set?this.setHeader("route",r.route_set):n.configuration.use_preloaded_route&&this.setHeader("route","<".concat(n.transport.sip_uri,";lr>")),this.setHeader("via",""),this.setHeader("max-forwards",b.MAX_FORWARDS);var o=r.to_uri||t,a=r.to_tag?{tag:r.to_tag}:null,l=void 0!==r.to_display_name?r.to_display_name:null;this.to=new m(o,l,a),this.setHeader("to",this.to.toString());var u,c=r.from_uri||n.configuration.uri,f={tag:r.from_tag||S.newTag()};u=void 0!==r.from_display_name?r.from_display_name:n.configuration.display_name?n.configuration.display_name:null,this.from=new m(c,u,f),this.setHeader("from",this.from.toString());var h=r.call_id||n.configuration.jssip_id+S.createRandomToken(15);this.call_id=h,this.setHeader("call-id",h);var d=r.cseq||Math.floor(1e4*Math.random());this.cseq=d,this.setHeader("cseq","".concat(d," ").concat(e))}return c(p,[{key:"setHeader",value:function e(t,n){for(var r=new RegExp("^\\s*".concat(t,"\\s*:"),"i"),s=0;s<this.extraHeaders.length;s++){r.test(this.extraHeaders[s])&&this.extraHeaders.splice(s,1)}this.headers[S.headerize(t)]=Array.isArray(n)?n:[n]}},{key:"getHeader",value:function e(t){var n=this.headers[S.headerize(t)];if(n){if(n[0])return n[0]}else{var r,s=new RegExp("^\\s*".concat(t,"\\s*:"),"i"),i=T(this.extraHeaders);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(s.test(o))return o.substring(o.indexOf(":")+1).trim()}}catch(t){i.e(t)}finally{i.f()}}}},{key:"getHeaders",value:function e(t){var n=this.headers[S.headerize(t)],r=[];if(n){var s,i=T(n);try{for(i.s();!(s=i.n()).done;){var o=s.value;r.push(o)}}catch(t){i.e(t)}finally{i.f()}return r}var a,l=new RegExp("^\\s*".concat(t,"\\s*:"),"i"),u=T(this.extraHeaders);try{for(u.s();!(a=u.n()).done;){var c=a.value;l.test(c)&&r.push(c.substring(c.indexOf(":")+1).trim())}}catch(t){u.e(t)}finally{u.f()}return r}},{key:"hasHeader",value:function e(t){if(this.headers[S.headerize(t)])return!0;var n,r=new RegExp("^\\s*".concat(t,"\\s*:"),"i"),s=T(this.extraHeaders);try{for(s.s();!(n=s.n()).done;){var i=n.value;if(r.test(i))return!0}}catch(t){s.e(t)}finally{s.f()}return!1}},{key:"parseSDP",value:function e(t){return!t&&this.sdp?this.sdp:(this.sdp=f.parse(this.body||""),this.sdp)}},{key:"toString",value:function e(){var t="".concat(this.method," ").concat(this.ruri," SIP/2.0\r\n");for(var n in this.headers){if(Object.prototype.hasOwnProperty.call(this.headers,n)){var r,s=T(this.headers[n]);try{for(s.s();!(r=s.n()).done;){var i=r.value;t+="".concat(n,": ").concat(i,"\r\n")}}catch(t){s.e(t)}finally{s.f()}}}var o,a=T(this.extraHeaders);try{for(a.s();!(o=a.n()).done;){var l=o.value;t+="".concat(l.trim(),"\r\n")}}catch(t){a.e(t)}finally{a.f()}var u=[];switch(this.method){case b.REGISTER:u.push("path","gruu");break;case b.INVITE:this.ua.configuration.session_timers&&u.push("timer"),(this.ua.contact.pub_gruu||this.ua.contact.temp_gruu)&&u.push("gruu"),u.push("ice","replaces");break;case b.UPDATE:this.ua.configuration.session_timers&&u.push("timer"),u.push("ice")}u.push("outbound");var c=this.ua.configuration.user_agent||b.USER_AGENT;if(t+="Allow: ".concat(b.ALLOWED_METHODS,"\r\n"),t+="Supported: ".concat(u,"\r\n"),t+="User-Agent: ".concat(c,"\r\n"),this.body){var f=S.str_utf8_length(this.body);t+="Content-Length: ".concat(f,"\r\n\r\n"),t+=this.body}else t+="Content-Length: 0\r\n\r\n";return t}},{key:"clone",value:function e(){var t=new p(this.method,this.ruri,this.ua);return Object.keys(this.headers).forEach(function(e){t.headers[e]=this.headers[e].slice()},this),t.body=this.body,t.extraHeaders=S.cloneArray(this.extraHeaders),t.to=this.to,t.from=this.from,t.call_id=this.call_id,t.cseq=this.cseq,t}}]),p}(),v=function(e){s(a,p);var o=l(a);function a(e,t,n,r,s){var i;return _(this,a),(i=o.call(this,b.INVITE,e,t,n,r,s)).transaction=null,i}return c(a,[{key:"cancel",value:function e(t){this.transaction.cancel(t)}},{key:"clone",value:function e(){var t=new a(this.ruri,this.ua);return Object.keys(this.headers).forEach(function(e){t.headers[e]=this.headers[e].slice()},this),t.body=this.body,t.extraHeaders=S.cloneArray(this.extraHeaders),t.to=this.to,t.from=this.from,t.call_id=this.call_id,t.cseq=this.cseq,t.transaction=this.transaction,t}}]),a}(),g=function(){function e(){_(this,e),this.data=null,this.headers=null,this.method=null,this.via=null,this.via_branch=null,this.call_id=null,this.cseq=null,this.from=null,this.from_tag=null,this.to=null,this.to_tag=null,this.body=null,this.sdp=null}return c(e,[{key:"addHeader",value:function e(t,n){var r={raw:n};t=S.headerize(t),this.headers[t]?this.headers[t].push(r):this.headers[t]=[r]}},{key:"getHeader",value:function e(t){var n=this.headers[S.headerize(t)];if(n)return n[0]?n[0].raw:void 0}},{key:"getHeaders",value:function e(t){var n=this.headers[S.headerize(t)],r=[];if(!n)return[];var s,i=T(n);try{for(i.s();!(s=i.n()).done;){var o=s.value;r.push(o.raw)}}catch(t){i.e(t)}finally{i.f()}return r}},{key:"hasHeader",value:function e(t){return!!this.headers[S.headerize(t)]}},{key:"parseHeader",value:function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(t=S.headerize(t),this.headers[t]){if(!(n>=this.headers[t].length)){var r=this.headers[t][n],s=r.raw;if(r.parsed)return r.parsed;var i=h.parse(s,t.replace(/-/g,"_"));return-1===i?(this.headers[t].splice(n,1),void d('error parsing "'.concat(t,'" header field with value "').concat(s,'"'))):(r.parsed=i,i)}d('not so many "'.concat(t,'" headers present'))}else d('header "'.concat(t,'" not present'))}},{key:"s",value:function e(t,n){return this.parseHeader(t,n)}},{key:"setHeader",value:function e(t,n){var r={raw:n};this.headers[S.headerize(t)]=[r]}},{key:"parseSDP",value:function e(t){return!t&&this.sdp?this.sdp:(this.sdp=f.parse(this.body||""),this.sdp)}},{key:"toString",value:function e(){return this.data}}]),e}(),y=function(e){s(r,g);var n=l(r);function r(e){var t;return _(this,r),(t=n.call(this)).ua=e,t.headers={},t.ruri=null,t.transport=null,t.server_transaction=null,t}return c(r,[{key:"reply",value:function e(t,n,r,s,i,o){var a=[],l=this.getHeader("To");if(n=n||null,!(t=t||null)||t<100||t>699)throw new TypeError("Invalid status_code: ".concat(t));if(n&&"string"!=typeof n&&!(n instanceof String))throw new TypeError("Invalid reason_phrase: ".concat(n));n=n||b.REASON_PHRASE[t]||"",r=S.cloneArray(r);var u="SIP/2.0 ".concat(t," ").concat(n,"\r\n");if(this.method===b.INVITE&&t>100&&t<=200){var c,f=T(this.getHeaders("record-route"));try{for(f.s();!(c=f.n()).done;){var h=c.value;u+="Record-Route: ".concat(h,"\r\n")}}catch(t){f.e(t)}finally{f.f()}}var d,p=T(this.getHeaders("via"));try{for(p.s();!(d=p.n()).done;){var _=d.value;u+="Via: ".concat(_,"\r\n")}}catch(t){p.e(t)}finally{p.f()}!this.to_tag&&t>100?l+=";tag=".concat(S.newTag()):this.to_tag&&!this.s("to").hasParam("tag")&&(l+=";tag=".concat(this.to_tag)),u+="To: ".concat(l,"\r\n"),u+="From: ".concat(this.getHeader("From"),"\r\n"),u+="Call-ID: ".concat(this.call_id,"\r\n"),u+="CSeq: ".concat(this.cseq," ").concat(this.method,"\r\n");var m,v=T(r);try{for(v.s();!(m=v.n()).done;){var g=m.value;u+="".concat(g.trim(),"\r\n")}}catch(t){v.e(t)}finally{v.f()}switch(this.method){case b.INVITE:this.ua.configuration.session_timers&&a.push("timer"),(this.ua.contact.pub_gruu||this.ua.contact.temp_gruu)&&a.push("gruu"),a.push("ice","replaces");break;case b.UPDATE:this.ua.configuration.session_timers&&a.push("timer"),s&&a.push("ice"),a.push("replaces")}if(a.push("outbound"),this.method===b.OPTIONS?(u+="Allow: ".concat(b.ALLOWED_METHODS,"\r\n"),u+="Accept: ".concat(b.ACCEPTED_BODY_TYPES,"\r\n")):405===t?u+="Allow: ".concat(b.ALLOWED_METHODS,"\r\n"):415===t&&(u+="Accept: ".concat(b.ACCEPTED_BODY_TYPES,"\r\n")),u+="Supported: ".concat(a,"\r\n"),s){var y=S.str_utf8_length(s);u+="Content-Type: application/sdp\r\n",u+="Content-Length: ".concat(y,"\r\n\r\n"),u+=s}else u+="Content-Length: ".concat(0,"\r\n\r\n");this.server_transaction.receiveResponse(t,u,i,o)}},{key:"reply_sl",value:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.getHeaders("via");if(!t||t<100||t>699)throw new TypeError("Invalid status_code: ".concat(t));if(n&&"string"!=typeof n&&!(n instanceof String))throw new TypeError("Invalid reason_phrase: ".concat(n));n=n||b.REASON_PHRASE[t]||"";var s,i="SIP/2.0 ".concat(t," ").concat(n,"\r\n"),o=T(r);try{for(o.s();!(s=o.n()).done;){var a=s.value;i+="Via: ".concat(a,"\r\n")}}catch(t){o.e(t)}finally{o.f()}var l=this.getHeader("To");!this.to_tag&&t>100?l+=";tag=".concat(S.newTag()):this.to_tag&&!this.s("to").hasParam("tag")&&(l+=";tag=".concat(this.to_tag)),i+="To: ".concat(l,"\r\n"),i+="From: ".concat(this.getHeader("From"),"\r\n"),i+="Call-ID: ".concat(this.call_id,"\r\n"),i+="CSeq: ".concat(this.cseq," ").concat(this.method,"\r\n"),i+="Content-Length: ".concat(0,"\r\n\r\n"),this.transport.send(i)}}]),r}(),C=function(e){s(n,g);var t=l(n);function n(){var e;return _(this,n),(e=t.call(this)).headers={},e.status_code=null,e.reason_phrase=null,e}return n}();t.exports={OutgoingRequest:p,InitialOutgoingInviteRequest:v,IncomingRequest:y,IncomingResponse:C}},{"./Constants":2,"./Grammar":7,"./NameAddrHeader":10,"./Utils":26,debug:30,"sdp-transform":35}],20:[function(e,t,n){"use strict";var r=e("./Utils"),s=e("./Grammar"),i=e("debug")("JsSIP:ERROR:Socket");i.log=console.warn.bind(console),n.isSocket=function(t){if(Array.isArray(t))return!1;if(void 0===t)return i("undefined JsSIP.Socket instance"),!1;try{if(!r.isString(t.url))throw i("missing or invalid JsSIP.Socket url property"),new Error;if(!r.isString(t.via_transport))throw i("missing or invalid JsSIP.Socket via_transport property"),new Error;if(-1===s.parse(t.sip_uri,"SIP_URI"))throw i("missing or invalid JsSIP.Socket sip_uri property"),new Error}catch(t){return!1}try{["connect","disconnect","send"].forEach(function(e){if(!r.isFunction(t[e]))throw i("missing or invalid JsSIP.Socket method: ".concat(e)),new Error})}catch(t){return!1}return!0}},{"./Grammar":7,"./Utils":26,debug:30}],21:[function(e,t,n){"use strict";var r=500;t.exports={T1:r,T2:4e3,T4:5e3,TIMER_B:32e3,TIMER_D:0,TIMER_F:32e3,TIMER_H:32e3,TIMER_I:0,TIMER_J:0,TIMER_K:0,TIMER_L:32e3,TIMER_M:32e3,PROVISIONAL_RESPONSE_INTERVAL:6e4}},{}],22:[function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==N(Symbol.iterator)?function(e){return N(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":N(e)})(e)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(r){var s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r);if(s){var n=o(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;return h(e)}(this,e)}}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=e("events").EventEmitter,p=e("./Constants"),_=e("./SIPMessage"),m=e("./Timers"),v=e("debug")("JsSIP:NonInviteClientTransaction"),g=e("debug")("JsSIP:InviteClientTransaction"),y=e("debug")("JsSIP:AckClientTransaction"),a=e("debug")("JsSIP:NonInviteServerTransaction"),T=e("debug")("JsSIP:InviteServerTransaction"),b={STATUS_TRYING:1,STATUS_PROCEEDING:2,STATUS_CALLING:3,STATUS_ACCEPTED:4,STATUS_COMPLETED:5,STATUS_TERMINATED:6,STATUS_CONFIRMED:7,NON_INVITE_CLIENT:"nict",NON_INVITE_SERVER:"nist",INVITE_CLIENT:"ict",INVITE_SERVER:"ist"},S=function(e){c(a,d);var o=f(a);function a(e,t,n,r){var s;l(this,a),(s=o.call(this)).type=b.NON_INVITE_CLIENT,s.id="z9hG4bK".concat(Math.floor(1e7*Math.random())),s.ua=e,s.transport=t,s.request=n,s.eventHandlers=r;var i="SIP/2.0/".concat(t.via_transport);return i+=" ".concat(e.configuration.via_host,";branch=").concat(s.id),s.request.setHeader("via",i),s.ua.newTransaction(h(s)),s}return u(a,[{key:"stateChanged",value:function e(t){this.state=t,this.emit("stateChanged")}},{key:"send",value:function e(){var t=this;this.stateChanged(b.STATUS_TRYING),this.F=setTimeout(function(){t.timer_F()},m.TIMER_F),this.transport.send(this.request)||this.onTransportError()}},{key:"onTransportError",value:function e(){v("transport error occurred, deleting transaction ".concat(this.id)),clearTimeout(this.F),clearTimeout(this.K),this.stateChanged(b.STATUS_TERMINATED),this.ua.destroyTransaction(this),this.eventHandlers.onTransportError()}},{key:"timer_F",value:function e(){v("Timer F expired for transaction ".concat(this.id)),this.stateChanged(b.STATUS_TERMINATED),this.ua.destroyTransaction(this),this.eventHandlers.onRequestTimeout()}},{key:"timer_K",value:function e(){this.stateChanged(b.STATUS_TERMINATED),this.ua.destroyTransaction(this)}},{key:"receiveResponse",value:function e(t){var n=this,r=t.status_code;if(r<200)switch(this.state){case b.STATUS_TRYING:case b.STATUS_PROCEEDING:this.stateChanged(b.STATUS_PROCEEDING),this.eventHandlers.onReceiveResponse(t)}else switch(this.state){case b.STATUS_TRYING:case b.STATUS_PROCEEDING:this.stateChanged(b.STATUS_COMPLETED),clearTimeout(this.F),408===r?this.eventHandlers.onRequestTimeout():this.eventHandlers.onReceiveResponse(t),this.K=setTimeout(function(){n.timer_K()},m.TIMER_K);break;case b.STATUS_COMPLETED:}}},{key:"C",get:function e(){return b}}]),a}(),C=function(e){c(a,d);var o=f(a);function a(e,t,n,r){var s;l(this,a),(s=o.call(this)).type=b.INVITE_CLIENT,s.id="z9hG4bK".concat(Math.floor(1e7*Math.random())),s.ua=e,s.transport=t,s.request=n,s.eventHandlers=r,n.transaction=h(s);var i="SIP/2.0/".concat(t.via_transport);return i+=" ".concat(e.configuration.via_host,";branch=").concat(s.id),s.request.setHeader("via",i),s.ua.newTransaction(h(s)),s}return u(a,[{key:"stateChanged",value:function e(t){this.state=t,this.emit("stateChanged")}},{key:"send",value:function e(){var t=this;this.stateChanged(b.STATUS_CALLING),this.B=setTimeout(function(){t.timer_B()},m.TIMER_B),this.transport.send(this.request)||this.onTransportError()}},{key:"onTransportError",value:function e(){clearTimeout(this.B),clearTimeout(this.D),clearTimeout(this.M),this.state!==b.STATUS_ACCEPTED&&(g("transport error occurred, deleting transaction ".concat(this.id)),this.eventHandlers.onTransportError()),this.stateChanged(b.STATUS_TERMINATED),this.ua.destroyTransaction(this)}},{key:"timer_M",value:function e(){g("Timer M expired for transaction ".concat(this.id)),this.state===b.STATUS_ACCEPTED&&(clearTimeout(this.B),this.stateChanged(b.STATUS_TERMINATED),this.ua.destroyTransaction(this))}},{key:"timer_B",value:function e(){g("Timer B expired for transaction ".concat(this.id)),this.state===b.STATUS_CALLING&&(this.stateChanged(b.STATUS_TERMINATED),this.ua.destroyTransaction(this),this.eventHandlers.onRequestTimeout())}},{key:"timer_D",value:function e(){g("Timer D expired for transaction ".concat(this.id)),clearTimeout(this.B),this.stateChanged(b.STATUS_TERMINATED),this.ua.destroyTransaction(this)}},{key:"sendACK",value:function e(t){var n=this,r=new _.OutgoingRequest(p.ACK,this.request.ruri,this.ua,{route_set:this.request.getHeaders("route"),call_id:this.request.getHeader("call-id"),cseq:this.request.cseq});r.setHeader("from",this.request.getHeader("from")),r.setHeader("via",this.request.getHeader("via")),r.setHeader("to",t.getHeader("to")),this.D=setTimeout(function(){n.timer_D()},m.TIMER_D),this.transport.send(r)}},{key:"cancel",value:function e(t){if(this.state===b.STATUS_PROCEEDING){var n=new _.OutgoingRequest(p.CANCEL,this.request.ruri,this.ua,{route_set:this.request.getHeaders("route"),call_id:this.request.getHeader("call-id"),cseq:this.request.cseq});n.setHeader("from",this.request.getHeader("from")),n.setHeader("via",this.request.getHeader("via")),n.setHeader("to",this.request.getHeader("to")),t&&n.setHeader("reason",t),this.transport.send(n)}}},{key:"receiveResponse",value:function e(t){var n=this,r=t.status_code;if(r>=100&&r<=199)switch(this.state){case b.STATUS_CALLING:this.stateChanged(b.STATUS_PROCEEDING),this.eventHandlers.onReceiveResponse(t);break;case b.STATUS_PROCEEDING:this.eventHandlers.onReceiveResponse(t)}else if(r>=200&&r<=299)switch(this.state){case b.STATUS_CALLING:case b.STATUS_PROCEEDING:this.stateChanged(b.STATUS_ACCEPTED),this.M=setTimeout(function(){n.timer_M()},m.TIMER_M),this.eventHandlers.onReceiveResponse(t);break;case b.STATUS_ACCEPTED:this.eventHandlers.onReceiveResponse(t)}else if(r>=300&&r<=699)switch(this.state){case b.STATUS_CALLING:case b.STATUS_PROCEEDING:this.stateChanged(b.STATUS_COMPLETED),this.sendACK(t),this.eventHandlers.onReceiveResponse(t);break;case b.STATUS_COMPLETED:this.sendACK(t)}}},{key:"C",get:function e(){return b}}]),a}(),E=function(e){c(a,d);var o=f(a);function a(e,t,n,r){var s;l(this,a),(s=o.call(this)).id="z9hG4bK".concat(Math.floor(1e7*Math.random())),s.transport=t,s.request=n,s.eventHandlers=r;var i="SIP/2.0/".concat(t.via_transport);return i+=" ".concat(e.configuration.via_host,";branch=").concat(s.id),s.request.setHeader("via",i),s}return u(a,[{key:"send",value:function e(){this.transport.send(this.request)||this.onTransportError()}},{key:"onTransportError",value:function e(){y("transport error occurred for transaction ".concat(this.id)),this.eventHandlers.onTransportError()}},{key:"C",get:function e(){return b}}]),a}(),A=function(e){c(i,d);var s=f(i);function i(e,t,n){var r;return l(this,i),(r=s.call(this)).type=b.NON_INVITE_SERVER,r.id=n.via_branch,r.ua=e,r.transport=t,r.request=n,r.last_response="",n.server_transaction=h(r),r.state=b.STATUS_TRYING,e.newTransaction(h(r)),r}return u(i,[{key:"stateChanged",value:function e(t){this.state=t,this.emit("stateChanged")}},{key:"timer_J",value:function e(){a("Timer J expired for transaction ".concat(this.id)),this.stateChanged(b.STATUS_TERMINATED),this.ua.destroyTransaction(this)}},{key:"onTransportError",value:function e(){this.transportError||(this.transportError=!0,a("transport error occurred, deleting transaction ".concat(this.id)),clearTimeout(this.J),this.stateChanged(b.STATUS_TERMINATED),this.ua.destroyTransaction(this))}},{key:"receiveResponse",value:function e(t,n,r,s){var i=this;if(100===t)switch(this.state){case b.STATUS_TRYING:this.stateChanged(b.STATUS_PROCEEDING),this.transport.send(n)||this.onTransportError();break;case b.STATUS_PROCEEDING:this.last_response=n,this.transport.send(n)?r&&r():(this.onTransportError(),s&&s())}else if(t>=200&&t<=699)switch(this.state){case b.STATUS_TRYING:case b.STATUS_PROCEEDING:this.stateChanged(b.STATUS_COMPLETED),this.last_response=n,this.J=setTimeout(function(){i.timer_J()},m.TIMER_J),this.transport.send(n)?r&&r():(this.onTransportError(),s&&s());break;case b.STATUS_COMPLETED:}}},{key:"C",get:function e(){return b}}]),i}(),w=function(e){c(i,d);var s=f(i);function i(e,t,n){var r;return l(this,i),(r=s.call(this)).type=b.INVITE_SERVER,r.id=n.via_branch,r.ua=e,r.transport=t,r.request=n,r.last_response="",n.server_transaction=h(r),r.state=b.STATUS_PROCEEDING,e.newTransaction(h(r)),r.resendProvisionalTimer=null,n.reply(100),r}return u(i,[{key:"stateChanged",value:function e(t){this.state=t,this.emit("stateChanged")}},{key:"timer_H",value:function e(){T("Timer H expired for transaction ".concat(this.id)),this.state===b.STATUS_COMPLETED&&T("ACK not received, dialog will be terminated"),this.stateChanged(b.STATUS_TERMINATED),this.ua.destroyTransaction(this)}},{key:"timer_I",value:function e(){this.stateChanged(b.STATUS_TERMINATED),this.ua.destroyTransaction(this)}},{key:"timer_L",value:function e(){T("Timer L expired for transaction ".concat(this.id)),this.state===b.STATUS_ACCEPTED&&(this.stateChanged(b.STATUS_TERMINATED),this.ua.destroyTransaction(this))}},{key:"onTransportError",value:function e(){this.transportError||(this.transportError=!0,T("transport error occurred, deleting transaction ".concat(this.id)),null!==this.resendProvisionalTimer&&(clearInterval(this.resendProvisionalTimer),this.resendProvisionalTimer=null),clearTimeout(this.L),clearTimeout(this.H),clearTimeout(this.I),this.stateChanged(b.STATUS_TERMINATED),this.ua.destroyTransaction(this))}},{key:"resend_provisional",value:function e(){this.transport.send(this.last_response)||this.onTransportError()}},{key:"receiveResponse",value:function e(t,n,r,s){var i=this;if(t>=100&&t<=199)switch(this.state){case b.STATUS_PROCEEDING:this.transport.send(n)||this.onTransportError(),this.last_response=n}if(t>100&&t<=199&&this.state===b.STATUS_PROCEEDING)null===this.resendProvisionalTimer&&(this.resendProvisionalTimer=setInterval(function(){i.resend_provisional()},m.PROVISIONAL_RESPONSE_INTERVAL));else if(t>=200&&t<=299)switch(this.state){case b.STATUS_PROCEEDING:this.stateChanged(b.STATUS_ACCEPTED),this.last_response=n,this.L=setTimeout(function(){i.timer_L()},m.TIMER_L),null!==this.resendProvisionalTimer&&(clearInterval(this.resendProvisionalTimer),this.resendProvisionalTimer=null);case b.STATUS_ACCEPTED:this.transport.send(n)?r&&r():(this.onTransportError(),s&&s())}else if(t>=300&&t<=699)switch(this.state){case b.STATUS_PROCEEDING:null!==this.resendProvisionalTimer&&(clearInterval(this.resendProvisionalTimer),this.resendProvisionalTimer=null),this.transport.send(n)?(this.stateChanged(b.STATUS_COMPLETED),this.H=setTimeout(function(){i.timer_H()},m.TIMER_H),r&&r()):(this.onTransportError(),s&&s())}}},{key:"C",get:function e(){return b}}]),i}();t.exports={C:b,NonInviteClientTransaction:S,InviteClientTransaction:C,AckClientTransaction:E,NonInviteServerTransaction:A,InviteServerTransaction:w,checkTransaction:function e(t,n){var r,s=t._transactions;switch(n.method){case p.INVITE:if(r=s.ist[n.via_branch]){switch(r.state){case b.STATUS_PROCEEDING:r.transport.send(r.last_response);break;case b.STATUS_ACCEPTED:}return!0}break;case p.ACK:if(!(r=s.ist[n.via_branch]))return!1;if(r.state===b.STATUS_ACCEPTED)return!1;if(r.state===b.STATUS_COMPLETED)return r.state=b.STATUS_CONFIRMED,r.I=setTimeout(function(){r.timer_I()},m.TIMER_I),!0;break;case p.CANCEL:return(r=s.ist[n.via_branch])?(n.reply_sl(200),r.state!==b.STATUS_PROCEEDING):(n.reply_sl(481),!0);default:if(r=s.nist[n.via_branch]){switch(r.state){case b.STATUS_TRYING:break;case b.STATUS_PROCEEDING:case b.STATUS_COMPLETED:r.transport.send(r.last_response)}return!0}}}}},{"./Constants":2,"./SIPMessage":19,"./Timers":21,debug:30,events:29}],23:[function(e,t,n){"use strict";function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=e("./Socket"),o=e("debug")("JsSIP:Transport"),a=e("debug")("JsSIP:ERROR:Transport"),r=e("./Constants");a.log=console.warn.bind(console);var l={STATUS_CONNECTED:0,STATUS_CONNECTING:1,STATUS_DISCONNECTED:2,SOCKET_STATUS_READY:0,SOCKET_STATUS_ERROR:1,recovery_options:{min_interval:r.CONNECTION_RECOVERY_MIN_INTERVAL,max_interval:r.CONNECTION_RECOVERY_MAX_INTERVAL}};t.exports=function(){function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.recovery_options;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),o("new()"),this.status=l.STATUS_DISCONNECTED,this.socket=null,this.sockets=[],this.recovery_options=t,this.recover_attempts=0,this.recovery_timer=null,this.close_requested=!1,void 0===e)throw new TypeError("Invalid argument. undefined 'sockets' argument");e instanceof Array||(e=[e]),e.forEach(function(e){if(!i.isSocket(e.socket))throw new TypeError("Invalid argument. invalid 'JsSIP.Socket' instance");if(e.weight&&!Number(e.weight))throw new TypeError("Invalid argument. 'weight' attribute is not a number");this.sockets.push({socket:e.socket,weight:e.weight||0,status:l.SOCKET_STATUS_READY})},this),this._getSocket()}var e,t,r;return e=n,(t=[{key:"connect",value:function e(){o("connect()"),this.isConnected()?o("Transport is already connected"):this.isConnecting()?o("Transport is connecting"):(this.close_requested=!1,this.status=l.STATUS_CONNECTING,this.onconnecting({socket:this.socket,attempts:this.recover_attempts}),this.close_requested||(this.socket.onconnect=this._onConnect.bind(this),this.socket.ondisconnect=this._onDisconnect.bind(this),this.socket.ondata=this._onData.bind(this),this.socket.connect()))}},{key:"disconnect",value:function e(){o("close()"),this.close_requested=!0,this.recover_attempts=0,this.status=l.STATUS_DISCONNECTED,null!==this.recovery_timer&&(clearTimeout(this.recovery_timer),this.recovery_timer=null),this.socket.onconnect=function(){},this.socket.ondisconnect=function(){},this.socket.ondata=function(){},this.socket.disconnect(),this.ondisconnect({socket:this.socket,error:!1})}},{key:"send",value:function e(t){if(o("send()"),!this.isConnected())return a("unable to send message, transport is not connected"),!1;var n=t.toString();return o("sending message:\n\n".concat(n,"\n")),this.socket.send(n)}},{key:"isConnected",value:function e(){return this.status===l.STATUS_CONNECTED}},{key:"isConnecting",value:function e(){return this.status===l.STATUS_CONNECTING}},{key:"_reconnect",value:function e(){var t=this;this.recover_attempts+=1;var n=Math.floor(Math.random()*Math.pow(2,this.recover_attempts)+1);n<this.recovery_options.min_interval?n=this.recovery_options.min_interval:n>this.recovery_options.max_interval&&(n=this.recovery_options.max_interval),o("reconnection attempt: ".concat(this.recover_attempts,". next connection attempt in ").concat(n," seconds")),this.recovery_timer=setTimeout(function(){t.close_requested||t.isConnected()||t.isConnecting()||(t._getSocket(),t.connect())},1e3*n)}},{key:"_getSocket",value:function e(){var t=[];if(this.sockets.forEach(function(e){e.status!==l.SOCKET_STATUS_ERROR&&(0===t.length?t.push(e):e.weight>t[0].weight?t=[e]:e.weight===t[0].weight&&t.push(e))}),0===t.length)return this.sockets.forEach(function(e){e.status=l.SOCKET_STATUS_READY}),void this._getSocket();var n=Math.floor(Math.random()*t.length);this.socket=t[n].socket}},{key:"_onConnect",value:function e(){this.recover_attempts=0,this.status=l.STATUS_CONNECTED,null!==this.recovery_timer&&(clearTimeout(this.recovery_timer),this.recovery_timer=null),this.onconnect({socket:this})}},{key:"_onDisconnect",value:function e(t,n,r){this.status=l.STATUS_DISCONNECTED,this.ondisconnect({socket:this.socket,error:t,code:n,reason:r}),this.close_requested||(this.sockets.forEach(function(e){this.socket===e.socket&&(e.status=l.SOCKET_STATUS_ERROR)},this),this._reconnect(t))}},{key:"_onData",value:function e(t){if("\r\n"!==t){if("string"!=typeof t){try{t=String.fromCharCode.apply(null,new Uint8Array(t))}catch(t){return void o("received binary message failed to be converted into string, message discarded")}o("received binary message:\n\n".concat(t,"\n"))}else o("received text message:\n\n".concat(t,"\n"));this.ondata({transport:this,message:t})}else o("received message with CRLF Keep Alive response")}},{key:"via_transport",get:function e(){return this.socket.via_transport}},{key:"url",get:function e(){return this.socket.url}},{key:"sip_uri",get:function e(){return this.socket.sip_uri}}])&&s(e.prototype,t),r&&s(e,r),n}()},{"./Constants":2,"./Socket":20,debug:30}],24:[function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==N(Symbol.iterator)?function(e){return N(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":N(e)})(e)}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(r){var s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=u(r);if(s){var n=u(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;return l(e)}(this,e)}}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var c=e("events").EventEmitter,f=e("./Constants"),h=e("./Registrator"),d=e("./RTCSession"),p=e("./Message"),_=e("./Transactions"),m=e("./Transport"),v=e("./Utils"),g=e("./Exceptions"),y=e("./URI"),T=e("./Parser"),b=e("./SIPMessage"),S=e("./sanityCheck"),C=e("./Config"),E=e("debug")("JsSIP:UA"),A=e("debug")("JsSIP:ERROR:UA");A.log=console.warn.bind(console);var w={STATUS_INIT:0,STATUS_READY:1,STATUS_USER_CLOSED:2,STATUS_NOT_READY:3,CONFIGURATION_ERROR:1,NETWORK_ERROR:2};t.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(r,c);var n=a(r);function r(e){var t;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),E("new() [configuration:%o]",e),(t=n.call(this))._cache={credentials:{}},t._configuration=Object.assign({},C.settings),t._dynConfiguration={},t._dialogs={},t._applicants={},t._sessions={},t._transport=null,t._contact=null,t._status=w.STATUS_INIT,t._error=null,t._transactions={nist:{},nict:{},ist:{},ict:{}},t._data={},t._closeTimer=null,void 0===e)throw new TypeError("Not enough arguments");try{t._loadConfig(e)}catch(e){throw t._status=w.STATUS_NOT_READY,t._error=w.CONFIGURATION_ERROR,e}return t._registrator=new h(l(t)),t}return s(r,null,[{key:"C",get:function e(){return w}}]),s(r,[{key:"start",value:function e(){E("start()"),this._status===w.STATUS_INIT?this._transport.connect():this._status===w.STATUS_USER_CLOSED?(E("restarting UA"),null!==this._closeTimer&&(clearTimeout(this._closeTimer),this._closeTimer=null,this._transport.disconnect()),this._status=w.STATUS_INIT,this._transport.connect()):this._status===w.STATUS_READY?E("UA is in READY status, not restarted"):E("ERROR: connection is down, Auto-Recovery system is trying to reconnect"),this._dynConfiguration.register=this._configuration.register}},{key:"register",value:function e(){E("register()"),this._dynConfiguration.register=!0,this._registrator.register()}},{key:"unregister",value:function e(t){E("unregister()"),this._dynConfiguration.register=!1,this._registrator.unregister(t)}},{key:"registrator",value:function e(){return this._registrator}},{key:"isRegistered",value:function e(){return this._registrator.registered}},{key:"isConnected",value:function e(){return this._transport.isConnected()}},{key:"call",value:function e(t,n){E("call()");var r=new d(this);return r.connect(t,n),r}},{key:"sendMessage",value:function e(t,n,r){E("sendMessage()");var s=new p(this);return s.send(t,n,r),s}},{key:"terminateSessions",value:function e(t){for(var n in E("terminateSessions()"),this._sessions){this._sessions[n].isEnded()||this._sessions[n].terminate(t)}}},{key:"stop",value:function e(){var t=this;if(E("stop()"),this._dynConfiguration={},this._status!==w.STATUS_USER_CLOSED){this._registrator.close();var n=Object.keys(this._sessions).length;for(var r in this._sessions){if(Object.prototype.hasOwnProperty.call(this._sessions,r)){E("closing session ".concat(r));try{this._sessions[r].terminate()}catch(t){}}}for(var s in this._applicants){if(Object.prototype.hasOwnProperty.call(this._applicants,s))try{this._applicants[s].close()}catch(t){}}this._status=w.STATUS_USER_CLOSED,0===Object.keys(this._transactions.nict).length+Object.keys(this._transactions.nist).length+Object.keys(this._transactions.ict).length+Object.keys(this._transactions.ist).length&&0===n?this._transport.disconnect():this._closeTimer=setTimeout(function(){t._closeTimer=null,t._transport.disconnect()},2e3)}else E("UA already closed")}},{key:"normalizeTarget",value:function e(t){return v.normalizeTarget(t,this._configuration.hostport_params)}},{key:"get",value:function e(t){switch(t){case"realm":return this._configuration.realm;case"ha1":return this._configuration.ha1;default:return void A('get() | cannot get "%s" parameter in runtime',t)}}},{key:"set",value:function e(t,n){switch(t){case"password":this._configuration.password=String(n);break;case"realm":this._configuration.realm=String(n);break;case"ha1":this._configuration.ha1=String(n),this._configuration.password=null;break;case"display_name":this._configuration.display_name=n;break;default:return A('set() | cannot set "%s" parameter in runtime',t),!1}return!0}},{key:"newTransaction",value:function e(t){this._transactions[t.type][t.id]=t,this.emit("newTransaction",{transaction:t})}},{key:"destroyTransaction",value:function e(t){delete this._transactions[t.type][t.id],this.emit("transactionDestroyed",{transaction:t})}},{key:"newDialog",value:function e(t){this._dialogs[t.id]=t}},{key:"destroyDialog",value:function e(t){delete this._dialogs[t.id]}},{key:"newMessage",value:function e(t,n){this._applicants[t]=t,this.emit("newMessage",n)}},{key:"destroyMessage",value:function e(t){delete this._applicants[t]}},{key:"newRTCSession",value:function e(t,n){this._sessions[t.id]=t,this.emit("newRTCSession",n)}},{key:"destroyRTCSession",value:function e(t){delete this._sessions[t.id]}},{key:"registered",value:function e(t){this.emit("registered",t)}},{key:"unregistered",value:function e(t){this.emit("unregistered",t)}},{key:"registrationFailed",value:function e(t){this.emit("registrationFailed",t)}},{key:"receiveRequest",value:function e(t){var n=t.method;if(t.ruri.user!==this._configuration.uri.user&&t.ruri.user!==this._contact.uri.user)return E("Request-URI does not point to us"),void(t.method!==f.ACK&&t.reply_sl(404));if(t.ruri.scheme!==f.SIPS){if(!_.checkTransaction(this,t)){if(n===f.INVITE?new _.InviteServerTransaction(this,this._transport,t):n!==f.ACK&&n!==f.CANCEL&&new _.NonInviteServerTransaction(this,this._transport,t),n===f.OPTIONS)t.reply(200);else if(n===f.MESSAGE){if(0===this.listeners("newMessage").length)return void t.reply(405);new p(this).init_incoming(t)}else if(n===f.INVITE&&!t.to_tag&&0===this.listeners("newRTCSession").length)return void t.reply(405);var r,s;if(t.to_tag)(r=this._findDialog(t.call_id,t.from_tag,t.to_tag))?r.receiveRequest(t):n===f.NOTIFY?(s=this._findSession(t))?s.receiveRequest(t):(E("received NOTIFY request for a non existent subscription"),t.reply(481,"Subscription does not exist")):n!==f.ACK&&t.reply(481);else switch(n){case f.INVITE:if(window.RTCPeerConnection){if(t.hasHeader("replaces")){var i=t.replaces;(r=this._findDialog(i.call_id,i.from_tag,i.to_tag))?(s=r.owner).isEnded()?t.reply(603):s.receiveRequest(t):t.reply(481)}else(s=new d(this)).init_incoming(t)}else A("INVITE received but WebRTC is not supported"),t.reply(488);break;case f.BYE:t.reply(481);break;case f.CANCEL:(s=this._findSession(t))?s.receiveRequest(t):E("received CANCEL request for a non existent session");break;case f.ACK:break;case f.NOTIFY:this.emit("sipEvent",{event:t.event,request:t}),t.reply(200);break;default:t.reply(405)}}}else t.reply_sl(416)}},{key:"_findSession",value:function e(t){var n=t.call_id,r=t.from_tag,s=t.to_tag,i=n+r,o=this._sessions[i],a=n+s,l=this._sessions[a];return o||l||null}},{key:"_findDialog",value:function e(t,n,r){var s=t+n+r,i=this._dialogs[s];return i||(s=t+r+n,(i=this._dialogs[s])||null)}},{key:"_loadConfig",value:function e(t){try{C.load(this._configuration,t)}catch(t){throw t}0===this._configuration.display_name&&(this._configuration.display_name="0"),this._configuration.instance_id||(this._configuration.instance_id=v.newUUID()),this._configuration.jssip_id=v.createRandomToken(5);var n=this._configuration.uri.clone();n.user=null,this._configuration.hostport_params=n.toString().replace(/^sip:/i,"");try{this._transport=new m(this._configuration.sockets,{max_interval:this._configuration.connection_recovery_max_interval,min_interval:this._configuration.connection_recovery_min_interval}),this._transport.onconnecting=function(e){this.emit("connecting",e)}.bind(this),this._transport.onconnect=function(e){if(this._status===w.STATUS_USER_CLOSED)return;this._status=w.STATUS_READY,this._error=null,this.emit("connected",e),this._dynConfiguration.register&&this._registrator.register()}.bind(this),this._transport.ondisconnect=function(e){for(var t=0,n=["nict","ict","nist","ist"];t<n.length;t++){var r=n[t];for(var s in this._transactions[r]){Object.prototype.hasOwnProperty.call(this._transactions[r],s)&&this._transactions[r][s].onTransportError()}}this.emit("disconnected",e),this._registrator.onTransportClosed(),this._status!==w.STATUS_USER_CLOSED&&(this._status=w.STATUS_NOT_READY,this._error=w.NETWORK_ERROR)}.bind(this),this._transport.ondata=function(e){var t=e.transport,n=e.message;if(!(n=T.parseMessage(n,this)))return;if(this._status===w.STATUS_USER_CLOSED&&n instanceof b.IncomingRequest)return;if(!S(n,this,t))return;if(n instanceof b.IncomingRequest)n.transport=t,this.receiveRequest(n);else if(n instanceof b.IncomingResponse){var r;switch(n.method){case f.INVITE:(r=this._transactions.ict[n.via_branch])&&r.receiveResponse(n);break;case f.ACK:break;default:(r=this._transactions.nict[n.via_branch])&&r.receiveResponse(n)}}}.bind(this)}catch(t){throw A(t),new g.ConfigurationError("sockets",this._configuration.sockets)}if(delete this._configuration.sockets,this._configuration.authorization_user||(this._configuration.authorization_user=this._configuration.uri.user),!this._configuration.registrar_server){var r=this._configuration.uri.clone();r.user=null,r.clearParams(),r.clearHeaders(),this._configuration.registrar_server=r}this._configuration.no_answer_timeout*=1e3,this._configuration.contact_uri?this._configuration.via_host=this._configuration.contact_uri.host:this._configuration.contact_uri=new y("sip",v.createRandomToken(8),this._configuration.via_host,null,{transport:"ws"}),this._contact={pub_gruu:null,temp_gruu:null,uri:this._configuration.contact_uri,toString:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.anonymous||null,r=t.outbound||null,s="<";return s+=n?this.temp_gruu||"sip:anonymous@anonymous.invalid;transport=ws":this.pub_gruu||this.uri.toString(),!r||(n?this.temp_gruu:this.pub_gruu)||(s+=";ob"),s+=">"}};var s=["password","realm","ha1","display_name","register"];for(var i in this._configuration){Object.prototype.hasOwnProperty.call(this._configuration,i)&&(-1!==s.indexOf(i)?Object.defineProperty(this._configuration,i,{writable:!0,configurable:!1}):Object.defineProperty(this._configuration,i,{writable:!1,configurable:!1}))}for(var o in E("configuration parameters after validation:"),this._configuration){if(Object.prototype.hasOwnProperty.call(C.settings,o))switch(o){case"uri":case"registrar_server":E("- ".concat(o,": ").concat(this._configuration[o]));break;case"password":case"ha1":E("- ".concat(o,": NOT SHOWN"));break;default:E("- ".concat(o,": ").concat(JSON.stringify(this._configuration[o])))}}}},{key:"C",get:function e(){return w}},{key:"status",get:function e(){return this._status}},{key:"contact",get:function e(){return this._contact}},{key:"configuration",get:function e(){return this._configuration}},{key:"transport",get:function e(){return this._transport}}]),r}()},{"./Config":1,"./Constants":2,"./Exceptions":6,"./Message":9,"./Parser":11,"./RTCSession":12,"./Registrator":17,"./SIPMessage":19,"./Transactions":22,"./Transport":23,"./URI":25,"./Utils":26,"./sanityCheck":28,debug:30,events:29}],25:[function(e,t,n){"use strict";function u(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(t))){var n=0,e=function e(){};return{s:e,n:function e(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function e(t){throw t},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s,i=!0,o=!1;return{s:function e(){r=t[Symbol.iterator]()},n:function e(){var t=r.next();return i=t.done,t},e:function e(t){o=!0,s=t},f:function e(){try{i||null==r["return"]||r["return"]()}finally{if(o)throw s}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++){r[n]=e[n]}return r}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}var c=e("./Constants"),f=e("./Utils"),i=e("./Grammar");t.exports=function(){function l(e,t,n,r){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),!n)throw new TypeError('missing or invalid "host" parameter');for(var o in this._parameters={},this._headers={},this._scheme=e||c.SIP,this._user=t,this._host=n,this._port=r,s){Object.prototype.hasOwnProperty.call(s,o)&&this.setParam(o,s[o])}for(var a in i){Object.prototype.hasOwnProperty.call(i,a)&&this.setHeader(a,i[a])}}return s(l,null,[{key:"parse",value:function e(t){return-1!==(t=i.parse(t,"SIP_URI"))?t:void 0}}]),s(l,[{key:"setParam",value:function e(t,n){t&&(this._parameters[t.toLowerCase()]=null==n?null:n.toString())}},{key:"getParam",value:function e(t){if(t)return this._parameters[t.toLowerCase()]}},{key:"hasParam",value:function e(t){if(t)return!!this._parameters.hasOwnProperty(t.toLowerCase())}},{key:"deleteParam",value:function e(t){if(t=t.toLowerCase(),this._parameters.hasOwnProperty(t)){var n=this._parameters[t];return delete this._parameters[t],n}}},{key:"clearParams",value:function e(){this._parameters={}}},{key:"setHeader",value:function e(t,n){this._headers[f.headerize(t)]=Array.isArray(n)?n:[n]}},{key:"getHeader",value:function e(t){if(t)return this._headers[f.headerize(t)]}},{key:"hasHeader",value:function e(t){if(t)return!!this._headers.hasOwnProperty(f.headerize(t))}},{key:"deleteHeader",value:function e(t){if(t=f.headerize(t),this._headers.hasOwnProperty(t)){var n=this._headers[t];return delete this._headers[t],n}}},{key:"clearHeaders",value:function e(){this._headers={}}},{key:"clone",value:function e(){return new l(this._scheme,this._user,this._host,this._port,JSON.parse(JSON.stringify(this._parameters)),JSON.parse(JSON.stringify(this._headers)))}},{key:"toString",value:function e(){var t=[],n="".concat(this._scheme,":");for(var r in this._user&&(n+="".concat(f.escapeUser(this._user),"@")),n+=this._host,(this._port||0===this._port)&&(n+=":".concat(this._port)),this._parameters){Object.prototype.hasOwnProperty.call(this._parameters,r)&&(n+=";".concat(r),null!==this._parameters[r]&&(n+="=".concat(this._parameters[r])))}for(var s in this._headers){if(Object.prototype.hasOwnProperty.call(this._headers,s)){var i,o=u(this._headers[s]);try{for(o.s();!(i=o.n()).done;){var a=i.value;t.push("".concat(s,"=").concat(a))}}catch(t){o.e(t)}finally{o.f()}}}return t.length>0&&(n+="?".concat(t.join("&"))),n}},{key:"toAor",value:function e(t){var n="".concat(this._scheme,":");return this._user&&(n+="".concat(f.escapeUser(this._user),"@")),n+=this._host,t&&(this._port||0===this._port)&&(n+=":".concat(this._port)),n}},{key:"scheme",get:function e(){return this._scheme},set:function e(t){this._scheme=t.toLowerCase()}},{key:"user",get:function e(){return this._user},set:function e(t){this._user=t}},{key:"host",get:function e(){return this._host},set:function e(t){this._host=t.toLowerCase()}},{key:"port",get:function e(){return this._port},set:function e(t){this._port=0===t?t:parseInt(t,10)||null}}]),l}()},{"./Constants":2,"./Grammar":7,"./Utils":26}],26:[function(e,t,n){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==N(Symbol.iterator)?function(e){return N(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":N(e)})(e)}function l(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(t))){var n=0,e=function e(){};return{s:e,n:function e(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function e(t){throw t},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s,i=!0,o=!1;return{s:function e(){r=t[Symbol.iterator]()},n:function e(){var t=r.next();return i=t.done,t},e:function e(t){o=!0,s=t},f:function e(){try{i||null==r["return"]||r["return"]()}finally{if(o)throw s}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++){r[n]=e[n]}return r}var o=e("./Constants"),c=e("./URI"),r=e("./Grammar");n.str_utf8_length=function(e){return unescape(encodeURIComponent(e)).length};var f=n.isFunction=function(e){return void 0!==e&&"[object Function]"===Object.prototype.toString.call(e)};n.isString=function(e){return void 0!==e&&"[object String]"===Object.prototype.toString.call(e)},n.isDecimal=function(e){return!isNaN(e)&&parseFloat(e)===parseInt(e,10)},n.isEmpty=function(e){return null===e||""===e||void 0===e||Array.isArray(e)&&0===e.length||"number"==typeof e&&isNaN(e)},n.hasMethods=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++){n[r-1]=arguments[r]}for(var s=0,i=n;s<i.length;s++){var o=i[s];if(f(e[o]))return!1}return!0};var s=n.createRandomToken=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,r="";for(t=0;t<e;t++){r+=(Math.random()*n|0).toString(n)}return r};n.newTag=function(){return s(10)},n.newUUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},n.hostType=function(e){if(e)return-1!==(e=r.parse(e,"host"))?e.host_type:void 0};var h=n.escapeUser=function(e){return encodeURIComponent(decodeURIComponent(e)).replace(/%3A/gi,":").replace(/%2B/gi,"+").replace(/%3F/gi,"?").replace(/%2F/gi,"/")};n.normalizeTarget=function(e,t){if(e){if(e instanceof c)return e;if("string"==typeof e){var n,r,s,i=e.split("@");switch(i.length){case 1:if(!t)return;n=e,r=t;break;case 2:n=i[0],r=i[1];break;default:n=i.slice(0,i.length-1).join("@"),r=i[i.length-1]}return n=n.replace(/^(sips?|tel):/i,""),/^[-.()]*\+?[0-9\-.()]+$/.test(n)&&(n=n.replace(/[-.()]/g,"")),e="".concat(o.SIP,":").concat(h(n),"@").concat(r),(s=c.parse(e))?s:void 0}}else;},n.headerize=function(e){var t,n={"Call-Id":"Call-ID",Cseq:"CSeq","Www-Authenticate":"WWW-Authenticate"},r=e.toLowerCase().replace(/_/g,"-").split("-"),s="",i=r.length;for(t=0;t<i;t++){0!==t&&(s+="-"),s+=r[t].charAt(0).toUpperCase()+r[t].substring(1)}return n[s]&&(s=n[s]),s},n.sipErrorCause=function(e){for(var t in o.SIP_ERROR_CAUSES){if(-1!==o.SIP_ERROR_CAUSES[t].indexOf(e))return o.causes[t]}return o.causes.SIP_FAILURE_CODE},n.getRandomTestNetIP=function(){return"192.0.2.".concat((e=1,t=254,Math.floor(Math.random()*(t-e+1)+e)));var e,t},n.calculateMD5=function(e){function a(e,t){return e<<t|e>>>32-t}function l(e,t){var n=2147483648&e,r=2147483648&t,s=1073741824&e,i=1073741824&t,o=(1073741823&e)+(1073741823&t);return s&i?2147483648^o^n^r:s|i?1073741824&o?3221225472^o^n^r:1073741824^o^n^r:o^n^r}function t(e,t,n,r,s,i,o){return e=l(e,l(l(function(e,t,n){return e&t|~e&n}(t,n,r),s),o)),l(a(e,i),t)}function n(e,t,n,r,s,i,o){return e=l(e,l(l(function(e,t,n){return e&n|t&~n}(t,n,r),s),o)),l(a(e,i),t)}function r(e,t,n,r,s,i,o){return e=l(e,l(l(function(e,t,n){return e^t^n}(t,n,r),s),o)),l(a(e,i),t)}function s(e,t,n,r,s,i,o){return e=l(e,l(l(function(e,t,n){return t^(e|~n)}(t,n,r),s),o)),l(a(e,i),t)}function i(e){var t,n="",r="";for(t=0;t<=3;t++){n+=(r="0".concat((e>>>8*t&255).toString(16))).substr(r.length-2,2)}return n}var o,u,c,f,h,d,p,_,m,v;for(o=function(e){for(var t,n=e.length,r=n+8,s=16*((r-r%64)/64+1),i=new Array(s-1),o=0,a=0;a<n;){o=a%4*8,i[t=(a-a%4)/4]=i[t]|e.charCodeAt(a)<<o,a++}return o=a%4*8,i[t=(a-a%4)/4]=i[t]|128<<o,i[s-2]=n<<3,i[s-1]=n>>>29,i}(e=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128))}return t}(e)),p=1732584193,_=4023233417,m=2562383102,v=271733878,u=0;u<o.length;u+=16){c=p,f=_,h=m,d=v,p=t(p,_,m,v,o[u+0],7,3614090360),v=t(v,p,_,m,o[u+1],12,3905402710),m=t(m,v,p,_,o[u+2],17,606105819),_=t(_,m,v,p,o[u+3],22,3250441966),p=t(p,_,m,v,o[u+4],7,4118548399),v=t(v,p,_,m,o[u+5],12,1200080426),m=t(m,v,p,_,o[u+6],17,2821735955),_=t(_,m,v,p,o[u+7],22,4249261313),p=t(p,_,m,v,o[u+8],7,1770035416),v=t(v,p,_,m,o[u+9],12,2336552879),m=t(m,v,p,_,o[u+10],17,4294925233),_=t(_,m,v,p,o[u+11],22,2304563134),p=t(p,_,m,v,o[u+12],7,1804603682),v=t(v,p,_,m,o[u+13],12,4254626195),m=t(m,v,p,_,o[u+14],17,2792965006),p=n(p,_=t(_,m,v,p,o[u+15],22,1236535329),m,v,o[u+1],5,4129170786),v=n(v,p,_,m,o[u+6],9,3225465664),m=n(m,v,p,_,o[u+11],14,643717713),_=n(_,m,v,p,o[u+0],20,3921069994),p=n(p,_,m,v,o[u+5],5,3593408605),v=n(v,p,_,m,o[u+10],9,38016083),m=n(m,v,p,_,o[u+15],14,3634488961),_=n(_,m,v,p,o[u+4],20,3889429448),p=n(p,_,m,v,o[u+9],5,568446438),v=n(v,p,_,m,o[u+14],9,3275163606),m=n(m,v,p,_,o[u+3],14,4107603335),_=n(_,m,v,p,o[u+8],20,1163531501),p=n(p,_,m,v,o[u+13],5,2850285829),v=n(v,p,_,m,o[u+2],9,4243563512),m=n(m,v,p,_,o[u+7],14,1735328473),p=r(p,_=n(_,m,v,p,o[u+12],20,2368359562),m,v,o[u+5],4,4294588738),v=r(v,p,_,m,o[u+8],11,2272392833),m=r(m,v,p,_,o[u+11],16,1839030562),_=r(_,m,v,p,o[u+14],23,4259657740),p=r(p,_,m,v,o[u+1],4,2763975236),v=r(v,p,_,m,o[u+4],11,1272893353),m=r(m,v,p,_,o[u+7],16,4139469664),_=r(_,m,v,p,o[u+10],23,3200236656),p=r(p,_,m,v,o[u+13],4,681279174),v=r(v,p,_,m,o[u+0],11,3936430074),m=r(m,v,p,_,o[u+3],16,3572445317),_=r(_,m,v,p,o[u+6],23,76029189),p=r(p,_,m,v,o[u+9],4,3654602809),v=r(v,p,_,m,o[u+12],11,3873151461),m=r(m,v,p,_,o[u+15],16,530742520),p=s(p,_=r(_,m,v,p,o[u+2],23,3299628645),m,v,o[u+0],6,4096336452),v=s(v,p,_,m,o[u+7],10,1126891415),m=s(m,v,p,_,o[u+14],15,2878612391),_=s(_,m,v,p,o[u+5],21,4237533241),p=s(p,_,m,v,o[u+12],6,1700485571),v=s(v,p,_,m,o[u+3],10,2399980690),m=s(m,v,p,_,o[u+10],15,4293915773),_=s(_,m,v,p,o[u+1],21,2240044497),p=s(p,_,m,v,o[u+8],6,1873313359),v=s(v,p,_,m,o[u+15],10,4264355552),m=s(m,v,p,_,o[u+6],15,2734768916),_=s(_,m,v,p,o[u+13],21,1309151649),p=s(p,_,m,v,o[u+4],6,4149444226),v=s(v,p,_,m,o[u+11],10,3174756917),m=s(m,v,p,_,o[u+2],15,718787259),_=s(_,m,v,p,o[u+9],21,3951481745),p=l(p,c),_=l(_,f),m=l(m,h),v=l(v,d)}return(i(p)+i(_)+i(m)+i(v)).toLowerCase()},n.closeMediaStream=function(e){if(e)try{if(e.getTracks){var t,n=l(e.getTracks());try{for(n.s();!(t=n.n()).done;){t.value.stop()}}catch(e){n.e(e)}finally{n.f()}}else{var r,s=l(e.getAudioTracks());try{for(s.s();!(r=s.n()).done;){r.value.stop()}}catch(e){s.e(e)}finally{s.f()}var i,o=l(e.getVideoTracks());try{for(o.s();!(i=o.n()).done;){i.value.stop()}}catch(e){o.e(e)}finally{o.f()}}}catch(t){"function"!=typeof e.stop&&"object"!==a(e.stop)||e.stop()}},n.cloneArray=function(e){return e&&e.slice()||[]},n.cloneObject=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e&&Object.assign({},e)||t}},{"./Constants":2,"./Grammar":7,"./URI":25}],27:[function(e,t,n){"use strict";function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=e("./Grammar"),o=e("debug")("JsSIP:WebSocketInterface"),a=e("debug")("JsSIP:ERROR:WebSocketInterface");a.log=console.warn.bind(console),t.exports=function(){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),o('new() [url:"%s"]',e),this._url=e,this._sip_uri=null,this._via_transport=null,this._ws=null;var t=i.parse(e,"absoluteURI");if(-1===t)throw a("invalid WebSocket URI: ".concat(e)),new TypeError("Invalid argument: ".concat(e));if("wss"!==t.scheme&&"ws"!==t.scheme)throw a("invalid WebSocket URI scheme: ".concat(t.scheme)),new TypeError("Invalid argument: ".concat(e));this._sip_uri="sip:".concat(t.host).concat(t.port?":".concat(t.port):"",";transport=ws"),this._via_transport=t.scheme.toUpperCase()}var e,t,r;return e=n,(t=[{key:"connect",value:function e(){if(o("connect()"),this.isConnected())o("WebSocket ".concat(this._url," is already connected"));else if(this.isConnecting())o("WebSocket ".concat(this._url," is connecting"));else{this._ws&&this.disconnect(),o("connecting to WebSocket ".concat(this._url));try{this._ws=new WebSocket(this._url,"sip"),this._ws.binaryType="arraybuffer",this._ws.onopen=this._onOpen.bind(this),this._ws.onclose=this._onClose.bind(this),this._ws.onmessage=this._onMessage.bind(this),this._ws.onerror=this._onError.bind(this)}catch(e){this._onError(e)}}}},{key:"disconnect",value:function e(){o("disconnect()"),this._ws&&(this._ws.onopen=function(){},this._ws.onclose=function(){},this._ws.onmessage=function(){},this._ws.onerror=function(){},this._ws.close(),this._ws=null)}},{key:"send",value:function e(t){return o("send()"),this.isConnected()?(this._ws.send(t),!0):(a("unable to send message, WebSocket is not open"),!1)}},{key:"isConnected",value:function e(){return this._ws&&this._ws.readyState===this._ws.OPEN}},{key:"isConnecting",value:function e(){return this._ws&&this._ws.readyState===this._ws.CONNECTING}},{key:"_onOpen",value:function e(){o("WebSocket ".concat(this._url," connected")),this.onconnect()}},{key:"_onClose",value:function e(t){var n=t.wasClean,r=t.code,s=t.reason;o("WebSocket ".concat(this._url," closed")),!1===n&&o("WebSocket abrupt disconnection");var i={socket:this,error:!n,code:r,reason:s};this.ondisconnect(i)}},{key:"_onMessage",value:function e(t){var n=t.data;o("received WebSocket message"),this.ondata(n)}},{key:"_onError",value:function e(t){a("WebSocket ".concat(this._url," error: ").concat(t))}},{key:"via_transport",get:function e(){return this._via_transport},set:function e(t){this._via_transport=t.toUpperCase()}},{key:"sip_uri",get:function e(){return this._sip_uri}},{key:"url",get:function e(){return this._url}}])&&s(e.prototype,t),r&&s(e,r),n}()},{"./Grammar":7,debug:30}],28:[function(e,t,n){"use strict";function u(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(t))){var n=0,e=function e(){};return{s:e,n:function e(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function e(t){throw t},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s,i=!0,o=!1;return{s:function e(){r=t[Symbol.iterator]()},n:function e(){var t=r.next();return i=t.done,t},e:function e(t){o=!0,s=t},f:function e(){try{i||null==r["return"]||r["return"]()}finally{if(o)throw s}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++){r[n]=e[n]}return r}var c,f,h,l=e("./Constants"),d=e("./SIPMessage"),p=e("./Utils"),r=e("debug")("JsSIP:sanityCheck"),_=[function(){for(var e=0,t=["from","to","call_id","cseq","via"];e<t.length;e++){var n=t[e];if(!c.hasHeader(n))return r("missing mandatory header field : ".concat(n,", dropping the response")),!1}}],m=[function(){if("sip"!==c.s("to").uri.scheme)return o(416),!1},function(){if(!c.to_tag&&c.call_id.substr(0,5)===f.configuration.jssip_id)return o(482),!1},function(){var e=p.str_utf8_length(c.body),t=c.getHeader("content-length");if(e<t)return o(400),!1},function(){var e,t=c.from_tag,n=c.call_id,r=c.cseq;if(c.to_tag)return;if(c.method===l.INVITE){if(f._transactions.ist[c.via_branch])return!1;for(var s in f._transactions.ist){if(Object.prototype.hasOwnProperty.call(f._transactions.ist,s)&&(e=f._transactions.ist[s]).request.from_tag===t&&e.request.call_id===n&&e.request.cseq===r)return o(482),!1}}else{if(f._transactions.nist[c.via_branch])return!1;for(var i in f._transactions.nist){if(Object.prototype.hasOwnProperty.call(f._transactions.nist,i)&&(e=f._transactions.nist[i]).request.from_tag===t&&e.request.call_id===n&&e.request.cseq===r)return o(482),!1}}}],v=[function(){if(c.getHeaders("via").length>1)return r("more than one Via header field present in the response, dropping the response"),!1},function(){var e=p.str_utf8_length(c.body),t=c.getHeader("content-length");if(e<t)return r("message body length is lower than the value in Content-Length header field, dropping the response"),!1}];function o(e){var t,n,r=c.getHeaders("via"),s="SIP/2.0 ".concat(e," ").concat(l.REASON_PHRASE[e],"\r\n"),i=u(r);try{for(i.s();!(n=i.n()).done;){var o=n.value;s+="Via: ".concat(o,"\r\n")}}catch(e){i.e(e)}finally{i.f()}t=c.getHeader("To"),c.to_tag||(t+=";tag=".concat(p.newTag())),s+="To: ".concat(t,"\r\n"),s+="From: ".concat(c.getHeader("From"),"\r\n"),s+="Call-ID: ".concat(c.call_id,"\r\n"),s+="CSeq: ".concat(c.cseq," ").concat(c.method,"\r\n"),s+="\r\n",h.send(s)}t.exports=function(e,t,n){c=e,f=t,h=n;var r,s=u(_);try{for(s.s();!(r=s.n()).done;){if(!1===(0,r.value)())return!1}}catch(e){s.e(e)}finally{s.f()}if(c instanceof d.IncomingRequest){var i,o=u(m);try{for(o.s();!(i=o.n()).done;){if(!1===(0,i.value)())return!1}}catch(e){o.e(e)}finally{o.f()}}else if(c instanceof d.IncomingResponse){var a,l=u(v);try{for(l.s();!(a=l.n()).done;){if(!1===(0,a.value)())return!1}}catch(e){l.e(e)}finally{l.f()}}return!0}},{"./Constants":2,"./SIPMessage":19,"./Utils":26,debug:30}],29:[function(e,t,n){var l=Object.create||function(e){var t=function e(){};return t.prototype=e,new t},o=Object.keys||function(e){var t=[];for(var n in e){Object.prototype.hasOwnProperty.call(e,n)&&t.push(n)}return n},i=Function.prototype.bind||function(e){var t=this;return function(){return t.apply(e,arguments)}};function r(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=l(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0;var s,a=10;try{var u={};Object.defineProperty&&Object.defineProperty(u,"x",{value:0}),s=0===u.x}catch(e){s=!1}function c(e){return void 0===e._maxListeners?r.defaultMaxListeners:e._maxListeners}function f(e,t,n,r){var s,i,o;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((i=e._events)?(i.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),i=e._events),o=i[t]):(i=e._events=l(null),e._eventsCount=0),o){if("function"==typeof o?o=i[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),!o.warned&&(s=c(e))&&s>0&&o.length>s){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+' "'+String(t)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=o.length,"object"==(typeof console==="undefined"?"undefined":N(console))&&console.warn&&console.warn("%s: %s",a.name,a.message)}}else o=i[t]=n,++e._eventsCount;return e}function h(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var e=new Array(arguments.length),t=0;t<e.length;++t){e[t]=arguments[t]}this.listener.apply(this.target,e)}}function d(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},s=i.call(h,r);return s.listener=n,r.wrapFn=s,s}function p(e,t,n){var r=e._events;if(!r)return[];var s=r[t];return s?"function"==typeof s?n?[s.listener||s]:[s]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n){t[n]=e[n].listener||e[n]}return t}(s):m(s,s.length):[]}function _(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function m(e,t){for(var n=new Array(t),r=0;r<t;++r){n[r]=e[r]}return n}s?Object.defineProperty(r,"defaultMaxListeners",{enumerable:!0,get:function e(){return a},set:function e(t){if("number"!=typeof t||t<0||t!=t)throw new TypeError('"defaultMaxListeners" must be a positive number');a=t}}):r.defaultMaxListeners=a,r.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},r.prototype.getMaxListeners=function(){return c(this)},r.prototype.emit=function(e){var t,n,r,s,i,o,a="error"===e;if(o=this._events)a=a&&null==o.error;else if(!a)return!1;if(a){if(arguments.length>1&&(t=arguments[1]),t instanceof Error)throw t;var l=new Error('Unhandled "error" event. ('+t+")");throw l.context=t,l}if(!(n=o[e]))return!1;var u="function"==typeof n;switch(r=arguments.length){case 1:!function(e,t,n){if(t)e.call(n);else for(var r=e.length,s=m(e,r),i=0;i<r;++i){s[i].call(n)}}(n,u,this);break;case 2:!function(e,t,n,r){if(t)e.call(n,r);else for(var s=e.length,i=m(e,s),o=0;o<s;++o){i[o].call(n,r)}}(n,u,this,arguments[1]);break;case 3:!function(e,t,n,r,s){if(t)e.call(n,r,s);else for(var i=e.length,o=m(e,i),a=0;a<i;++a){o[a].call(n,r,s)}}(n,u,this,arguments[1],arguments[2]);break;case 4:!function(e,t,n,r,s,i){if(t)e.call(n,r,s,i);else for(var o=e.length,a=m(e,o),l=0;l<o;++l){a[l].call(n,r,s,i)}}(n,u,this,arguments[1],arguments[2],arguments[3]);break;default:for(s=new Array(r-1),i=1;i<r;i++){s[i-1]=arguments[i]}!function(e,t,n,r){if(t)e.apply(n,r);else for(var s=e.length,i=m(e,s),o=0;o<s;++o){i[o].apply(n,r)}}(n,u,this,s)}return!0},r.prototype.addListener=function(e,t){return f(this,e,t,!1)},r.prototype.on=r.prototype.addListener,r.prototype.prependListener=function(e,t){return f(this,e,t,!0)},r.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,d(this,e,t)),this},r.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,d(this,e,t)),this},r.prototype.removeListener=function(e,t){var n,r,s,i,o;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=l(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(s=-1,i=n.length-1;i>=0;i--){if(n[i]===t||n[i].listener===t){o=n[i].listener,s=i;break}}if(s<0)return this;0===s?n.shift():function(e,t){for(var n=t,r=n+1,s=e.length;r<s;n+=1,r+=1){e[n]=e[r]}e.pop()}(n,s),1===n.length&&(r[e]=n[0]),r.removeListener&&this.emit("removeListener",e,o||t)}return this},r.prototype.removeAllListeners=function(e){var t,n,r;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=l(null),this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=l(null):delete n[e]),this;if(0===arguments.length){var s,i=o(n);for(r=0;r<i.length;++r){"removeListener"!==(s=i[r])&&this.removeAllListeners(s)}return this.removeAllListeners("removeListener"),this._events=l(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)for(r=t.length-1;r>=0;r--){this.removeListener(e,t[r])}return this},r.prototype.listeners=function(e){return p(this,e,!0)},r.prototype.rawListeners=function(e){return p(this,e,!1)},r.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):_.call(e,t)},r.prototype.listenerCount=_,r.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],30:[function(n,s,r){(function(t){r.log=function(){var e;return"object"==(typeof console==="undefined"?"undefined":N(console))&&console.log&&(e=console).log.apply(e,arguments)},r.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+s.exports.humanize(this.diff),!this.useColors)return;var t="color: "+this.color;e.splice(1,0,t,"color: inherit");var n=0,r=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(n++,"%c"===e&&(r=n))}),e.splice(r,0,t)},r.save=function(e){try{e?r.storage.setItem("debug",e):r.storage.removeItem("debug")}catch(e){}},r.load=function(){var e;try{e=r.storage.getItem("debug")}catch(e){}!e&&void 0!==t&&"env"in t&&(e=t.env.DEBUG);return e},r.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},r.storage=function(){try{return localStorage}catch(e){}}(),r.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],s.exports=n("./common")(r);var e=s.exports.formatters;e.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(this,n("_process"))},{"./common":31,_process:33}],31:[function(e,t,n){t.exports=function(t){function n(e){var t=0;for(var n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t|=0}return u.colors[Math.abs(t)%u.colors.length]}function u(e){var a;function l(){for(var e=arguments.length,s=new Array(e),t=0;t<e;t++){s[t]=arguments[t]}if(!l.enabled)return;var i=l,n=Number(new Date),r=n-(a||n);i.diff=r,i.prev=a,i.curr=n,a=n,s[0]=u.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var o=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,function(e,t){if("%%"===e)return e;o++;var n=u.formatters[t];if("function"==typeof n){var r=s[o];e=n.call(i,r),s.splice(o,1),o--}return e}),u.formatArgs.call(i,s),(i.log||u.log).apply(i,s)}return l.namespace=e,l.enabled=u.enabled(e),l.useColors=u.useColors(),l.color=n(e),l.destroy=r,l.extend=s,"function"==typeof u.init&&u.init(l),u.instances.push(l),l}function r(){var e=u.instances.indexOf(this);return-1!==e&&(u.instances.splice(e,1),!0)}function s(e,t){var n=u(this.namespace+(void 0===t?":":t)+e);return n.log=this.log,n}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return u.debug=u,u["default"]=u,u.coerce=function(e){return e instanceof Error?e.stack||e.message:e},u.disable=function(){var e=[].concat(o(u.names.map(i)),o(u.skips.map(i).map(function(e){return"-"+e}))).join(",");return u.enable(""),e},u.enable=function(e){var t;u.save(e),u.names=[],u.skips=[];var n=("string"==typeof e?e:"").split(/[\s,]+/),r=n.length;for(t=0;t<r;t++){n[t]&&("-"===(e=n[t].replace(/\*/g,".*?"))[0]?u.skips.push(new RegExp("^"+e.substr(1)+"$")):u.names.push(new RegExp("^"+e+"$")))}for(t=0;t<u.instances.length;t++){var s=u.instances[t];s.enabled=u.enabled(s.namespace)}},u.enabled=function(e){if("*"===e[e.length-1])return!0;var t,n;for(t=0,n=u.skips.length;t<n;t++){if(u.skips[t].test(e))return!1}for(t=0,n=u.names.length;t<n;t++){if(u.names[t].test(e))return!0}return!1},u.humanize=e("ms"),Object.keys(t).forEach(function(e){u[e]=t[e]}),u.instances=[],u.names=[],u.skips=[],u.formatters={},u.selectColor=n,u.enable(u.load()),u}},{ms:32}],32:[function(e,t,n){var r=1e3,s=60*r,i=60*s,o=24*i,a=7*o,l=365.25*o;function u(e,t,n,r){var s=t>=1.5*n;return Math.round(e/n)+" "+r+(s?"s":"")}t.exports=function(e,t){t=t||{};var n=N(e);if("string"===n&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*l;case"weeks":case"week":case"w":return n*a;case"days":case"day":case"d":return n*o;case"hours":case"hour":case"hrs":case"hr":case"h":return n*i;case"minutes":case"minute":case"mins":case"min":case"m":return n*s;case"seconds":case"second":case"secs":case"sec":case"s":return n*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}(e);if("number"===n&&isFinite(e))return t["long"]?function(e){var t=Math.abs(e);if(t>=o)return u(e,t,o,"day");if(t>=i)return u(e,t,i,"hour");if(t>=s)return u(e,t,s,"minute");if(t>=r)return u(e,t,r,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=o)return Math.round(e/o)+"d";if(t>=i)return Math.round(e/i)+"h";if(t>=s)return Math.round(e/s)+"m";if(t>=r)return Math.round(e/r)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},{}],33:[function(e,t,n){var r,s,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function l(t){if(r===setTimeout)return setTimeout(t,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(e){r=o}try{s="function"==typeof clearTimeout?clearTimeout:a}catch(e){s=a}}();var u,c=[],f=!1,h=-1;function d(){f&&u&&(f=!1,u.length?c=u.concat(c):h=-1,c.length&&p())}function p(){if(!f){var e=l(d);f=!0;for(var t=c.length;t;){for(u=c,c=[];++h<t;){u&&u[h].run()}h=-1,t=c.length}u=null,f=!1,function(t){if(s===clearTimeout)return clearTimeout(t);if((s===a||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(t);try{s(t)}catch(e){try{return s.call(null,t)}catch(e){return s.call(this,t)}}}(e)}}function _(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++){t[n-1]=arguments[n]}c.push(new _(e,t)),1!==c.length||f||l(p)},_.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],34:[function(e,t,n){var r=t.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function e(t){return t.encoding?"rtpmap:%d %s/%s/%s":t.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function e(t){return null!=t.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function e(t){return null!=t.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function e(t){return"extmap:%d"+(t.direction?"/%s":"%v")+(t["encrypt-uri"]?" %s":"%v")+" %s"+(t.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function e(t){return null!=t.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function e(t){var n="candidate:%s %d %s %d %s %d typ %s";return n+=null!=t.raddr?" raddr %s rport %d":"%v%v",n+=null!=t.tcptype?" tcptype %s":"%v",null!=t.generation&&(n+=" generation %d"),n+=null!=t["network-id"]?" network-id %d":"%v",n+=null!=t["network-cost"]?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function e(t){var n="ssrc:%d";return null!=t.attribute&&(n+=" %s",null!=t.value&&(n+=":%s")),n}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function e(t){return null!=t.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function e(t){return t.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function e(t){return"imageattr:%s %s %s"+(t.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function e(t){return"simulcast:%s %s"+(t.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function e(t){return"ts-refclk:%s"+(null!=t.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function e(t){var n="mediaclk:";return n+=null!=t.id?"id=%s %s":"%v%s",n+=null!=t.mediaClockValue?"=%s":"",n+=null!=t.rateNumerator?" rate=%s":"",n+=null!=t.rateDenominator?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(r).forEach(function(e){r[e].forEach(function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")})})},{}],35:[function(e,t,n){var r=e("./parser"),s=e("./writer");n.write=s,n.parse=r.parse,n.parseParams=r.parseParams,n.parseFmtpConfig=r.parseFmtpConfig,n.parsePayloads=r.parsePayloads,n.parseRemoteCandidates=r.parseRemoteCandidates,n.parseImageAttributes=r.parseImageAttributes,n.parseSimulcastStreamList=r.parseSimulcastStreamList},{"./parser":36,"./writer":37}],36:[function(e,t,n){var i=function e(t){return String(Number(t))===t?Number(t):t},a=function e(t,n,r){var e=t.name&&t.names;t.push&&!n[t.push]?n[t.push]=[]:e&&!n[t.name]&&(n[t.name]={});var s=t.push?{}:e?n[t.name]:n;!function(e,t,n,r){if(r&&!n)t[r]=i(e[1]);else for(var s=0;s<n.length;s+=1){null!=e[s+1]&&(t[n[s]]=i(e[s+1]))}}(r.match(t.reg),s,t.names,t.name),t.push&&n[t.push].push(s)},l=e("./grammar"),r=RegExp.prototype.test.bind(/^([a-z])=(.*)/);n.parse=function(e){var t={},i=[],o=t;return e.split(/(\r\n|\r|\n)/).filter(r).forEach(function(e){var t=e[0],n=e.slice(2);"m"===t&&(i.push({rtp:[],fmtp:[]}),o=i[i.length-1]);for(var r=0;r<(l[t]||[]).length;r+=1){var s=l[t][r];if(s.reg.test(n))return a(s,o,n)}}),t.media=i,t};var s=function e(t,n){var r=n.split(/=(.+)/,2);return 2===r.length?t[r[0]]=i(r[1]):1===r.length&&n.length>1&&(t[r[0]]=void 0),t};n.parseParams=function(e){return e.split(/;\s?/).reduce(s,{})},n.parseFmtpConfig=n.parseParams,n.parsePayloads=function(e){return e.toString().split(" ").map(Number)},n.parseRemoteCandidates=function(e){for(var t=[],n=e.split(" ").map(i),r=0;r<n.length;r+=3){t.push({component:n[r],ip:n[r+1],port:n[r+2]})}return t},n.parseImageAttributes=function(e){return e.split(" ").map(function(e){return e.substring(1,e.length-1).split(",").reduce(s,{})})},n.parseSimulcastStreamList=function(e){return e.split(";").map(function(e){return e.split(",").map(function(e){var t,n=!1;return"~"!==e[0]?t=i(e):(t=i(e.substring(1,e.length)),n=!0),{scid:t,paused:n}})})}},{"./grammar":34}],37:[function(e,t,n){var i=e("./grammar"),o=/%[sdv%]/g,a=function e(t,n,r){var s=[t+"="+(n.format instanceof Function?n.format(n.push?r:r[n.name]):n.format)];if(n.names)for(var e=0;e<n.names.length;e+=1){var i=n.names[e];n.name?s.push(r[n.name][i]):s.push(r[n.names[e]])}else s.push(r[n.name]);return function(e){var n=1,r=arguments,s=r.length;return e.replace(o,function(e){if(n>=s)return e;var t=r[n];switch(n+=1,e){case"%%":return"%";case"%s":return String(t);case"%d":return Number(t);case"%v":return""}})}.apply(null,s)},l=["v","o","s","i","u","e","p","c","b","t","r","z","a"],u=["i","c","b","a"];t.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach(function(e){null==e.payloads&&(e.payloads="")});var n=t.outerOrder||l,r=t.innerOrder||u,s=[];return n.forEach(function(n){i[n].forEach(function(t){t.name in e&&null!=e[t.name]?s.push(a(n,t,e)):t.push in e&&null!=e[t.push]&&e[t.push].forEach(function(e){s.push(a(n,t,e))})})}),e.media.forEach(function(e){s.push(a("m",i.m[0],e)),r.forEach(function(n){i[n].forEach(function(t){t.name in e&&null!=e[t.name]?s.push(a(n,t,e)):t.push in e&&null!=e[t.push]&&e[t.push].forEach(function(e){s.push(a(n,t,e))})})})}),s.join("\r\n")+"\r\n"}},{"./grammar":34}],38:[function(e,t,n){t.exports={name:"jssip",title:"JsSIP",description:"the Javascript SIP library",version:"3.5.3",homepage:"https://jssip.net",author:"José Luis Millán <jmillan@aliax.net> (https://github.com/jmillan)",contributors:["Iñaki Baz Castillo <ibc@aliax.net> (https://github.com/ibc)"],types:"lib/JsSIP.d.ts",main:"lib-es5/JsSIP.js",keywords:["sip","websocket","webrtc","node","browser","library"],license:"MIT",repository:{type:"git",url:"https://github.com/versatica/JsSIP.git"},bugs:{url:"https://github.com/versatica/JsSIP/issues"},dependencies:{"@types/debug":"^4.1.5","@types/node":"^14.0.6",debug:"^4.1.1",events:"^3.1.0","sdp-transform":"^2.14.0"},devDependencies:{"@babel/core":"^7.9.6","@babel/preset-env":"^7.9.6","ansi-colors":"^3.2.4",browserify:"^16.5.1",eslint:"^5.16.0","fancy-log":"^1.3.3",gulp:"^4.0.2","gulp-babel":"^8.0.0","gulp-eslint":"^5.0.0","gulp-expect-file":"^1.0.2","gulp-header":"^2.0.9","gulp-nodeunit-runner":"^0.2.2","gulp-plumber":"^1.2.1","gulp-rename":"^1.4.0","gulp-uglify-es":"^1.0.4",pegjs:"^0.7.0","vinyl-buffer":"^1.0.1","vinyl-source-stream":"^2.0.0"},scripts:{lint:"gulp lint",test:"gulp test",prepublishOnly:"gulp babel"}}},{}]},{},[8])(8)})},function(e,t,n){e.exports=n(4)},function(e,t,n){"use strict";var r=n(5);var s=n(6);var i=n(7);var o=n(25);var a=n(13);function l(e){var t=new i(e);var n=s(i.prototype.request,t);r.extend(n,i.prototype,t);r.extend(n,t);return n}var u=l(a);u.Axios=i;u.create=function e(t){return l(o(u.defaults,t))};u.Cancel=n(26);u.CancelToken=n(27);u.isCancel=n(12);u.all=function e(t){return Promise.all(t)};u.spread=n(28);e.exports=u;e.exports.default=u},function(e,t,n){"use strict";var i=n(6);var r=Object.prototype.toString;function o(e){return r.call(e)==="[object Array]"}function s(e){return typeof e==="undefined"}function a(e){return e!==null&&!s(e)&&e.constructor!==null&&!s(e.constructor)&&typeof e.constructor.isBuffer==="function"&&e.constructor.isBuffer(e)}function l(e){return r.call(e)==="[object ArrayBuffer]"}function u(e){return typeof FormData!=="undefined"&&e instanceof FormData}function c(e){var t;if(typeof ArrayBuffer!=="undefined"&&ArrayBuffer.isView){t=ArrayBuffer.isView(e)}else{t=e&&e.buffer&&e.buffer instanceof ArrayBuffer}return t}function f(e){return typeof e==="string"}function h(e){return typeof e==="number"}function d(e){return e!==null&&typeof e==="object"}function p(e){return r.call(e)==="[object Date]"}function _(e){return r.call(e)==="[object File]"}function m(e){return r.call(e)==="[object Blob]"}function v(e){return r.call(e)==="[object Function]"}function g(e){return d(e)&&v(e.pipe)}function y(e){return typeof URLSearchParams!=="undefined"&&e instanceof URLSearchParams}function T(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}function b(){if(typeof navigator!=="undefined"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")){return false}return typeof window!=="undefined"&&typeof document!=="undefined"}function S(e,t){if(e===null||typeof e==="undefined"){return}if(typeof e!=="object"){e=[e]}if(o(e)){for(var n=0,r=e.length;n<r;n++){t.call(null,e[n],n,e)}}else{for(var s in e){if(Object.prototype.hasOwnProperty.call(e,s)){t.call(null,e[s],s,e)}}}}function C(){var n={};function e(e,t){if(typeof n[t]==="object"&&typeof e==="object"){n[t]=C(n[t],e)}else{n[t]=e}}for(var t=0,r=arguments.length;t<r;t++){S(arguments[t],e)}return n}function E(){var n={};function e(e,t){if(typeof n[t]==="object"&&typeof e==="object"){n[t]=E(n[t],e)}else if(typeof e==="object"){n[t]=E({},e)}else{n[t]=e}}for(var t=0,r=arguments.length;t<r;t++){S(arguments[t],e)}return n}function A(r,e,s){S(e,function e(t,n){if(s&&typeof t==="function"){r[n]=i(t,s)}else{r[n]=t}});return r}e.exports={isArray:o,isArrayBuffer:l,isBuffer:a,isFormData:u,isArrayBufferView:c,isString:f,isNumber:h,isObject:d,isUndefined:s,isDate:p,isFile:_,isBlob:m,isFunction:v,isStream:g,isURLSearchParams:y,isStandardBrowserEnv:b,forEach:S,merge:C,deepMerge:E,extend:A,trim:T}},function(e,t,n){"use strict";e.exports=function e(r,s){return function e(){var t=new Array(arguments.length);for(var n=0;n<t.length;n++){t[n]=arguments[n]}return r.apply(s,t)}}},function(e,t,n){"use strict";var s=n(5);var r=n(8);var i=n(9);var o=n(10);var a=n(25);function l(e){this.defaults=e;this.interceptors={request:new i,response:new i}}l.prototype.request=function e(t){if(typeof t==="string"){t=arguments[1]||{};t.url=arguments[0]}else{t=t||{}}t=a(this.defaults,t);if(t.method){t.method=t.method.toLowerCase()}else if(this.defaults.method){t.method=this.defaults.method.toLowerCase()}else{t.method="get"}var n=[o,undefined];var r=Promise.resolve(t);this.interceptors.request.forEach(function e(t){n.unshift(t.fulfilled,t.rejected)});this.interceptors.response.forEach(function e(t){n.push(t.fulfilled,t.rejected)});while(n.length){r=r.then(n.shift(),n.shift())}return r};l.prototype.getUri=function e(t){t=a(this.defaults,t);return r(t.url,t.params,t.paramsSerializer).replace(/^\?/,"")};s.forEach(["delete","get","head","options"],function e(n){l.prototype[n]=function(e,t){return this.request(s.merge(t||{},{method:n,url:e}))}});s.forEach(["post","put","patch"],function e(r){l.prototype[r]=function(e,t,n){return this.request(s.merge(n||{},{method:r,url:e,data:t}))}});e.exports=l},function(e,t,n){"use strict";var a=n(5);function l(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function e(t,n,r){if(!n){return t}var s;if(r){s=r(n)}else if(a.isURLSearchParams(n)){s=n.toString()}else{var i=[];a.forEach(n,function e(t,n){if(t===null||typeof t==="undefined"){return}if(a.isArray(t)){n=n+"[]"}else{t=[t]}a.forEach(t,function e(t){if(a.isDate(t)){t=t.toISOString()}else if(a.isObject(t)){t=JSON.stringify(t)}i.push(l(n)+"="+l(t))})});s=i.join("&")}if(s){var o=t.indexOf("#");if(o!==-1){t=t.slice(0,o)}t+=(t.indexOf("?")===-1?"?":"&")+s}return t}},function(e,t,n){"use strict";var r=n(5);function s(){this.handlers=[]}s.prototype.use=function e(t,n){this.handlers.push({fulfilled:t,rejected:n});return this.handlers.length-1};s.prototype.eject=function e(t){if(this.handlers[t]){this.handlers[t]=null}};s.prototype.forEach=function e(n){r.forEach(this.handlers,function e(t){if(t!==null){n(t)}})};e.exports=s},function(e,t,n){"use strict";var r=n(5);var s=n(11);var i=n(12);var o=n(13);function a(e){if(e.cancelToken){e.cancelToken.throwIfRequested()}}e.exports=function e(n){a(n);n.headers=n.headers||{};n.data=s(n.data,n.headers,n.transformRequest);n.headers=r.merge(n.headers.common||{},n.headers[n.method]||{},n.headers);r.forEach(["delete","get","head","post","put","patch","common"],function e(t){delete n.headers[t]});var t=n.adapter||o.adapter;return t(n).then(function e(t){a(n);t.data=s(t.data,t.headers,n.transformResponse);return t},function e(t){if(!i(t)){a(n);if(t&&t.response){t.response.data=s(t.response.data,t.response.headers,n.transformResponse)}}return Promise.reject(t)})}},function(e,t,n){"use strict";var s=n(5);e.exports=function e(n,r,t){s.forEach(t,function e(t){n=t(n,r)});return n}},function(e,t,n){"use strict";e.exports=function e(t){return!!(t&&t.__CANCEL__)}},function(e,t,n){"use strict";var r=n(5);var s=n(14);var i={"Content-Type":"application/x-www-form-urlencoded"};function o(e,t){if(!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])){e["Content-Type"]=t}}function a(){var e;if(typeof XMLHttpRequest!=="undefined"){e=n(15)}else if(typeof process!=="undefined"&&Object.prototype.toString.call(process)==="[object process]"){e=n(15)}return e}var l={adapter:a(),transformRequest:[function e(t,n){s(n,"Accept");s(n,"Content-Type");if(r.isFormData(t)||r.isArrayBuffer(t)||r.isBuffer(t)||r.isStream(t)||r.isFile(t)||r.isBlob(t)){return t}if(r.isArrayBufferView(t)){return t.buffer}if(r.isURLSearchParams(t)){o(n,"application/x-www-form-urlencoded;charset=utf-8");return t.toString()}if(r.isObject(t)){o(n,"application/json;charset=utf-8");return JSON.stringify(t)}return t}],transformResponse:[function e(t){if(typeof t==="string"){try{t=JSON.parse(t)}catch(e){}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function e(t){return t>=200&&t<300}};l.headers={common:{Accept:"application/json, text/plain, */*"}};r.forEach(["delete","get","head"],function e(t){l.headers[t]={}});r.forEach(["post","put","patch"],function e(t){l.headers[t]=r.merge(i)});e.exports=l},function(e,t,n){"use strict";var i=n(5);e.exports=function e(r,s){i.forEach(r,function e(t,n){if(n!==s&&n.toUpperCase()===s.toUpperCase()){r[s]=t;delete r[n]}})}},function(e,t,h){"use strict";var d=h(5);var p=h(16);var _=h(8);var m=h(19);var v=h(22);var g=h(23);var y=h(17);e.exports=function e(f){return new Promise(function e(s,i){var r=f.data;var o=f.headers;if(d.isFormData(r)){delete o["Content-Type"]}var a=new XMLHttpRequest;if(f.auth){var t=f.auth.username||"";var n=f.auth.password||"";o.Authorization="Basic "+btoa(t+":"+n)}var l=m(f.baseURL,f.url);a.open(f.method.toUpperCase(),_(l,f.params,f.paramsSerializer),true);a.timeout=f.timeout;a.onreadystatechange=function e(){if(!a||a.readyState!==4){return}if(a.status===0&&!(a.responseURL&&a.responseURL.indexOf("file:")===0)){return}var t="getAllResponseHeaders"in a?v(a.getAllResponseHeaders()):null;var n=!f.responseType||f.responseType==="text"?a.responseText:a.response;var r={data:n,status:a.status,statusText:a.statusText,headers:t,config:f,request:a};p(s,i,r);a=null};a.onabort=function e(){if(!a){return}i(y("Request aborted",f,"ECONNABORTED",a));a=null};a.onerror=function e(){i(y("Network Error",f,null,a));a=null};a.ontimeout=function e(){var t="timeout of "+f.timeout+"ms exceeded";if(f.timeoutErrorMessage){t=f.timeoutErrorMessage}i(y(t,f,"ECONNABORTED",a));a=null};if(d.isStandardBrowserEnv()){var u=h(24);var c=(f.withCredentials||g(l))&&f.xsrfCookieName?u.read(f.xsrfCookieName):undefined;if(c){o[f.xsrfHeaderName]=c}}if("setRequestHeader"in a){d.forEach(o,function e(t,n){if(typeof r==="undefined"&&n.toLowerCase()==="content-type"){delete o[n]}else{a.setRequestHeader(n,t)}})}if(!d.isUndefined(f.withCredentials)){a.withCredentials=!!f.withCredentials}if(f.responseType){try{a.responseType=f.responseType}catch(e){if(f.responseType!=="json"){throw e}}}if(typeof f.onDownloadProgress==="function"){a.addEventListener("progress",f.onDownloadProgress)}if(typeof f.onUploadProgress==="function"&&a.upload){a.upload.addEventListener("progress",f.onUploadProgress)}if(f.cancelToken){f.cancelToken.promise.then(function e(t){if(!a){return}a.abort();i(t);a=null})}if(r===undefined){r=null}a.send(r)})}},function(e,t,n){"use strict";var i=n(17);e.exports=function e(t,n,r){var s=r.config.validateStatus;if(!s||s(r.status)){t(r)}else{n(i("Request failed with status code "+r.status,r.config,null,r.request,r))}}},function(e,t,n){"use strict";var a=n(18);e.exports=function e(t,n,r,s,i){var o=new Error(t);return a(o,n,r,s,i)}},function(e,t,n){"use strict";e.exports=function e(t,n,r,s,i){t.config=n;if(r){t.code=r}t.request=s;t.response=i;t.isAxiosError=true;t.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}};return t}},function(e,t,n){"use strict";var r=n(20);var s=n(21);e.exports=function e(t,n){if(t&&!r(n)){return s(t,n)}return n}},function(e,t,n){"use strict";e.exports=function e(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},function(e,t,n){"use strict";e.exports=function e(t,n){return n?t.replace(/\/+$/,"")+"/"+n.replace(/^\/+/,""):t}},function(e,t,n){"use strict";var o=n(5);var a=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function e(t){var n={};var r;var s;var i;if(!t){return n}o.forEach(t.split("\n"),function e(t){i=t.indexOf(":");r=o.trim(t.substr(0,i)).toLowerCase();s=o.trim(t.substr(i+1));if(r){if(n[r]&&a.indexOf(r)>=0){return}if(r==="set-cookie"){n[r]=(n[r]?n[r]:[]).concat([s])}else{n[r]=n[r]?n[r]+", "+s:s}}});return n}},function(e,t,n){"use strict";var o=n(5);e.exports=o.isStandardBrowserEnv()?function e(){var n=/(msie|trident)/i.test(navigator.userAgent);var r=document.createElement("a");var s;function i(e){var t=e;if(n){r.setAttribute("href",t);t=r.href}r.setAttribute("href",t);return{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:r.pathname.charAt(0)==="/"?r.pathname:"/"+r.pathname}}s=i(window.location.href);return function e(t){var n=o.isString(t)?i(t):t;return n.protocol===s.protocol&&n.host===s.host}}():function e(){return function e(){return true}}()},function(e,t,n){"use strict";var l=n(5);e.exports=l.isStandardBrowserEnv()?function e(){return{write:function e(t,n,r,s,i,o){var a=[];a.push(t+"="+encodeURIComponent(n));if(l.isNumber(r)){a.push("expires="+new Date(r).toGMTString())}if(l.isString(s)){a.push("path="+s)}if(l.isString(i)){a.push("domain="+i)}if(o===true){a.push("secure")}document.cookie=a.join("; ")},read:function e(t){var n=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove:function e(t){this.write(t,"",Date.now()-864e5)}}}():function e(){return{write:function e(){},read:function e(){return null},remove:function e(){}}}()},function(e,t,n){"use strict";var u=n(5);e.exports=function e(n,r){r=r||{};var s={};var t=["url","method","params","data"];var i=["headers","auth","proxy"];var o=["baseURL","url","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"];u.forEach(t,function e(t){if(typeof r[t]!=="undefined"){s[t]=r[t]}});u.forEach(i,function e(t){if(u.isObject(r[t])){s[t]=u.deepMerge(n[t],r[t])}else if(typeof r[t]!=="undefined"){s[t]=r[t]}else if(u.isObject(n[t])){s[t]=u.deepMerge(n[t])}else if(typeof n[t]!=="undefined"){s[t]=n[t]}});u.forEach(o,function e(t){if(typeof r[t]!=="undefined"){s[t]=r[t]}else if(typeof n[t]!=="undefined"){s[t]=n[t]}});var a=t.concat(i).concat(o);var l=Object.keys(r).filter(function e(t){return a.indexOf(t)===-1});u.forEach(l,function e(t){if(typeof r[t]!=="undefined"){s[t]=r[t]}else if(typeof n[t]!=="undefined"){s[t]=n[t]}});return s}},function(e,t,n){"use strict";function r(e){this.message=e}r.prototype.toString=function e(){return"Cancel"+(this.message?": "+this.message:"")};r.prototype.__CANCEL__=true;e.exports=r},function(e,t,n){"use strict";var s=n(26);function r(e){if(typeof e!=="function"){throw new TypeError("executor must be a function.")}var n;this.promise=new Promise(function e(t){n=t});var r=this;e(function e(t){if(r.reason){return}r.reason=new s(t);n(r.reason)})}r.prototype.throwIfRequested=function e(){if(this.reason){throw this.reason}};r.source=function e(){var n;var t=new r(function e(t){n=t});return{token:t,cancel:n}};e.exports=r},function(e,t,n){"use strict";e.exports=function e(n){return function e(t){return n.apply(null,t)}}},function(a,l,e){(function(s){var n,r,o;var f;var f;function V(e){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){V=function e(t){return typeof t}}else{V=function e(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}}return V(e)}(function(e){if((false?undefined:V(l))==="object"&&typeof a!=="undefined"){a.exports=e()}else if(true){!(r=[],n=e,o=typeof n==="function"?n.apply(l,r):n,o!==undefined&&(a.exports=o))}else{var t}})(function(){var E,e,t;return function i(o,a,l){function u(n,e){if(!a[n]){if(!o[n]){var t=typeof f=="function"&&f;if(!e&&t)return f(n,!0);if(c)return c(n,!0);var r=new Error("Cannot find module '"+n+"'");throw r.code="MODULE_NOT_FOUND",r}var s=a[n]={exports:{}};o[n][0].call(s.exports,function(e){var t=o[n][1][e];return u(t?t:e)},s,s.exports,i,o,a,l)}return a[n].exports}var c=typeof f=="function"&&f;for(var e=0;e<l.length;e++){u(l[e])}return u}({1:[function(e,t,n){var u=e("./url");var r=e("socket.io-parser");var c=e("./manager");var f=e("debug")("socket.io-client");t.exports=n=s;var h=n.managers={};function s(e,t){if(V(e)=="object"){t=e;e=undefined}t=t||{};var n=u(e);var r=n.source;var s=n.id;var i=n.path;var o=h[s]&&i in h[s].nsps;var a=t.forceNew||t["force new connection"]||false===t.multiplex||o;var l;if(a){f("ignoring socket cache for %s",r);l=c(r,t)}else{if(!h[s]){f("new io instance for %s",r);h[s]=c(r,t)}l=h[s]}return l.socket(n.path)}n.protocol=r.protocol;n.connect=s;n.Manager=e("./manager");n.Socket=e("./socket")},{"./manager":2,"./socket":4,"./url":5,debug:14,"socket.io-parser":40}],2:[function(e,t,n){var a=e("engine.io-client");var s=e("./socket");var r=e("component-emitter");var o=e("socket.io-parser");var l=e("./on");var u=e("component-bind");var c=e("debug")("socket.io-client:manager");var f=e("indexof");var h=e("backo2");var d=Object.prototype.hasOwnProperty;t.exports=p;function p(e,t){if(!(this instanceof p))return new p(e,t);if(e&&"object"==V(e)){t=e;e=undefined}t=t||{};t.path=t.path||"/socket.io";this.nsps={};this.subs=[];this.opts=t;this.reconnection(t.reconnection!==false);this.reconnectionAttempts(t.reconnectionAttempts||Infinity);this.reconnectionDelay(t.reconnectionDelay||1e3);this.reconnectionDelayMax(t.reconnectionDelayMax||5e3);this.randomizationFactor(t.randomizationFactor||.5);this.backoff=new h({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()});this.timeout(null==t.timeout?2e4:t.timeout);this.readyState="closed";this.uri=e;this.connecting=[];this.lastPing=null;this.encoding=false;this.packetBuffer=[];this.encoder=new o.Encoder;this.decoder=new o.Decoder;this.autoConnect=t.autoConnect!==false;if(this.autoConnect)this.open()}p.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var e in this.nsps){if(d.call(this.nsps,e)){this.nsps[e].emit.apply(this.nsps[e],arguments)}}};p.prototype.updateSocketIds=function(){for(var e in this.nsps){if(d.call(this.nsps,e)){this.nsps[e].id=this.engine.id}}};r(p.prototype);p.prototype.reconnection=function(e){if(!arguments.length)return this._reconnection;this._reconnection=!!e;return this};p.prototype.reconnectionAttempts=function(e){if(!arguments.length)return this._reconnectionAttempts;this._reconnectionAttempts=e;return this};p.prototype.reconnectionDelay=function(e){if(!arguments.length)return this._reconnectionDelay;this._reconnectionDelay=e;this.backoff&&this.backoff.setMin(e);return this};p.prototype.randomizationFactor=function(e){if(!arguments.length)return this._randomizationFactor;this._randomizationFactor=e;this.backoff&&this.backoff.setJitter(e);return this};p.prototype.reconnectionDelayMax=function(e){if(!arguments.length)return this._reconnectionDelayMax;this._reconnectionDelayMax=e;this.backoff&&this.backoff.setMax(e);return this};p.prototype.timeout=function(e){if(!arguments.length)return this._timeout;this._timeout=e;return this};p.prototype.maybeReconnectOnOpen=function(){if(!this.reconnecting&&this._reconnection&&this.backoff.attempts===0){this.reconnect()}};p.prototype.open=p.prototype.connect=function(n){c("readyState %s",this.readyState);if(~this.readyState.indexOf("open"))return this;c("opening %s",this.uri);this.engine=a(this.uri,this.opts);var e=this.engine;var r=this;this.readyState="opening";this.skipReconnect=false;var t=l(e,"open",function(){r.onopen();n&&n()});var s=l(e,"error",function(e){c("connect_error");r.cleanup();r.readyState="closed";r.emitAll("connect_error",e);if(n){var t=new Error("Connection error");t.data=e;n(t)}else{r.maybeReconnectOnOpen()}});if(false!==this._timeout){var i=this._timeout;c("connect attempt will timeout after %d",i);var o=setTimeout(function(){c("connect attempt timed out after %d",i);t.destroy();e.close();e.emit("error","timeout");r.emitAll("connect_timeout",i)},i);this.subs.push({destroy:function e(){clearTimeout(o)}})}this.subs.push(t);this.subs.push(s);return this};var _=[];var m=setInterval(function(){if(_!=null&&_.length>0){for(i=0;i<_.length;i++){if(_[i]&&_[i].connected&&_[i].disconnected==false){_[i].emit("heartbeat")}else if(_[i]){delete _[i]}}}},5e3);function v(e){_.push(e)}p.prototype.onopen=function(){c("open");this.cleanup();this.readyState="open";this.emit("open");var e=this.engine;this.subs.push(l(e,"data",u(this,"ondata")));this.subs.push(l(e,"ping",u(this,"onping")));this.subs.push(l(e,"pong",u(this,"onpong")));this.subs.push(l(e,"error",u(this,"onerror")));this.subs.push(l(e,"close",u(this,"onclose")));this.subs.push(l(this.decoder,"decoded",u(this,"ondecoded")))};p.prototype.onping=function(){this.lastPing=new Date;this.emitAll("ping")};p.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)};p.prototype.ondata=function(e){this.decoder.add(e)};p.prototype.ondecoded=function(e){this.emit("packet",e)};p.prototype.onerror=function(e){c("error",e);this.emitAll("error",e)};p.prototype.socket=function(e){var t=this.nsps[e];if(!t){t=new s(this,e);this.nsps[e]=t;var n=this;t.on("connecting",r);t.on("connect",function(){t.id=n.engine.id});if(this.autoConnect){r()}}function r(){if(!~f(n.connecting,t)){n.connecting.push(t)}}return t};p.prototype.destroy=function(e){var t=f(this.connecting,e);if(~t)this.connecting.splice(t,1);if(this.connecting.length)return;this.close()};p.prototype.packet=function(n){c("writing packet %j",n);var r=this;if(!r.encoding){r.encoding=true;this.encoder.encode(n,function(e){for(var t=0;t<e.length;t++){r.engine.write(e[t],n.options)}r.encoding=false;r.processPacketQueue()})}else{r.packetBuffer.push(n)}};p.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}};p.prototype.cleanup=function(){c("cleanup");var e;while(e=this.subs.shift()){e.destroy()}this.packetBuffer=[];this.encoding=false;this.lastPing=null;this.decoder.destroy()};p.prototype.close=p.prototype.disconnect=function(){c("disconnect");this.skipReconnect=true;this.reconnecting=false;if("opening"==this.readyState){this.cleanup()}this.backoff.reset();this.readyState="closed";if(this.engine)this.engine.close()};p.prototype.onclose=function(e){c("onclose");this.cleanup();this.backoff.reset();this.readyState="closed";this.emit("close",e);if(this._reconnection&&!this.skipReconnect){this.reconnect()}};p.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts){c("reconnect failed");this.backoff.reset();this.emitAll("reconnect_failed");this.reconnecting=false}else{var e=this.backoff.duration();c("will wait %dms before reconnect attempt",e);this.reconnecting=true;var n=setTimeout(function(){if(t.skipReconnect)return;c("attempting reconnect");t.emitAll("reconnect_attempt",t.backoff.attempts);t.emitAll("reconnecting",t.backoff.attempts);if(t.skipReconnect)return;t.open(function(e){if(e){c("reconnect attempt error");t.reconnecting=false;t.reconnect();t.emitAll("reconnect_error",e.data)}else{c("reconnect success");t.onreconnect()}})},e);this.subs.push({destroy:function e(){clearTimeout(n)}})}};p.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=false;this.backoff.reset();this.updateSocketIds();this.emitAll("reconnect",e)}},{"./on":3,"./socket":4,backo2:8,"component-bind":11,"component-emitter":12,debug:14,"engine.io-client":16,indexof:32,"socket.io-parser":40}],3:[function(e,t,n){t.exports=r;function r(t,n,r){t.on(n,r);return{destroy:function e(){t.removeListener(n,r)}}}},{}],4:[function(e,t,n){var i=e("socket.io-parser");var r=e("component-emitter");var o=e("to-array");var s=e("./on");var a=e("component-bind");var l=e("debug")("socket.io-client:socket");var u=e("has-binary");t.exports=n=h;var c={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1};var f=r.prototype.emit;function h(e,t){this.io=e;this.nsp=t;this.json=this;this.ids=0;this.acks={};this.receiveBuffer=[];this.sendBuffer=[];this.connected=false;this.disconnected=true;if(this.io.autoConnect)this.open()}r(h.prototype);h.prototype.subEvents=function(){if(this.subs)return;var e=this.io;this.subs=[s(e,"open",a(this,"onopen")),s(e,"packet",a(this,"onpacket")),s(e,"close",a(this,"onclose"))]};h.prototype.open=h.prototype.connect=function(){if(this.connected)return this;this.subEvents();this.io.open();if("open"==this.io.readyState)this.onopen();this.emit("connecting");return this};h.prototype.send=function(){var e=o(arguments);e.unshift("message");this.emit.apply(this,e);return this};h.prototype.emit=function(e){if(c.hasOwnProperty(e)){f.apply(this,arguments);return this}var t=o(arguments);var n=i.EVENT;if(u(t)){n=i.BINARY_EVENT}var r={type:n,data:t};r.options={};r.options.compress=!this.flags||false!==this.flags.compress;if("function"==typeof t[t.length-1]){l("emitting packet with ack id %d",this.ids);this.acks[this.ids]=t.pop();r.id=this.ids++}if(this.connected){this.packet(r)}else{this.sendBuffer.push(r)}delete this.flags;return this};h.prototype.packet=function(e){e.nsp=this.nsp;this.io.packet(e)};h.prototype.onopen=function(){l("transport is open - connecting");if("/"!=this.nsp){this.packet({type:i.CONNECT})}};h.prototype.onclose=function(e){l("close (%s)",e);this.connected=false;this.disconnected=true;delete this.id;this.emit("disconnect",e)};h.prototype.onpacket=function(e){if(e.nsp!=this.nsp)return;switch(e.type){case i.CONNECT:this.onconnect();break;case i.EVENT:this.onevent(e);break;case i.BINARY_EVENT:this.onevent(e);break;case i.ACK:this.onack(e);break;case i.BINARY_ACK:this.onack(e);break;case i.DISCONNECT:this.ondisconnect();break;case i.ERROR:this.emit("error",e.data);break}};h.prototype.onevent=function(e){var t=e.data||[];l("emitting event %j",t);if(null!=e.id){l("attaching ack callback to event");t.push(this.ack(e.id))}if(this.connected){f.apply(this,t)}else{this.receiveBuffer.push(t)}};h.prototype.ack=function(n){var r=this;var s=false;return function(){if(s)return;s=true;var e=o(arguments);l("sending ack %j",e);var t=u(e)?i.BINARY_ACK:i.ACK;r.packet({type:t,id:n,data:e})}};h.prototype.onack=function(e){var t=this.acks[e.id];if("function"==typeof t){l("calling ack %s with %j",e.id,e.data);t.apply(this,e.data);delete this.acks[e.id]}else{l("bad ack %s",e.id)}};h.prototype.onconnect=function(){this.connected=true;this.disconnected=false;this.emit("connect");this.emitBuffered()};h.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++){f.apply(this,this.receiveBuffer[e])}this.receiveBuffer=[];for(e=0;e<this.sendBuffer.length;e++){this.packet(this.sendBuffer[e])}this.sendBuffer=[]};h.prototype.ondisconnect=function(){l("server disconnect (%s)",this.nsp);this.destroy();this.onclose("io server disconnect")};h.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++){this.subs[e].destroy()}this.subs=null}this.io.destroy(this)};h.prototype.close=h.prototype.disconnect=function(){if(this.connected){l("performing disconnect (%s)",this.nsp);this.packet({type:i.DISCONNECT})}this.destroy();if(this.connected){this.onclose("io client disconnect")}return this};h.prototype.compress=function(e){this.flags=this.flags||{};this.flags.compress=e;return this}},{"./on":3,"component-bind":11,"component-emitter":12,debug:14,"has-binary":30,"socket.io-parser":40,"to-array":43}],5:[function(t,n,e){(function(i){var o=t("parseuri");var a=t("debug")("socket.io-client:url");n.exports=e;function e(e,t){var n=e;var t=t||i.location;if(null==e)e=t.protocol+"//"+t.host;if("string"==typeof e){if("/"==e.charAt(0)){if("/"==e.charAt(1)){e=t.protocol+e}else{e=t.host+e}}if(!/^(https?|wss?):\/\//.test(e)){a("protocol-less url %s",e);if("undefined"!=typeof t){e=t.protocol+"//"+e}else{e="https://"+e}}a("parse %s",e);n=o(e)}if(!n.port){if(/^(http|ws)$/.test(n.protocol)){n.port="80"}else if(/^(http|ws)s$/.test(n.protocol)){n.port="443"}}n.path=n.path||"/";var r=n.host.indexOf(":")!==-1;var s=r?"["+n.host+"]":n.host;n.id=n.protocol+"://"+s+":"+n.port;n.href=n.protocol+"://"+s+(t&&t.port==n.port?"":":"+n.port);return n}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof s!=="undefined"?s:{})},{debug:14,parseuri:38}],6:[function(e,t,n){t.exports=r;function r(e,n,r){var s=false;r=r||o;i.count=e;return e===0?n():i;function i(e,t){if(i.count<=0){throw new Error("after called too many times")}--i.count;if(e){s=true;n(e);n=r}else if(i.count===0&&!s){n(null,t)}}}function o(){}},{}],7:[function(e,t,n){t.exports=function(e,t,n){var r=e.byteLength;t=t||0;n=n||r;if(e.slice){return e.slice(t,n)}if(t<0){t+=r}if(n<0){n+=r}if(n>r){n=r}if(t>=r||t>=n||r===0){return new ArrayBuffer(0)}var s=new Uint8Array(e);var i=new Uint8Array(n-t);for(var o=t,a=0;o<n;o++,a++){i[a]=s[o]}return i.buffer}},{}],8:[function(e,t,n){t.exports=r;function r(e){e=e||{};this.ms=e.min||100;this.max=e.max||1e4;this.factor=e.factor||2;this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0;this.attempts=0}r.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random();var n=Math.floor(t*this.jitter*e);e=(Math.floor(t*10)&1)==0?e-n:e+n}return Math.min(e,this.max)|0};r.prototype.reset=function(){this.attempts=0};r.prototype.setMin=function(e){this.ms=e};r.prototype.setMax=function(e){this.max=e};r.prototype.setJitter=function(e){this.jitter=e}},{}],9:[function(e,t,n){(function(){"use strict";var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var f=new Array(256);for(var e=0;e<i.length;e++){f[i.charCodeAt(e)]=e}n.encode=function(e){var t=new Array(e),n,r=t.length,s="";for(n=0;n<r;n+=3){s+=i[t[n]>>2];s+=i[(t[n]&3)<<4|t[n+1]>>4];s+=i[(t[n+1]&15)<<2|t[n+2]>>6];s+=i[t[n+2]&63]}if(r%3===2){s=s.substring(0,s.length-1)+"="}else if(r%3===1){s=s.substring(0,s.length-2)+"=="}return s};n.decode=function(e){var t=e.length*.75,n=e.length,r,s=0,i,o,a,l;if(e[e.length-1]==="="){t--;if(e[e.length-2]==="="){t--}}var u=new ArrayBuffer(t),c=new Array(u);for(r=0;r<n;r+=4){i=f[e.charCodeAt(r)];o=f[e.charCodeAt(r+1)];a=f[e.charCodeAt(r+2)];l=f[e.charCodeAt(r+3)];c[s++]=i<<2|o>>4;c[s++]=(o&15)<<4|a>>2;c[s++]=(a&3)<<6|l&63}return u}})()},{}],10:[function(e,l,t){(function(e){var s=e.BlobBuilder||e.WebKitBlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder;var t=function(){try{var e=new Blob(["hi"]);return e.size===2}catch(e){return false}}();var n=t&&function(){try{var e=new Blob([new Uint8Array([1,2])]);return e.size===2}catch(e){return false}}();var r=s&&s.prototype.append&&s.prototype.getBlob;function i(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.buffer instanceof ArrayBuffer){var r=n.buffer;if(n.byteLength!==r.byteLength){var s=new Uint8Array(n.byteLength);s.set(new Uint8Array(r,n.byteOffset,n.byteLength));r=s.buffer}e[t]=r}}}function o(e,t){t=t||{};var n=new s;i(e);for(var r=0;r<e.length;r++){n.append(e[r])}return t.type?n.getBlob(t.type):n.getBlob()}function a(e,t){i(e);return new Blob(e,t||{})}l.exports=function(){if(t){return n?e.Blob:a}else if(r){return o}else{return undefined}}()}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof s!=="undefined"?s:{})},{}],11:[function(e,t,n){var r=[].slice;t.exports=function(e,t){if("string"==typeof t)t=e[t];if("function"!=typeof t)throw new Error("bind() requires a function");var n=r.call(arguments,2);return function(){return t.apply(e,n.concat(r.call(arguments)))}}},{}],12:[function(e,t,n){t.exports=r;function r(e){if(e)return s(e)}function s(e){for(var t in r.prototype){e[t]=r.prototype[t]}return e}r.prototype.on=r.prototype.addEventListener=function(e,t){this._callbacks=this._callbacks||{};(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t);return this};r.prototype.once=function(e,t){function n(){this.off(e,n);t.apply(this,arguments)}n.fn=t;this.on(e,n);return this};r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){this._callbacks=this._callbacks||{};if(0==arguments.length){this._callbacks={};return this}var n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length){delete this._callbacks["$"+e];return this}var r;for(var s=0;s<n.length;s++){r=n[s];if(r===t||r.fn===t){n.splice(s,1);break}}return this};r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n){n=n.slice(0);for(var r=0,s=n.length;r<s;++r){n[r].apply(this,t)}}return this};r.prototype.listeners=function(e){this._callbacks=this._callbacks||{};return this._callbacks["$"+e]||[]};r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},{}],13:[function(e,t,n){t.exports=function(e,t){var n=function e(){};n.prototype=t.prototype;e.prototype=new n;e.prototype.constructor=e}},{}],14:[function(e,t,i){i=t.exports=e("./debug");i.log=s;i.formatArgs=r;i.save=o;i.load=a;i.useColors=n;i.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:l();i.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function n(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}i.formatters.j=function(e){return JSON.stringify(e)};function r(){var e=arguments;var t=this.useColors;e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+i.humanize(this.diff);if(!t)return e;var n="color: "+this.color;e=[e[0],n,"color: inherit"].concat(Array.prototype.slice.call(e,1));var r=0;var s=0;e[0].replace(/%[a-z%]/g,function(e){if("%%"===e)return;r++;if("%c"===e){s=r}});e.splice(s,0,n);return e}function s(){return"object"===(typeof console==="undefined"?"undefined":V(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function o(e){try{if(null==e){i.storage.removeItem("debug")}else{i.storage.debug=e}}catch(e){}}function a(){var e;try{e=i.storage.debug}catch(e){}return e}i.enable(a());function l(){try{return window.localStorage}catch(e){}}},{"./debug":15}],15:[function(e,t,a){a=t.exports=r;a.coerce=c;a.disable=i;a.enable=s;a.enabled=o;a.humanize=e("ms");a.names=[];a.skips=[];a.formatters={};var n=0;var l;function u(){return a.colors[n++%a.colors.length]}function r(e){function t(){}t.enabled=false;function r(){var s=r;var e=+new Date;var t=e-(l||e);s.diff=t;s.prev=l;s.curr=e;l=e;if(null==s.useColors)s.useColors=a.useColors();if(null==s.color&&s.useColors)s.color=u();var i=Array.prototype.slice.call(arguments);i[0]=a.coerce(i[0]);if("string"!==typeof i[0]){i=["%o"].concat(i)}var o=0;i[0]=i[0].replace(/%([a-z%])/g,function(e,t){if(e==="%%")return e;o++;var n=a.formatters[t];if("function"===typeof n){var r=i[o];e=n.call(s,r);i.splice(o,1);o--}return e});if("function"===typeof a.formatArgs){i=a.formatArgs.apply(s,i)}var n=r.log||a.log||console.log.bind(console);n.apply(s,i)}r.enabled=true;var n=a.enabled(e)?r:t;n.namespace=e;return n}function s(e){a.save(e);var t=(e||"").split(/[\s,]+/);var n=t.length;for(var r=0;r<n;r++){if(!t[r])continue;e=t[r].replace(/\*/g,".*?");if(e[0]==="-"){a.skips.push(new RegExp("^"+e.substr(1)+"$"))}else{a.names.push(new RegExp("^"+e+"$"))}}}function i(){a.enable("")}function o(e){var t,n;for(t=0,n=a.skips.length;t<n;t++){if(a.skips[t].test(e)){return false}}for(t=0,n=a.names.length;t<n;t++){if(a.names[t].test(e)){return true}}return false}function c(e){if(e instanceof Error)return e.stack||e.message;return e}},{ms:35}],16:[function(e,t,n){t.exports=e("./lib/")},{"./lib/":17}],17:[function(e,t,n){t.exports=e("./socket");t.exports.parser=e("engine.io-parser")},{"./socket":18,"engine.io-parser":27}],18:[function(c,d,e){(function(r){var s=c("./transports");var e=c("component-emitter");var f=c("debug")("engine.io-client:socket");var i=c("indexof");var o=c("engine.io-parser");var a=c("parseuri");var n=c("parsejson");var l=c("parseqs");d.exports=h;function t(){}function h(e,t){if(!(this instanceof h))return new h(e,t);t=t||{};if(e&&"object"==V(e)){t=e;e=null}if(e){e=a(e);t.hostname=e.host;t.secure=e.protocol=="https"||e.protocol=="wss";t.port=e.port;if(e.query)t.query=e.query}else if(t.host){t.hostname=a(t.host).host}this.secure=null!=t.secure?t.secure:r.location&&"https:"==location.protocol;if(t.hostname&&!t.port){t.port=this.secure?"443":"80"}this.agent=t.agent||false;this.hostname=t.hostname||(r.location?location.hostname:"localhost");this.port=t.port||(r.location&&location.port?location.port:this.secure?443:80);this.query=t.query||{};if("string"==typeof this.query)this.query=l.decode(this.query);this.upgrade=false!==t.upgrade;this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/";this.forceJSONP=!!t.forceJSONP;this.jsonp=false!==t.jsonp;this.forceBase64=!!t.forceBase64;this.enablesXDR=!!t.enablesXDR;this.timestampParam=t.timestampParam||"t";this.timestampRequests=t.timestampRequests;this.transports=t.transports||["polling","websocket"];this.readyState="";this.writeBuffer=[];this.policyPort=t.policyPort||843;this.rememberUpgrade=t.rememberUpgrade||false;this.binaryType=null;this.onlyBinaryUpgrades=t.onlyBinaryUpgrades;this.perMessageDeflate=false!==t.perMessageDeflate?t.perMessageDeflate||{}:false;if(true===this.perMessageDeflate)this.perMessageDeflate={};if(this.perMessageDeflate&&null==this.perMessageDeflate.threshold){this.perMessageDeflate.threshold=1024}this.pfx=t.pfx||null;this.key=t.key||null;this.passphrase=t.passphrase||null;this.cert=t.cert||null;this.ca=t.ca||null;this.ciphers=t.ciphers||null;this.rejectUnauthorized=t.rejectUnauthorized===undefined?true:t.rejectUnauthorized;var n=V(r)=="object"&&r;if(n.global===n){if(t.extraHeaders&&Object.keys(t.extraHeaders).length>0){this.extraHeaders=t.extraHeaders}}this.open()}h.priorWebsocketSuccess=false;e(h.prototype);h.protocol=o.protocol;h.Socket=h;h.Transport=c("./transport");h.transports=c("./transports");h.parser=c("engine.io-parser");h.prototype.createTransport=function(e){f('creating transport "%s"',e);var t=u(this.query);t.EIO=o.protocol;t.transport=e;if(this.id)t.sid=this.id;var n=new s[e]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:t,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized,perMessageDeflate:this.perMessageDeflate,extraHeaders:this.extraHeaders});return n};function u(e){var t={};for(var n in e){if(e.hasOwnProperty(n)){t[n]=e[n]}}return t}h.prototype.open=function(){var e;if(this.rememberUpgrade&&h.priorWebsocketSuccess&&this.transports.indexOf("websocket")!=-1){e="websocket"}else if(0===this.transports.length){var t=this;setTimeout(function(){t.emit("error","No transports available")},0);return}else{e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){this.transports.shift();this.open();return}e.open();this.setTransport(e)};h.prototype.setTransport=function(e){f("setting transport %s",e.name);var t=this;if(this.transport){f("clearing existing transport %s",this.transport.name);this.transport.removeAllListeners()}this.transport=e;e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})};h.prototype.probe=function(n){f('probing transport "%s"',n);var r=this.createTransport(n,{probe:1}),s=false,i=this;h.priorWebsocketSuccess=false;function e(){if(i.onlyBinaryUpgrades){var e=!this.supportsBinary&&i.transport.supportsBinary;s=s||e}if(s)return;f('probe transport "%s" opened',n);r.send([{type:"ping",data:"probe"}]);r.once("packet",function(e){if(s)return;if("pong"==e.type&&"probe"==e.data){f('probe transport "%s" pong',n);i.upgrading=true;i.emit("upgrading",r);if(!r)return;h.priorWebsocketSuccess="websocket"==r.name;f('pausing current transport "%s"',i.transport.name);i.transport.pause(function(){if(s)return;if("closed"==i.readyState)return;f("changing transport and sending upgrade packet");c();i.setTransport(r);r.send([{type:"upgrade"}]);i.emit("upgrade",r);r=null;i.upgrading=false;i.flush()})}else{f('probe transport "%s" failed',n);var t=new Error("probe error");t.transport=r.name;i.emit("upgradeError",t)}})}function o(){if(s)return;s=true;c();r.close();r=null}function t(e){var t=new Error("probe error: "+e);t.transport=r.name;o();f('probe transport "%s" failed because of error: %s',n,e);i.emit("upgradeError",t)}function a(){t("transport closed")}function l(){t("socket closed")}function u(e){if(r&&e.name!=r.name){f('"%s" works - aborting "%s"',e.name,r.name);o()}}function c(){r.removeListener("open",e);r.removeListener("error",t);r.removeListener("close",a);i.removeListener("close",l);i.removeListener("upgrading",u)}r.once("open",e);r.once("error",t);r.once("close",a);this.once("close",l);this.once("upgrading",u);r.open()};h.prototype.onOpen=function(){f("socket open");this.readyState="open";h.priorWebsocketSuccess="websocket"==this.transport.name;this.emit("open");this.flush();if("open"==this.readyState&&this.upgrade&&this.transport.pause){f("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++){this.probe(this.upgrades[e])}}};h.prototype.onPacket=function(e){if("opening"==this.readyState||"open"==this.readyState){f('socket receive: type "%s", data "%s"',e.type,e.data);this.emit("packet",e);this.emit("heartbeat");switch(e.type){case"open":this.onHandshake(n(e.data));break;case"pong":this.setPing();this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data;this.onError(t);break;case"message":this.emit("data",e.data);this.emit("message",e.data);break}}else{f('packet received with socket readyState "%s"',this.readyState)}};h.prototype.onHandshake=function(e){this.emit("handshake",e);this.id=e.sid;this.transport.query.sid=e.sid;this.upgrades=this.filterUpgrades(e.upgrades);this.pingInterval=e.pingInterval;this.pingTimeout=e.pingTimeout;this.onOpen();if("closed"==this.readyState)return;this.setPing();this.removeListener("heartbeat",this.onHeartbeat);this.on("heartbeat",this.onHeartbeat)};h.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){if("closed"==t.readyState)return;t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)};h.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer);e.pingIntervalTimer=setTimeout(function(){f("writing ping packet - expecting pong within %sms",e.pingTimeout);e.ping();e.onHeartbeat(e.pingTimeout)},e.pingInterval)};h.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})};h.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen);this.prevBufferLen=0;if(0===this.writeBuffer.length){this.emit("drain")}else{this.flush()}};h.prototype.flush=function(){if("closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){f("flushing %d packets in socket",this.writeBuffer.length);this.transport.send(this.writeBuffer);this.prevBufferLen=this.writeBuffer.length;this.emit("flush")}};h.prototype.write=h.prototype.send=function(e,t,n){this.sendPacket("message",e,t,n);return this};h.prototype.sendPacket=function(e,t,n,r){if("function"==typeof t){r=t;t=undefined}if("function"==typeof n){r=n;n=null}if("closing"==this.readyState||"closed"==this.readyState){return}n=n||{};n.compress=false!==n.compress;var s={type:e,data:t,options:n};this.emit("packetCreate",s);this.writeBuffer.push(s);if(r)this.once("flush",r);this.flush()};h.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState){this.readyState="closing";var e=this;if(this.writeBuffer.length){this.once("drain",function(){if(this.upgrading){r()}else{t()}})}else if(this.upgrading){r()}else{t()}}function t(){e.onClose("forced close");f("socket closing - telling transport to close");e.transport.close()}function n(){e.removeListener("upgrade",n);e.removeListener("upgradeError",n);t()}function r(){e.once("upgrade",n);e.once("upgradeError",n)}return this};h.prototype.onError=function(e){f("socket error %j",e);h.priorWebsocketSuccess=false;this.emit("error",e);this.onClose("transport error",e)};h.prototype.onClose=function(e,t){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){f('socket close with reason: "%s"',e);var n=this;clearTimeout(this.pingIntervalTimer);clearTimeout(this.pingTimeoutTimer);this.transport.removeAllListeners("close");this.transport.close();this.transport.removeAllListeners();this.readyState="closed";this.id=null;this.emit("close",e,t);n.writeBuffer=[];n.prevBufferLen=0}};h.prototype.filterUpgrades=function(e){var t=[];for(var n=0,r=e.length;n<r;n++){if(~i(this.transports,e[n]))t.push(e[n])}return t}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof s!=="undefined"?s:{})},{"./transport":19,"./transports":20,"component-emitter":26,debug:14,"engine.io-parser":27,indexof:32,parsejson:36,parseqs:37,parseuri:38}],19:[function(e,t,n){var r=e("engine.io-parser");var s=e("component-emitter");t.exports=i;function i(e){this.path=e.path;this.hostname=e.hostname;this.port=e.port;this.secure=e.secure;this.query=e.query;this.timestampParam=e.timestampParam;this.timestampRequests=e.timestampRequests;this.readyState="";this.agent=e.agent||false;this.socket=e.socket;this.enablesXDR=e.enablesXDR;this.pfx=e.pfx;this.key=e.key;this.passphrase=e.passphrase;this.cert=e.cert;this.ca=e.ca;this.ciphers=e.ciphers;this.rejectUnauthorized=e.rejectUnauthorized;this.extraHeaders=e.extraHeaders}s(i.prototype);i.prototype.onError=function(e,t){var n=new Error(e);n.type="TransportError";n.description=t;this.emit("error",n);return this};i.prototype.open=function(){if("closed"==this.readyState||""==this.readyState){this.readyState="opening";this.doOpen()}return this};i.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState){this.doClose();this.onClose()}return this};i.prototype.send=function(e){if("open"==this.readyState){this.write(e)}else{throw new Error("Transport not open")}};i.prototype.onOpen=function(){this.readyState="open";this.writable=true;this.emit("open")};i.prototype.onData=function(e){var t=r.decodePacket(e,this.socket.binaryType);this.onPacket(t)};i.prototype.onPacket=function(e){this.emit("packet",e)};i.prototype.onClose=function(){this.readyState="closed";this.emit("close")}},{"component-emitter":26,"engine.io-parser":27}],20:[function(n,e,r){(function(a){var l=n("xmlhttprequest-ssl");var u=n("./polling-xhr");var c=n("./polling-jsonp");var e=n("./websocket");r.polling=t;r.websocket=e;function t(e){var t;var n=false;var r=false;var s=false!==e.jsonp;if(a.location){var i="https:"==location.protocol;var o=location.port;if(!o){o=i?443:80}n=e.hostname!=location.hostname||o!=e.port;r=e.secure!=i}e.xdomain=n;e.xscheme=r;t=new l(e);if("open"in t&&!e.forceJSONP){return new u(e)}else{if(!s)throw new Error("JSONP disabled");return new c(e)}}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof s!=="undefined"?s:{})},{"./polling-jsonp":21,"./polling-xhr":22,"./websocket":24,"xmlhttprequest-ssl":25}],21:[function(a,l,e){(function(n){var r=a("./polling");var e=a("component-inherit");l.exports=o;var u=/\n/g;var c=/\\n/g;var s;var t=0;function i(){}function o(e){r.call(this,e);this.query=this.query||{};if(!s){if(!n.___eio)n.___eio=[];s=n.___eio}this.index=s.length;var t=this;s.push(function(e){t.onData(e)});this.query.j=this.index;if(n.document&&n.addEventListener){n.addEventListener("beforeunload",function(){if(t.script)t.script.onerror=i},false)}}e(o,r);o.prototype.supportsBinary=false;o.prototype.doClose=function(){if(this.script){this.script.parentNode.removeChild(this.script);this.script=null}if(this.form){this.form.parentNode.removeChild(this.form);this.form=null;this.iframe=null}r.prototype.doClose.call(this)};o.prototype.doPoll=function(){var t=this;var e=document.createElement("script");if(this.script){this.script.parentNode.removeChild(this.script);this.script=null}e.async=true;e.src=this.uri();e.onerror=function(e){t.onError("jsonp poll error",e)};var n=document.getElementsByTagName("script")[0];if(n){n.parentNode.insertBefore(e,n)}else{(document.head||document.body).appendChild(e)}this.script=e;var r="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);if(r){setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e);document.body.removeChild(e)},100)}};o.prototype.doWrite=function(e,t){var n=this;if(!this.form){var r=document.createElement("form");var s=document.createElement("textarea");var i=this.iframeId="eio_iframe_"+this.index;var o;r.className="socketio";r.style.position="absolute";r.style.top="-1000px";r.style.left="-1000px";r.target=i;r.method="POST";r.setAttribute("accept-charset","utf-8");s.name="d";r.appendChild(s);document.body.appendChild(r);this.form=r;this.area=s}this.form.action=this.uri();function a(){l();t()}function l(){if(n.iframe){try{n.form.removeChild(n.iframe)}catch(e){n.onError("jsonp polling iframe removal error",e)}}try{var e='<iframe src="javascript:0" name="'+n.iframeId+'">';o=document.createElement(e)}catch(e){o=document.createElement("iframe");o.name=n.iframeId;o.src="javascript:0"}o.id=n.iframeId;n.form.appendChild(o);n.iframe=o}l();e=e.replace(c,"\\\n");this.area.value=e.replace(u,"\\n");try{this.form.submit()}catch(e){}if(this.iframe.attachEvent){this.iframe.onreadystatechange=function(){if(n.iframe.readyState=="complete"){a()}}}else{this.iframe.onload=a}}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof s!=="undefined"?s:{})},{"./polling":23,"component-inherit":13}],22:[function(c,f,e){(function(s){var i=c("xmlhttprequest-ssl");var r=c("./polling");var e=c("component-emitter");var t=c("component-inherit");var o=c("debug")("engine.io-client:polling-xhr");f.exports=a;f.exports.Request=l;function n(){}function a(e){r.call(this,e);if(s.location){var t="https:"==location.protocol;var n=location.port;if(!n){n=t?443:80}this.xd=e.hostname!=s.location.hostname||n!=e.port;this.xs=e.secure!=t}else{this.extraHeaders=e.extraHeaders}}t(a,r);a.prototype.supportsBinary=true;a.prototype.request=function(e){e=e||{};e.uri=this.uri();e.xd=this.xd;e.xs=this.xs;e.agent=this.agent||false;e.supportsBinary=this.supportsBinary;e.enablesXDR=this.enablesXDR;e.pfx=this.pfx;e.key=this.key;e.passphrase=this.passphrase;e.cert=this.cert;e.ca=this.ca;e.ciphers=this.ciphers;e.rejectUnauthorized=this.rejectUnauthorized;e.extraHeaders=this.extraHeaders;return new l(e)};a.prototype.doWrite=function(e,t){var n=typeof e!=="string"&&e!==undefined;var r=this.request({method:"POST",data:e,isBinary:n});var s=this;r.on("success",t);r.on("error",function(e){s.onError("xhr post error",e)});this.sendXhr=r};a.prototype.doPoll=function(){o("xhr poll");var e=this.request();var t=this;e.on("data",function(e){t.onData(e)});e.on("error",function(e){t.onError("xhr poll error",e)});this.pollXhr=e};function l(e){this.method=e.method||"GET";this.uri=e.uri;this.xd=!!e.xd;this.xs=!!e.xs;this.async=false!==e.async;this.data=undefined!=e.data?e.data:null;this.agent=e.agent;this.isBinary=e.isBinary;this.supportsBinary=e.supportsBinary;this.enablesXDR=e.enablesXDR;this.pfx=e.pfx;this.key=e.key;this.passphrase=e.passphrase;this.cert=e.cert;this.ca=e.ca;this.ciphers=e.ciphers;this.rejectUnauthorized=e.rejectUnauthorized;this.extraHeaders=e.extraHeaders;this.create()}e(l.prototype);l.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx;e.key=this.key;e.passphrase=this.passphrase;e.cert=this.cert;e.ca=this.ca;e.ciphers=this.ciphers;e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new i(e);var n=this;try{o("xhr open %s: %s",this.method,this.uri);t.open(this.method,this.uri,this.async);try{if(this.extraHeaders){t.setDisableHeaderCheck(true);for(var r in this.extraHeaders){if(this.extraHeaders.hasOwnProperty(r)){t.setRequestHeader(r,this.extraHeaders[r])}}}}catch(e){}if(this.supportsBinary){t.responseType="arraybuffer"}if("POST"==this.method){try{if(this.isBinary){t.setRequestHeader("Content-type","application/octet-stream")}else{t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}}catch(e){}}if("withCredentials"in t){t.withCredentials=true}if(this.hasXDR()){t.onload=function(){n.onLoad()};t.onerror=function(){n.onError(t.responseText)}}else{t.onreadystatechange=function(){if(4!=t.readyState)return;if(200==t.status||1223==t.status){n.onLoad()}else{setTimeout(function(){n.onError(t.status)},0)}}}o("xhr data %s",this.data);t.send(this.data)}catch(e){setTimeout(function(){n.onError(e)},0);return}if(s.document){this.index=l.requestsCount++;l.requests[this.index]=this}};l.prototype.onSuccess=function(){this.emit("success");this.cleanup()};l.prototype.onData=function(e){this.emit("data",e);this.onSuccess()};l.prototype.onError=function(e){this.emit("error",e);this.cleanup(true)};l.prototype.cleanup=function(e){if("undefined"==typeof this.xhr||null===this.xhr){return}if(this.hasXDR()){this.xhr.onload=this.xhr.onerror=n}else{this.xhr.onreadystatechange=n}if(e){try{this.xhr.abort()}catch(e){}}if(s.document){delete l.requests[this.index]}this.xhr=null};l.prototype.onLoad=function(){var t;try{var e;try{e=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(e){}if(e==="application/octet-stream"){t=this.xhr.response}else{if(!this.supportsBinary){t=this.xhr.responseText}else{try{t=String.fromCharCode.apply(null,new Uint8Array(this.xhr.response))}catch(e){var n=new Uint8Array(this.xhr.response);var r=[];for(var s=0,i=n.length;s<i;s++){r.push(n[s])}t=String.fromCharCode.apply(null,r)}}}}catch(e){this.onError(e)}if(null!=t){this.onData(t)}};l.prototype.hasXDR=function(){return"undefined"!==typeof s.XDomainRequest&&!this.xs&&this.enablesXDR};l.prototype.abort=function(){this.cleanup()};if(s.document){l.requestsCount=0;l.requests={};if(s.attachEvent){s.attachEvent("onunload",u)}else if(s.addEventListener){s.addEventListener("beforeunload",u,false)}}function u(){for(var e in l.requests){if(l.requests.hasOwnProperty(e)){l.requests[e].abort()}}}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof s!=="undefined"?s:{})},{"./polling":23,"component-emitter":26,"component-inherit":13,debug:14,"xmlhttprequest-ssl":25}],23:[function(n,e,t){var r=n("../transport");var s=n("parseqs");var i=n("engine.io-parser");var o=n("component-inherit");var a=n("yeast");var l=n("debug")("engine.io-client:polling");e.exports=c;var u=function(){var e=n("xmlhttprequest-ssl");var t=new e({xdomain:false});return null!=t.responseType}();function c(e){var t=e&&e.forceBase64;if(!u||t){this.supportsBinary=false}r.call(this,e)}o(c,r);c.prototype.name="polling";c.prototype.doOpen=function(){this.poll()};c.prototype.pause=function(e){var t=0;var n=this;this.readyState="pausing";function r(){l("paused");n.readyState="paused";e()}if(this.polling||!this.writable){var s=0;if(this.polling){l("we are currently polling - waiting to pause");s++;this.once("pollComplete",function(){l("pre-pause polling complete");--s||r()})}if(!this.writable){l("we are currently writing - waiting to pause");s++;this.once("drain",function(){l("pre-pause writing complete");--s||r()})}}else{r()}};c.prototype.poll=function(){l("polling");this.polling=true;this.doPoll();this.emit("poll")};c.prototype.onData=function(e){var s=this;l("polling got data %s",e);var t=function e(t,n,r){if("opening"==s.readyState){s.onOpen()}if("close"==t.type){s.onClose();return false}s.onPacket(t)};i.decodePayload(e,this.socket.binaryType,t);if("closed"!=this.readyState){this.polling=false;this.emit("pollComplete");if("open"==this.readyState){this.poll()}else{l('ignoring poll - transport state "%s"',this.readyState)}}};c.prototype.doClose=function(){var e=this;function t(){l("writing close packet");e.write([{type:"close"}])}if("open"==this.readyState){l("transport open - closing");t()}else{l("transport not open - deferring close");this.once("open",t)}};c.prototype.write=function(e){var t=this;this.writable=false;var n=function e(){t.writable=true;t.emit("drain")};var t=this;i.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})};c.prototype.uri=function(){var e=this.query||{};var t=this.secure?"https":"http";var n="";if(false!==this.timestampRequests){e[this.timestampParam]=a()}if(!this.supportsBinary&&!e.sid){e.b64=1}e=s.encode(e);if(this.port&&("https"==t&&this.port!=443||"http"==t&&this.port!=80)){n=":"+this.port}if(e.length){e="?"+e}var r=this.hostname.indexOf(":")!==-1;return t+"://"+(r?"["+this.hostname+"]":this.hostname)+n+this.path+e}},{"../transport":19,"component-inherit":13,debug:14,"engine.io-parser":27,parseqs:37,"xmlhttprequest-ssl":25,yeast:45}],24:[function(r,f,e){(function(a){var n=r("../transport");var l=r("engine.io-parser");var s=r("parseqs");var e=r("component-inherit");var i=r("yeast");var u=r("debug")("engine.io-client:websocket");var c=a.WebSocket||a.MozWebSocket;var o=c;if(!o&&typeof window==="undefined"){try{o=r("ws")}catch(e){}}f.exports=t;function t(e){var t=e&&e.forceBase64;if(t){this.supportsBinary=false}this.perMessageDeflate=e.perMessageDeflate;n.call(this,e)}e(t,n);t.prototype.name="websocket";t.prototype.supportsBinary=true;t.prototype.doOpen=function(){if(!this.check()){return}var e=this;var t=this.uri();var n=void 0;var r={agent:this.agent,perMessageDeflate:this.perMessageDeflate};r.pfx=this.pfx;r.key=this.key;r.passphrase=this.passphrase;r.cert=this.cert;r.ca=this.ca;r.ciphers=this.ciphers;r.rejectUnauthorized=this.rejectUnauthorized;if(this.extraHeaders){r.headers=this.extraHeaders}this.ws=c?new o(t):new o(t,n,r);if(this.ws.binaryType===undefined){this.supportsBinary=false}if(this.ws.supports&&this.ws.supports.binary){this.supportsBinary=true;this.ws.binaryType="buffer"}else{this.ws.binaryType="arraybuffer"}this.addEventListeners()};t.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()};this.ws.onclose=function(){t.onClose()};this.ws.onmessage=function(e){t.onData(e.data)};this.ws.onerror=function(e){t.onError("websocket error",e)}};if("undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)){t.prototype.onData=function(e){var t=this;setTimeout(function(){n.prototype.onData.call(t,e)},0)}}t.prototype.write=function(e){var s=this;this.writable=false;var i=e.length;for(var t=0,n=i;t<n;t++){(function(r){l.encodePacket(r,s.supportsBinary,function(e){if(!c){var t={};if(r.options){t.compress=r.options.compress}if(s.perMessageDeflate){var n="string"==typeof e?a.Buffer.byteLength(e):e.length;if(n<s.perMessageDeflate.threshold){t.compress=false}}}try{if(c){s.ws.send(e)}else{s.ws.send(e,t)}}catch(e){u("websocket closed before onclose event")}--i||o()})})(e[t])}function o(){s.emit("flush");setTimeout(function(){s.writable=true;s.emit("drain")},0)}};t.prototype.onClose=function(){n.prototype.onClose.call(this)};t.prototype.doClose=function(){if(typeof this.ws!=="undefined"){this.ws.close()}};t.prototype.uri=function(){var e=this.query||{};var t=this.secure?"wss":"ws";var n="";if(this.port&&("wss"==t&&this.port!=443||"ws"==t&&this.port!=80)){n=":"+this.port}if(this.timestampRequests){e[this.timestampParam]=i()}if(!this.supportsBinary){e.b64=1}e=s.encode(e);if(e.length){e="?"+e}var r=this.hostname.indexOf(":")!==-1;return t+"://"+(r?"["+this.hostname+"]":this.hostname)+n+this.path+e};t.prototype.check=function(){return!!o&&!("__initialize"in o&&this.name===t.prototype.name)}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof s!=="undefined"?s:{})},{"../transport":19,"component-inherit":13,debug:14,"engine.io-parser":27,parseqs:37,ws:undefined,yeast:45}],25:[function(e,t,n){var s=e("has-cors");t.exports=function(e){var t=e.xdomain;var n=e.xscheme;var r=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||s)){return new XMLHttpRequest}}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&r){return new XDomainRequest}}catch(e){}if(!t){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}}},{"has-cors":31}],26:[function(e,t,n){t.exports=r;function r(e){if(e)return s(e)}function s(e){for(var t in r.prototype){e[t]=r.prototype[t]}return e}r.prototype.on=r.prototype.addEventListener=function(e,t){this._callbacks=this._callbacks||{};(this._callbacks[e]=this._callbacks[e]||[]).push(t);return this};r.prototype.once=function(e,t){var n=this;this._callbacks=this._callbacks||{};function r(){n.off(e,r);t.apply(this,arguments)}r.fn=t;this.on(e,r);return this};r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){this._callbacks=this._callbacks||{};if(0==arguments.length){this._callbacks={};return this}var n=this._callbacks[e];if(!n)return this;if(1==arguments.length){delete this._callbacks[e];return this}var r;for(var s=0;s<n.length;s++){r=n[s];if(r===t||r.fn===t){n.splice(s,1);break}}return this};r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks[e];if(n){n=n.slice(0);for(var r=0,s=n.length;r<s;++r){n[r].apply(this,t)}}return this};r.prototype.listeners=function(e){this._callbacks=this._callbacks||{};return this._callbacks[e]||[]};r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},{}],27:[function(r,e,T){(function(u){var e=r("./keys");var o=r("has-binary");var d=r("arraybuffer.slice");var s=r("base64-arraybuffer");var a=r("after");var l=r("utf8");var t=navigator.userAgent.match(/Android/i);var n=/PhantomJS/i.test(navigator.userAgent);var c=t||n;T.protocol=3;var f=T.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6};var h=e(f);var p={type:"error",data:"parser error"};var _=r("blob");T.encodePacket=function(e,t,n,r){if("function"==typeof t){r=t;t=false}if("function"==typeof n){r=n;n=null}var s=e.data===undefined?undefined:e.data.buffer||e.data;if(u.ArrayBuffer&&s instanceof ArrayBuffer){return v(e,t,r)}else if(_&&s instanceof u.Blob){return g(e,t,r)}if(s&&s.base64){return m(e,r)}var i=f[e.type];if(undefined!==e.data){i+=n?l.encode(String(e.data)):String(e.data)}return r(""+i)};function m(e,t){var n="b"+T.packets[e.type]+e.data.data;return t(n)}function v(e,t,n){if(!t){return T.encodeBase64Packet(e,n)}var r=e.data;var s=new Uint8Array(r);var i=new Uint8Array(1+r.byteLength);i[0]=f[e.type];for(var o=0;o<s.length;o++){i[o+1]=s[o]}return n(i.buffer)}function i(e,t,n){if(!t){return T.encodeBase64Packet(e,n)}var r=new FileReader;r.onload=function(){e.data=r.result;T.encodePacket(e,t,true,n)};return r.readAsArrayBuffer(e.data)}function g(e,t,n){if(!t){return T.encodeBase64Packet(e,n)}if(c){return i(e,t,n)}var r=new Uint8Array(1);r[0]=f[e.type];var s=new _([r.buffer,e.data]);return n(s)}T.encodeBase64Packet=function(t,n){var r="b"+T.packets[t.type];if(_&&t.data instanceof u.Blob){var s=new FileReader;s.onload=function(){var e=s.result.split(",")[1];n(r+e)};return s.readAsDataURL(t.data)}var i;try{i=String.fromCharCode.apply(null,new Uint8Array(t.data))}catch(e){var o=new Uint8Array(t.data);var a=new Array(o.length);for(var l=0;l<o.length;l++){a[l]=o[l]}i=String.fromCharCode.apply(null,a)}r+=u.btoa(i);return n(r)};T.decodePacket=function(e,t,n){if(typeof e=="string"||e===undefined){if(e.charAt(0)=="b"){return T.decodeBase64Packet(e.substr(1),t)}if(n){try{e=l.decode(e)}catch(e){return p}}var r=e.charAt(0);if(Number(r)!=r||!h[r]){return p}if(e.length>1){return{type:h[r],data:e.substring(1)}}else{return{type:h[r]}}}var s=new Uint8Array(e);var r=s[0];var i=d(e,1);if(_&&t==="blob"){i=new _([i])}return{type:h[r],data:i}};T.decodeBase64Packet=function(e,t){var n=h[e.charAt(0)];if(!u.ArrayBuffer){return{type:n,data:{base64:true,data:e.substr(1)}}}var r=s.decode(e.substr(1));if(t==="blob"&&_){r=new _([r])}return{type:n,data:r}};T.encodePayload=function(e,n,r){if(typeof n=="function"){r=n;n=null}var s=o(e);if(n&&s){if(_&&!c){return T.encodePayloadAsBlob(e,r)}return T.encodePayloadAsArrayBuffer(e,r)}if(!e.length){return r("0:")}function i(e){return e.length+":"+e}function t(e,t){T.encodePacket(e,!s?false:n,true,function(e){t(null,i(e))})}y(e,t,function(e,t){return r(t.join(""))})};function y(e,s,t){var i=new Array(e.length);var n=a(e.length,t);var r=function e(n,t,r){s(t,function(e,t){i[n]=t;r(e,i)})};for(var o=0;o<e.length;o++){r(o,e[o],n)}}T.decodePayload=function(e,t,n){if(typeof e!="string"){return T.decodePayloadAsBinary(e,t,n)}if(typeof t==="function"){n=t;t=null}var r;if(e==""){return n(p,0,1)}var s="",i,o;for(var a=0,l=e.length;a<l;a++){var u=e.charAt(a);if(":"!=u){s+=u}else{if(""==s||s!=(i=Number(s))){return n(p,0,1)}o=e.substr(a+1,i);if(s!=o.length){return n(p,0,1)}if(o.length){r=T.decodePacket(o,t,true);if(p.type==r.type&&p.data==r.data){return n(p,0,1)}var c=n(r,a+i,l);if(false===c)return}a+=i;s=""}}if(s!=""){return n(p,0,1)}};T.encodePayloadAsArrayBuffer=function(e,r){if(!e.length){return r(new ArrayBuffer(0))}function t(e,t){T.encodePacket(e,true,true,function(e){return t(null,e)})}y(e,t,function(e,t){var n=t.reduce(function(e,t){var n;if(typeof t==="string"){n=t.length}else{n=t.byteLength}return e+n.toString().length+n+2},0);var o=new Uint8Array(n);var a=0;t.forEach(function(e){var t=typeof e==="string";var n=e;if(t){var r=new Uint8Array(e.length);for(var s=0;s<e.length;s++){r[s]=e.charCodeAt(s)}n=r.buffer}if(t){o[a++]=0}else{o[a++]=1}var i=n.byteLength.toString();for(var s=0;s<i.length;s++){o[a++]=parseInt(i[s])}o[a++]=255;var r=new Uint8Array(n);for(var s=0;s<r.length;s++){o[a++]=r[s]}});return r(o.buffer)})};T.encodePayloadAsBlob=function(e,n){function t(e,l){T.encodePacket(e,true,true,function(e){var t=new Uint8Array(1);t[0]=1;if(typeof e==="string"){var n=new Uint8Array(e.length);for(var r=0;r<e.length;r++){n[r]=e.charCodeAt(r)}e=n.buffer;t[0]=0}var s=e instanceof ArrayBuffer?e.byteLength:e.size;var i=s.toString();var o=new Uint8Array(i.length+1);for(var r=0;r<i.length;r++){o[r]=parseInt(i[r])}o[i.length]=255;if(_){var a=new _([t.buffer,o.buffer,e]);l(null,a)}})}y(e,t,function(e,t){return n(new _(t))})};T.decodePayloadAsBinary=function(e,n,r){if(typeof n==="function"){r=n;n=null}var t=e;var s=[];var i=false;while(t.byteLength>0){var o=new Uint8Array(t);var a=o[0]===0;var l="";for(var u=1;;u++){if(o[u]==255)break;if(l.length>310){i=true;break}l+=o[u]}if(i)return r(p,0,1);t=d(t,2+l.length);l=parseInt(l);var c=d(t,0,l);if(a){try{c=String.fromCharCode.apply(null,new Uint8Array(c))}catch(e){var f=new Uint8Array(c);c="";for(var u=0;u<f.length;u++){c+=String.fromCharCode(f[u])}}}s.push(c);t=d(t,l)}var h=s.length;s.forEach(function(e,t){r(T.decodePacket(e,n,true),t,h)})}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof s!=="undefined"?s:{})},{"./keys":28,after:6,"arraybuffer.slice":7,"base64-arraybuffer":9,blob:10,"has-binary":29,utf8:44}],28:[function(e,t,n){t.exports=Object.keys||function e(t){var n=[];var r=Object.prototype.hasOwnProperty;for(var s in t){if(r.call(t,s)){n.push(s)}}return n}},{}],29:[function(t,n,e){(function(s){var i=t("isarray");n.exports=e;function e(e){function r(e){if(!e)return false;if(s.Buffer&&s.Buffer.isBuffer(e)||s.ArrayBuffer&&e instanceof ArrayBuffer||s.Blob&&e instanceof Blob||s.File&&e instanceof File){return true}if(i(e)){for(var t=0;t<e.length;t++){if(r(e[t])){return true}}}else if(e&&"object"==V(e)){if(e.toJSON){e=e.toJSON()}for(var n in e){if(Object.prototype.hasOwnProperty.call(e,n)&&r(e[n])){return true}}}return false}return r(e)}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof s!=="undefined"?s:{})},{isarray:33}],30:[function(t,n,e){(function(s){var i=t("isarray");n.exports=e;function e(e){function r(e){if(!e)return false;if(s.Buffer&&s.Buffer.isBuffer&&s.Buffer.isBuffer(e)||s.ArrayBuffer&&e instanceof ArrayBuffer||s.Blob&&e instanceof Blob||s.File&&e instanceof File){return true}if(i(e)){for(var t=0;t<e.length;t++){if(r(e[t])){return true}}}else if(e&&"object"==V(e)){if(e.toJSON&&"function"==typeof e.toJSON){e=e.toJSON()}for(var n in e){if(Object.prototype.hasOwnProperty.call(e,n)&&r(e[n])){return true}}}return false}return r(e)}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof s!=="undefined"?s:{})},{isarray:33}],31:[function(e,t,n){try{t.exports=typeof XMLHttpRequest!=="undefined"&&"withCredentials"in new XMLHttpRequest}catch(e){t.exports=false}},{}],32:[function(e,t,n){var r=[].indexOf;t.exports=function(e,t){if(r)return e.indexOf(t);for(var n=0;n<e.length;++n){if(e[n]===t)return n}return-1}},{}],33:[function(e,t,n){t.exports=Array.isArray||function(e){return Object.prototype.toString.call(e)=="[object Array]"}},{}],34:[function(e,l,u){(function(a){(function(){var e=typeof E==="function"&&E.amd;var B={function:true,object:true};var t=B[V(u)]&&u&&!u.nodeType&&u;var G=B[typeof window==="undefined"?"undefined":V(window)]&&window||this,n=t&&B[V(l)]&&l&&!l.nodeType&&V(a)=="object"&&a;if(n&&(n["global"]===n||n["window"]===n||n["self"]===n)){G=n}function W(e,l){e||(e=G["Object"]());l||(l=G["Object"]());var u=e["Number"]||G["Number"],c=e["String"]||G["String"],t=e["Object"]||G["Object"],f=e["Date"]||G["Date"],n=e["SyntaxError"]||G["SyntaxError"],E=e["TypeError"]||G["TypeError"],r=e["Math"]||G["Math"],s=e["JSON"]||G["JSON"];if(V(s)=="object"&&s){l.stringify=s.stringify;l.parse=s.parse}var i=t.prototype,A=i.toString,w,R,I;var h=new f(-0xc782b5b800cec);try{h=h.getUTCFullYear()==-109252&&h.getUTCMonth()===0&&h.getUTCDate()===1&&h.getUTCHours()==10&&h.getUTCMinutes()==37&&h.getUTCSeconds()==6&&h.getUTCMilliseconds()==708}catch(e){}function d(e){if(d[e]!==I){return d[e]}var t;if(e=="bug-string-char-index"){t="a"[0]!="a"}else if(e=="json"){t=d("json-stringify")&&d("json-parse")}else{var n,r='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if(e=="json-stringify"){var s=l.stringify,i=typeof s=="function"&&h;if(i){(n=function e(){return 1}).toJSON=n;try{i=s(0)==="0"&&s(new u)==="0"&&s(new c)=='""'&&s(A)===I&&s(I)===I&&s()===I&&s(n)==="1"&&s([n])=="[1]"&&s([I])=="[null]"&&s(null)=="null"&&s([I,A,null])=="[null,null,null]"&&s({a:[n,true,false,null,"\0\b\n\f\r\t"]})==r&&s(null,n)==="1"&&s([1,2],null,1)=="[\n 1,\n 2\n]"&&s(new f(-864e13))=='"-271821-04-20T00:00:00.000Z"'&&s(new f(864e13))=='"+275760-09-13T00:00:00.000Z"'&&s(new f(-621987552e5))=='"-000001-01-01T00:00:00.000Z"'&&s(new f(-1))=='"1969-12-31T23:59:59.999Z"'}catch(e){i=false}}t=i}if(e=="json-parse"){var o=l.parse;if(typeof o=="function"){try{if(o("0")===0&&!o(false)){n=o(r);var a=n["a"].length==5&&n["a"][0]===1;if(a){try{a=!o('"\t"')}catch(e){}if(a){try{a=o("01")!==1}catch(e){}}if(a){try{a=o("1.")!==1}catch(e){}}}}}catch(e){a=false}}t=a}}return d[e]=!!t}if(!d("json")){var p="[object Function]",k="[object Date]",O="[object Number]",x="[object String]",N="[object Array]",U="[object Boolean]";var _=d("bug-string-char-index");if(!h){var P=r.floor;var o=[0,31,59,90,120,151,181,212,243,273,304,334];var D=function e(t,n){return o[n]+365*(t-1970)+P((t-1969+(n=+(n>1)))/4)-P((t-1901+n)/100)+P((t-1601+n)/400)}}if(!(w=i.hasOwnProperty)){w=function e(t){var n={},r;if((n.__proto__=null,n.__proto__={toString:1},n).toString!=A){w=function e(t){var n=this.__proto__,r=t in(this.__proto__=null,this);this.__proto__=n;return r}}else{r=n.constructor;w=function e(t){var n=(this.constructor||r).prototype;return t in this&&!(t in n&&this[t]===n[t])}}n=null;return w.call(this,t)}}R=function e(t,n){var r=0,s,a,i;(s=function e(){this.valueOf=0}).prototype.valueOf=0;a=new s;for(i in a){if(w.call(a,i)){r++}}s=a=null;if(!r){a=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"];R=function e(t,n){var r=A.call(t)==p,s,i;var o=!r&&typeof t.constructor!="function"&&B[V(t.hasOwnProperty)]&&t.hasOwnProperty||w;for(s in t){if(!(r&&s=="prototype")&&o.call(t,s)){n(s)}}for(i=a.length;s=a[--i];o.call(t,s)&&n(s)){}}}else if(r==2){R=function e(t,n){var r={},s=A.call(t)==p,i;for(i in t){if(!(s&&i=="prototype")&&!w.call(r,i)&&(r[i]=1)&&w.call(t,i)){n(i)}}}}else{R=function e(t,n){var r=A.call(t)==p,s,i;for(s in t){if(!(r&&s=="prototype")&&w.call(t,s)&&!(i=s==="constructor")){n(s)}}if(i||w.call(t,s="constructor")){n(s)}}}return R(t,n)};if(!d("json-stringify")){var m={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"};var a="000000";var M=function e(t,n){return(a+(n||0)).slice(-t)};var v="\\u00";var q=function e(t){var n='"',r=0,s=t.length,i=!_||s>10;var o=i&&(_?t.split(""):t);for(;r<s;r++){var a=t.charCodeAt(r);switch(a){case 8:case 9:case 10:case 12:case 13:case 34:case 92:n+=m[a];break;default:if(a<32){n+=v+M(2,a.toString(16));break}n+=i?o[r]:t.charAt(r)}}return n+'"'};var g=function n(e,t,r,s,i,o,a){var l,u,c,f,h,d,p,_,m,v,g,y,T,b,S,C;try{l=t[e]}catch(e){}if(V(l)=="object"&&l){u=A.call(l);if(u==k&&!w.call(l,"toJSON")){if(l>-1/0&&l<1/0){if(D){h=P(l/864e5);for(c=P(h/365.2425)+1970-1;D(c+1,0)<=h;c++){}for(f=P((h-D(c,0))/30.42);D(c,f+1)<=h;f++){}h=1+h-D(c,f);d=(l%864e5+864e5)%864e5;p=P(d/36e5)%24;_=P(d/6e4)%60;m=P(d/1e3)%60;v=d%1e3}else{c=l.getUTCFullYear();f=l.getUTCMonth();h=l.getUTCDate();p=l.getUTCHours();_=l.getUTCMinutes();m=l.getUTCSeconds();v=l.getUTCMilliseconds()}l=(c<=0||c>=1e4?(c<0?"-":"+")+M(6,c<0?-c:c):M(4,c))+"-"+M(2,f+1)+"-"+M(2,h)+"T"+M(2,p)+":"+M(2,_)+":"+M(2,m)+"."+M(3,v)+"Z"}else{l=null}}else if(typeof l.toJSON=="function"&&(u!=O&&u!=x&&u!=N||w.call(l,"toJSON"))){l=l.toJSON(e)}}if(r){l=r.call(t,e,l)}if(l===null){return"null"}u=A.call(l);if(u==U){return""+l}else if(u==O){return l>-1/0&&l<1/0?""+l:"null"}else if(u==x){return q(""+l)}if(V(l)=="object"){for(b=a.length;b--;){if(a[b]===l){throw E()}}a.push(l);g=[];S=o;o+=i;if(u==N){for(T=0,b=l.length;T<b;T++){y=n(T,l,r,s,i,o,a);g.push(y===I?"null":y)}C=g.length?i?"[\n"+o+g.join(",\n"+o)+"\n"+S+"]":"["+g.join(",")+"]":"[]"}else{R(s||l,function(e){var t=n(e,l,r,s,i,o,a);if(t!==I){g.push(q(e)+":"+(i?" ":"")+t)}});C=g.length?i?"{\n"+o+g.join(",\n"+o)+"\n"+S+"}":"{"+g.join(",")+"}":"{}"}a.pop();return C}};l.stringify=function(e,t,n){var r,s,i,o;if(B[V(t)]&&t){if((o=A.call(t))==p){s=t}else if(o==N){i={};for(var a=0,l=t.length,u;a<l;u=t[a++],(o=A.call(u),o==x||o==O)&&(i[u]=1)){}}}if(n){if((o=A.call(n))==O){if((n-=n%1)>0){for(r="",n>10&&(n=10);r.length<n;r+=" "){}}}else if(o==x){r=n.length<=10?n:n.slice(0,10)}}return g("",(u={},u[""]=e,u),s,i,r,"",[])}}if(!d("json-parse")){var y=c.fromCharCode;var T={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"};var b,S;var C=function e(){b=S=null;throw n()};var L=function e(){var t=S,n=t.length,r,s,i,o,a;while(b<n){a=t.charCodeAt(b);switch(a){case 9:case 10:case 13:case 32:b++;break;case 123:case 125:case 91:case 93:case 58:case 44:r=_?t.charAt(b):t[b];b++;return r;case 34:for(r="@",b++;b<n;){a=t.charCodeAt(b);if(a<32){C()}else if(a==92){a=t.charCodeAt(++b);switch(a){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:r+=T[a];b++;break;case 117:s=++b;for(i=b+4;b<i;b++){a=t.charCodeAt(b);if(!(a>=48&&a<=57||a>=97&&a<=102||a>=65&&a<=70)){C()}}r+=y("0x"+t.slice(s,b));break;default:C()}}else{if(a==34){break}a=t.charCodeAt(b);s=b;while(a>=32&&a!=92&&a!=34){a=t.charCodeAt(++b)}r+=t.slice(s,b)}}if(t.charCodeAt(b)==34){b++;return r}C();default:s=b;if(a==45){o=true;a=t.charCodeAt(++b)}if(a>=48&&a<=57){if(a==48&&(a=t.charCodeAt(b+1),a>=48&&a<=57)){C()}o=false;for(;b<n&&(a=t.charCodeAt(b),a>=48&&a<=57);b++){}if(t.charCodeAt(b)==46){i=++b;for(;i<n&&(a=t.charCodeAt(i),a>=48&&a<=57);i++){}if(i==b){C()}b=i}a=t.charCodeAt(b);if(a==101||a==69){a=t.charCodeAt(++b);if(a==43||a==45){b++}for(i=b;i<n&&(a=t.charCodeAt(i),a>=48&&a<=57);i++){}if(i==b){C()}b=i}return+t.slice(s,b)}if(o){C()}if(t.slice(b,b+4)=="true"){b+=4;return true}else if(t.slice(b,b+5)=="false"){b+=5;return false}else if(t.slice(b,b+4)=="null"){b+=4;return null}C()}}return"$"};var H=function e(t){var n,r;if(t=="$"){C()}if(typeof t=="string"){if((_?t.charAt(0):t[0])=="@"){return t.slice(1)}if(t=="["){n=[];for(;;r||(r=true)){t=L();if(t=="]"){break}if(r){if(t==","){t=L();if(t=="]"){C()}}else{C()}}if(t==","){C()}n.push(e(t))}return n}else if(t=="{"){n={};for(;;r||(r=true)){t=L();if(t=="}"){break}if(r){if(t==","){t=L();if(t=="}"){C()}}else{C()}}if(t==","||typeof t!="string"||(_?t.charAt(0):t[0])!="@"||L()!=":"){C()}n[t.slice(1)]=e(L())}return n}C()}return t};var j=function e(t,n,r){var s=F(t,n,r);if(s===I){delete t[n]}else{t[n]=s}};var F=function e(t,n,r){var s=t[n],i;if(V(s)=="object"&&s){if(A.call(s)==N){for(i=s.length;i--;){j(s,i,r)}}else{R(s,function(e){j(s,e,r)})}}return r.call(t,n,s)};l.parse=function(e,t){var n,r;b=0;S=""+e;n=H(L());if(L()!="$"){C()}b=S=null;return t&&A.call(t)==p?F((r={},r[""]=n,r),"",t):n}}}l["runInContext"]=W;return l}if(t&&!e){W(G,t)}else{var r=G.JSON,s=G["JSON3"],i=false;var o=W(G,G["JSON3"]={noConflict:function e(){if(!i){i=true;G.JSON=r;G["JSON3"]=s;r=s=null}return o}});G.JSON={parse:o.parse,stringify:o.stringify}}if(e){E(function(){return o})}}).call(this)}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof s!=="undefined"?s:{})},{}],35:[function(e,t,n){var s=1e3;var i=s*60;var o=i*60;var a=o*24;var l=a*365.25;t.exports=function(e,t){t=t||{};if("string"==typeof e)return r(e);return t["long"]?c(e):u(e)};function r(e){e=""+e;if(e.length>1e4)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var n=parseFloat(t[1]);var r=(t[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return n*l;case"days":case"day":case"d":return n*a;case"hours":case"hour":case"hrs":case"hr":case"h":return n*o;case"minutes":case"minute":case"mins":case"min":case"m":return n*i;case"seconds":case"second":case"secs":case"sec":case"s":return n*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n}}function u(e){if(e>=a)return Math.round(e/a)+"d";if(e>=o)return Math.round(e/o)+"h";if(e>=i)return Math.round(e/i)+"m";if(e>=s)return Math.round(e/s)+"s";return e+"ms"}function c(e){return f(e,a,"day")||f(e,o,"hour")||f(e,i,"minute")||f(e,s,"second")||e+" ms"}function f(e,t,n){if(e<t)return;if(e<t*1.5)return Math.floor(e/t)+" "+n;return Math.ceil(e/t)+" "+n+"s"}},{}],36:[function(e,t,n){(function(n){var r=/^[\],:{}\s]*$/;var s=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g;var i=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g;var o=/(?:^|:|,)(?:\s*\[)+/g;var a=/^\s+/;var l=/\s+$/;t.exports=function e(t){if("string"!=typeof t||!t){return null}t=t.replace(a,"").replace(l,"");if(n.JSON&&JSON.parse){return JSON.parse(t)}if(r.test(t.replace(s,"@").replace(i,"]").replace(o,""))){return new Function("return "+t)()}}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof s!=="undefined"?s:{})},{}],37:[function(e,t,n){n.encode=function(e){var t="";for(var n in e){if(e.hasOwnProperty(n)){if(t.length)t+="&";t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n])}}return t};n.decode=function(e){var t={};var n=e.split("&");for(var r=0,s=n.length;r<s;r++){var i=n[r].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}},{}],38:[function(e,t,n){var l=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;var u=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function e(t){var n=t,r=t.indexOf("["),s=t.indexOf("]");if(r!=-1&&s!=-1){t=t.substring(0,r)+t.substring(r,s).replace(/:/g,";")+t.substring(s,t.length)}var i=l.exec(t||""),o={},a=14;while(a--){o[u[a]]=i[a]||""}if(r!=-1&&s!=-1){o.source=n;o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":");o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":");o.ipv6uri=true}return o}},{}],39:[function(e,t,n){(function(c){var f=e("isarray");var h=e("./is-buffer");n.deconstructPacket=function(e){var i=[];var t=e.data;function o(e){if(!e)return e;if(h(e)){var t={_placeholder:true,num:i.length};i.push(e);return t}else if(f(e)){var n=new Array(e.length);for(var r=0;r<e.length;r++){n[r]=o(e[r])}return n}else if("object"==V(e)&&!(e instanceof Date)){var n={};for(var s in e){n[s]=o(e[s])}return n}return e}var n=e;n.data=o(t);n.attachments=i.length;return{packet:n,buffers:i}};n.reconstructPacket=function(e,s){var t=0;function i(e){if(e&&e._placeholder){var t=s[e.num];return t}else if(f(e)){for(var n=0;n<e.length;n++){e[n]=i(e[n])}return e}else if(e&&"object"==V(e)){for(var r in e){e[r]=i(e[r])}return e}return e}e.data=i(e.data);e.attachments=undefined;return e};n.removeBlobs=function(e,o){function a(e,t,n){if(!e)return e;if(c.Blob&&e instanceof Blob||c.File&&e instanceof File){l++;var r=new FileReader;r.onload=function(){if(n){n[t]=this.result}else{u=this.result}if(!--l){o(u)}};r.readAsArrayBuffer(e)}else if(f(e)){for(var s=0;s<e.length;s++){a(e[s],s,e)}}else if(e&&"object"==V(e)&&!h(e)){for(var i in e){a(e[i],i,e)}}}var l=0;var u=e;a(u);if(!l){o(u)}}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof s!=="undefined"?s:{})},{"./is-buffer":41,isarray:33}],40:[function(e,t,o){var a=e("debug")("socket.io-parser");var l=e("json3");var n=e("isarray");var r=e("component-emitter");var i=e("./binary");var s=e("./is-buffer");o.protocol=4;o.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"];o.CONNECT=0;o.DISCONNECT=1;o.EVENT=2;o.ACK=3;o.ERROR=4;o.BINARY_EVENT=5;o.BINARY_ACK=6;o.Encoder=u;o.Decoder=h;function u(){}u.prototype.encode=function(e,t){a("encoding packet %j",e);if(o.BINARY_EVENT==e.type||o.BINARY_ACK==e.type){f(e,t)}else{var n=c(e);t([n])}};function c(e){var t="";var n=false;t+=e.type;if(o.BINARY_EVENT==e.type||o.BINARY_ACK==e.type){t+=e.attachments;t+="-"}if(e.nsp&&"/"!=e.nsp){n=true;t+=e.nsp}if(null!=e.id){if(n){t+=",";n=false}t+=e.id}if(null!=e.data){if(n)t+=",";t+=l.stringify(e.data)}a("encoded %j as %s",e,t);return t}function f(e,s){function t(e){var t=i.deconstructPacket(e);var n=c(t.packet);var r=t.buffers;r.unshift(n);s(r)}i.removeBlobs(e,t)}function h(){this.reconstructor=null}r(h.prototype);h.prototype.add=function(e){var t;if("string"==typeof e){t=d(e);if(o.BINARY_EVENT==t.type||o.BINARY_ACK==t.type){this.reconstructor=new p(t);if(this.reconstructor.reconPack.attachments===0){this.emit("decoded",t)}}else{this.emit("decoded",t)}}else if(s(e)||e.base64){if(!this.reconstructor){throw new Error("got binary data when not reconstructing a packet")}else{t=this.reconstructor.takeBinaryData(e);if(t){this.reconstructor=null;this.emit("decoded",t)}}}else{throw new Error("Unknown type: "+e)}};function d(e){var t={};var n=0;t.type=Number(e.charAt(0));if(null==o.types[t.type])return _();if(o.BINARY_EVENT==t.type||o.BINARY_ACK==t.type){var r="";while(e.charAt(++n)!="-"){r+=e.charAt(n);if(n==e.length)break}if(r!=Number(r)||e.charAt(n)!="-"){throw new Error("Illegal attachments")}t.attachments=Number(r)}if("/"==e.charAt(n+1)){t.nsp="";while(++n){var s=e.charAt(n);if(","==s)break;t.nsp+=s;if(n==e.length)break}}else{t.nsp="/"}var i=e.charAt(n+1);if(""!==i&&Number(i)==i){t.id="";while(++n){var s=e.charAt(n);if(null==s||Number(s)!=s){--n;break}t.id+=e.charAt(n);if(n==e.length)break}t.id=Number(t.id)}if(e.charAt(++n)){try{t.data=l.parse(e.substr(n))}catch(e){return _()}}a("decoded %s as %j",e,t);return t}h.prototype.destroy=function(){if(this.reconstructor){this.reconstructor.finishedReconstruction()}};function p(e){this.reconPack=e;this.buffers=[]}p.prototype.takeBinaryData=function(e){this.buffers.push(e);if(this.buffers.length==this.reconPack.attachments){var t=i.reconstructPacket(this.reconPack,this.buffers);this.finishedReconstruction();return t}return null};p.prototype.finishedReconstruction=function(){this.reconPack=null;this.buffers=[]};function _(e){return{type:o.ERROR,data:"parser error"}}},{"./binary":39,"./is-buffer":41,"component-emitter":42,debug:14,isarray:33,json3:34}],41:[function(e,n,t){(function(t){n.exports=e;function e(e){return t.Buffer&&t.Buffer.isBuffer(e)||t.ArrayBuffer&&e instanceof ArrayBuffer}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof s!=="undefined"?s:{})},{}],42:[function(e,t,n){arguments[4][26][0].apply(n,arguments)},{dup:26}],43:[function(e,t,n){t.exports=r;function r(e,t){var n=[];t=t||0;for(var r=t||0;r<e.length;r++){n[r-t]=e[r]}return n}},{}],44:[function(e,S,C){(function(b){(function(e){var t=V(C)=="object"&&C;var n=V(S)=="object"&&S&&S.exports==t&&S;var r=V(b)=="object"&&b;if(r.global===r||r.window===r){e=r}var i=String.fromCharCode;function o(e){var t=[];var n=0;var r=e.length;var s;var i;while(n<r){s=e.charCodeAt(n++);if(s>=55296&&s<=56319&&n<r){i=e.charCodeAt(n++);if((i&64512)==56320){t.push(((s&1023)<<10)+(i&1023)+65536)}else{t.push(s);n--}}else{t.push(s)}}return t}function s(e){var t=e.length;var n=-1;var r;var s="";while(++n<t){r=e[n];if(r>65535){r-=65536;s+=i(r>>>10&1023|55296);r=56320|r&1023}s+=i(r)}return s}function a(e){if(e>=55296&&e<=57343){throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value")}}function l(e,t){return i(e>>t&63|128)}function u(e){if((e&4294967168)==0){return i(e)}var t="";if((e&4294965248)==0){t=i(e>>6&31|192)}else if((e&4294901760)==0){a(e);t=i(e>>12&15|224);t+=l(e,6)}else if((e&4292870144)==0){t=i(e>>18&7|240);t+=l(e,12);t+=l(e,6)}t+=i(e&63|128);return t}function c(e){var t=o(e);var n=t.length;var r=-1;var s;var i="";while(++r<n){s=t[r];i+=u(s)}return i}function f(){if(_>=p){throw Error("Invalid byte index")}var e=d[_]&255;_++;if((e&192)==128){return e&63}throw Error("Invalid continuation byte")}function h(){var e;var t;var n;var r;var s;if(_>p){throw Error("Invalid byte index")}if(_==p){return false}e=d[_]&255;_++;if((e&128)==0){return e}if((e&224)==192){var t=f();s=(e&31)<<6|t;if(s>=128){return s}else{throw Error("Invalid continuation byte")}}if((e&240)==224){t=f();n=f();s=(e&15)<<12|t<<6|n;if(s>=2048){a(s);return s}else{throw Error("Invalid continuation byte")}}if((e&248)==240){t=f();n=f();r=f();s=(e&15)<<18|t<<12|n<<6|r;if(s>=65536&&s<=1114111){return s}}throw Error("Invalid UTF-8 detected")}var d;var p;var _;function m(e){d=o(e);p=d.length;_=0;var t=[];var n;while((n=h())!==false){t.push(n)}return s(t)}var v={version:"2.0.0",encode:c,decode:m};if(typeof E=="function"&&V(E.amd)=="object"&&E.amd){E(function(){return v})}else if(t&&!t.nodeType){if(n){n.exports=v}else{var g={};var y=g.hasOwnProperty;for(var T in v){y.call(v,T)&&(t[T]=v[T])}}}else{e.utf8=v}})(this)}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof s!=="undefined"?s:{})},{}],45:[function(e,t,n){"use strict";var r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),s=64,i={},o=0,a=0,l;function u(e){var t="";do{t=r[e%s]+t;e=Math.floor(e/s)}while(e>0);return t}function c(e){var t=0;for(a=0;a<e.length;a++){t=t*s+i[e.charAt(a)]}return t}function f(){var e=u(+new Date);if(e!==l)return o=0,l=e;return e+"."+u(o++)}for(;a<s;a++){i[r[a]]=a}f.encode=u;f.decode=c;t.exports=f},{}]},{},[1])(1)})}).call(this,e(30))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){if(typeof window==="object")n=window}e.exports=n},function(e,t,n){"use strict";n.r(t);var a={audioplayer:function e(t,n,r,s){var e=document.getElementById(t);if(e!=null){document.body.removeChild(e)}if(typeof n!="undefined"){if(navigator.userAgent.indexOf("MSIE")>0){var i=document.createElement("bgsound");i.id=t;i.src=n["mp3"];i.setAttribute("autostart","true");if(r){i.setAttribute("loop","infinite")}document.body.appendChild(i)}else{var i=document.createElement("audio");i.id=t;i.setAttribute("autoplay","autoplay");if(r){i.setAttribute("loop","loop")}document.body.appendChild(i);var o=document.createElement("source");o.src=n["mp3"];o.type="audio/mpeg";i.appendChild(o);if(s!=null){i.loop=false;i.addEventListener("ended",function(){a.audiostop(t)},false)}}}},audiostop:function e(t){var n=document.getElementById(t);if(n!=null){n.pause();n.currentTime=0;if($("#"+t).length>0){$("#"+t).remove()}}}};t["default"]=a}]);